import{d as B,q,g as $,h as A,i as D,u as P,o as F,P as u,r as d,c as H,j as e,k as i,w as a,F as M,a as V,e as c,s as p,C as j}from"./index-b9d41b02.js";import{u as R}from"./customers-3d8ec5e6.js";import{v as b}from"./v4-a960c1f4.js";import"./base.service-7dbc85ae.js";const G=c("span",null,"Clients",-1),L=["onClick"],U=c("span",null,"Tipus de client",-1),z=["onClick"],X=B({__name:"Customers",setup(K){const _=q(0),C=$(),y=A(),m=D(),w=P(),l=R();F(async()=>{await l.fetchCustomers(),await l.fetchCustomerTypes(),w.setMenuItem({text:"Clients",icon:u.HASHTAG})});const g=t=>{var r;const o=(r=l.customerTypes)==null?void 0:r.find(s=>s.id===t);if(o)return o.name},I=(t,o)=>{y.require({target:t.currentTarget,message:`Está segur que vol eliminar el client ${o.comercialName}?`,icon:"pi pi-question-circle",acceptIcon:"pi pi-check",rejectIcon:"pi pi-times",accept:async()=>{await l.deleteCustomer(o.id)&&(C.add({severity:"success",summary:"Eliminat",life:3e3}),await l.fetchCustomers())}})},k=(t,o)=>{y.require({target:t.currentTarget,message:`Está segur que vol eliminar el tipus de client ${o.name}?`,icon:"pi pi-question-circle",acceptIcon:"pi pi-check",rejectIcon:"pi pi-times",accept:async()=>{await l.deleteCustomerType(o.id)&&(C.add({severity:"success",summary:"Eliminat",life:3e3}),await l.fetchCustomerTypes())}})},N=t=>{t.originalEvent.target.className.includes("grid_delete_column_button")||m.push({path:`/customers/${t.data.id}`})},S=t=>{t.originalEvent.target.className.includes("grid_delete_column_button")||m.push({path:`/customer-types/${t.data.id}`})},x=()=>{_.value===0?m.push({path:`/customers/${b()}`}):m.push({path:`/customer-types/${b()}`})};return(t,o)=>{const r=d("Button"),s=d("Column"),f=d("BooleanColumn"),v=d("DataTable"),T=d("TabPanel"),E=d("TabView");return V(),H(M,null,[e(r,{icon:i(u).PLUS,class:"grid_add_row_button",rounded:"",onClick:x},null,8,["icon"]),e(E,{activeIndex:_.value,"onUpdate:activeIndex":o[0]||(o[0]=n=>_.value=n)},{default:a(()=>[e(T,null,{header:a(()=>[c("i",{class:p([i(u).LINK,"mr-2"])},null,2),G]),default:a(()=>[e(v,{value:i(l).customers,tableStyle:"min-width: 100%",onRowClick:N},{default:a(()=>[e(s,{field:"comercialName",header:"Nom comercial",sortable:"",style:{width:"20%"}}),e(s,{field:"taxName",header:"Nom Fiscal",style:{width:"20%"}}),e(s,{field:"vatNumber",header:"CIF",style:{width:"20%"}}),e(s,{header:"Tipus",style:{width:"20%"}},{body:a(n=>[c("span",null,j(g(n.data.customerTypeId)),1)]),_:1}),e(s,{header:"Actiu",sortable:"",style:{width:"20%"}},{body:a(n=>[e(f,{value:!n.data.disabled,showColor:!0},null,8,["value"])]),_:1}),e(s,null,{body:a(n=>[c("i",{class:p([i(u).TIMES,"grid_delete_column_button"]),onClick:h=>I(h,n.data)},null,10,L)]),_:1})]),_:1},8,["value"])]),_:1}),e(T,null,{header:a(()=>[c("i",{class:p([i(u).HASHTAG,"mr-2"])},null,2),U]),default:a(()=>[e(v,{value:i(l).customerTypes,tableStyle:"min-width: 100%",onRowClick:S},{default:a(()=>[e(s,{field:"name",header:"Nom",style:{width:"33%"}}),e(s,{field:"description",header:"Descripció",style:{width:"33%"}}),e(s,{header:"Desactivat",style:{width:"33%"}},{body:a(n=>[e(f,{value:n.data.disabled},null,8,["value"])]),_:1}),e(s,null,{body:a(n=>[c("i",{class:p([i(u).TIMES,"grid_delete_column_button"]),onClick:h=>k(h,n.data)},null,10,z)]),_:1})]),_:1},8,["value"])]),_:1})]),_:1},8,["activeIndex"])],64)}}});export{X as default};
