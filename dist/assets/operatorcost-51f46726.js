import{d as h,o as w,j as I,z as T,r as k,h as C,k as o,c as O,e as n,i as d,n as _,y as M,l as E,a as S,s as D,F as m,v as N,u as R,m as U,P as $,K as g}from"./index-f2f50ed2.js";import{c as q,a as V,d as A,F as L}from"./form-validator-929472fd.js";import{u as B}from"./plantmodel-40a3af72.js";import"./base.service-1bae7a9f.js";const P={key:0},z={class:"four-columns"},j=n("label",{class:"block text-900 mb-2"},"Tipus d'operari:",-1),G=n("label",{class:"block text-900 mb-2"},"Estat de màquina:",-1),K=n("label",{class:"block text-900 mb-2"},"Desactivat",-1),Y={class:"mt-2"},H=h({__name:"FormOperatorCost",props:{operatorCost:{}},emits:["submit","cancel"],setup(y,{emit:u}){const c=y;w(async()=>{await a.fetchOperatorTypes(),await a.fetchMachineStatuses()});const b=I(),a=B(),{operatorCost:e}=T(a),f=q().shape({operatorTypeId:V().required("El tipus d'operari és obligatori"),machineStatusId:V().required("L'estat de màquina és obligatori"),cost:A().required("El cost es obligatori")}),l=k({result:!1,errors:{}}),v=()=>{const r=new L(f);l.value=r.validate(c.operatorCost)},s=async()=>{if(v(),l.value.result)u("submit",c.operatorCost);else{let r="";Object.entries(l.value.errors).forEach(t=>{r+=`${t[1].map(p=>p)}.   `}),b.add({severity:"warn",summary:"Formulari inválid",detail:r,life:5e3})}};return(r,t)=>{const p=C("Dropdown"),x=C("Checkbox"),F=C("Button");return o(e)?(S(),O("form",P,[n("section",z,[n("div",null,[j,d(p,{modelValue:o(e).operatorTypeId,"onUpdate:modelValue":t[0]||(t[0]=i=>o(e).operatorTypeId=i),editable:"",options:o(a).operatorTypes,optionValue:"id",optionLabel:"name",class:_(["w-full",{"p-invalid":l.value.errors.OperatorTypeId}])},null,8,["modelValue","options","class"])]),n("div",null,[G,d(p,{modelValue:o(e).machineStatusId,"onUpdate:modelValue":t[1]||(t[1]=i=>o(e).machineStatusId=i),editable:"",options:o(a).machineStatuses,optionValue:"id",optionLabel:"name",class:_(["w-full",{"p-invalid":l.value.errors.machineStatusId}])},null,8,["modelValue","options","class"])]),d(M,{class:_(["mb-2 w-full",{"p-invalid":l.value.errors.cost}]),label:"Preu hora:",modelValue:o(e).cost,"onUpdate:modelValue":t[2]||(t[2]=i=>o(e).cost=i),type:o(D).CURRENCY},null,8,["modelValue","type","class"]),n("div",null,[K,d(x,{modelValue:o(e).disabled,"onUpdate:modelValue":t[3]||(t[3]=i=>o(e).disabled=i),class:"w-full",binary:!0},null,8,["modelValue"])])]),n("div",Y,[d(F,{label:"Guardar",class:"mr-2",onClick:s})])])):E("",!0)}}}),Z=h({__name:"operatorcost",setup(y){const u=k(m.EDIT),c=N(),b=R(),a=B(),{operatorCost:e}=T(a),f=async()=>{await a.fetchOperatorCost(c.params.id);let s="";e.value?(u.value=m.EDIT,s=`Cost per tipus d'operari ${e.value.id}`):(u.value=m.CREATE,a.setNewOperatorCost(c.params.id),s="Alta de cost per tipus operari"),b.setMenuItem({icon:$.BUILDING,backButtonVisible:!0,title:s})};w(async()=>{await f()});const l=I(),v=async()=>{const s=e.value;let r=!1,t="";u.value===m.CREATE?(r=await a.createOperatorCost(s),t="Cost per tipus d'operari creat correctament"):(r=await a.updateOperatorCost(s.id,s),t="Cost per tipus d'operari actualizat correctament"),r&&(l.add({severity:"success",summary:t,life:5e3}),g.back())};return(s,r)=>o(e)?(S(),U(H,{key:0,operatorCost:o(e),onSubmit:v},null,8,["operatorCost"])):E("",!0)}});export{Z as default};
