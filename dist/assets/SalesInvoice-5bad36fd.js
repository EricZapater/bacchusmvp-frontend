import{O as Q,V as x,W as Ie,X as be,h as I,Y as ve,a as h,c as g,G as A,S as ye,R as _,e as r,m as C,w as y,Z as te,$ as F,n as Y,l as w,D as L,a0 as ge,a1 as _e,a2 as W,a3 as H,a4 as P,a5 as xe,a6 as ke,a7 as Ce,i as m,a8 as De,a9 as Pe,aa as we,Q as M,d as O,j as J,r as B,k as D,o as se,ab as Se,C as T,P as R,y as z,s as Z,J as Le,p as Ve,b as Ee,f as Te,x as Be,v as Ae,g as Fe,u as Oe,z as Ke,E as j,ac as ze}from"./index-d48d4fc0.js";import{u as Me}from"./invoice-fa5da6c3.js";import{u as Ne}from"./customers-b101acfd.js";import{u as U}from"./masterData-d6c13bf1.js";import{u as X}from"./lifecycle-4a4dadbb.js";import{f as N,e as Re}from"./functions-c791afc8.js";import{c as ae,a as ie,d as ne,F as Ue}from"./form-validator-b82d2143.js";import{l as qe}from"./lodash-7256ecdb.js";import{s as Ge}from"./index-b6c8d1e4.js";import"./base.service-890148bb.js";import"./index-212a1afb.js";import"./v4-a960c1f4.js";import"./reference.service-262b883f.js";var le={name:"TieredMenuSub",extends:Q,emits:["item-click","item-mouseenter"],props:{menuId:{type:String,default:null},focusedItemId:{type:String,default:null},items:{type:Array,default:null},level:{type:Number,default:0},templates:{type:Object,default:null},activeItemPath:{type:Object,default:null},exact:{type:Boolean,default:!0}},methods:{getItemId(e){return`${this.menuId}_${e.key}`},getItemKey(e){return this.getItemId(e)},getItemProp(e,t,s){return e&&e.item?x.getItemValue(e.item[t],s):void 0},getItemLabel(e){return this.getItemProp(e,"label")},getPTOptions(e,t){return this.ptm(t,{context:{active:this.isItemActive(e),focused:this.isItemFocused(e)}})},isItemActive(e){return this.activeItemPath.some(t=>t.key===e.key)},isItemVisible(e){return this.getItemProp(e,"visible")!==!1},isItemDisabled(e){return this.getItemProp(e,"disabled")},isItemFocused(e){return this.focusedItemId===this.getItemId(e)},isItemGroup(e){return x.isNotEmpty(e.items)},onItemClick(e,t){this.getItemProp(t,"command",{originalEvent:e,item:t.item}),this.$emit("item-click",{originalEvent:e,processedItem:t,isFocus:!0})},onItemMouseEnter(e,t){this.$emit("item-mouseenter",{originalEvent:e,processedItem:t})},onItemActionClick(e,t){t&&t(e)},getAriaSetSize(){return this.items.filter(e=>this.isItemVisible(e)&&!this.getItemProp(e,"separator")).length},getAriaPosInset(e){return e-this.items.slice(0,e).filter(t=>this.isItemVisible(t)&&this.getItemProp(t,"separator")).length+1},getItemClass(e){return["p-menuitem",this.getItemProp(e,"class"),{"p-menuitem-active p-highlight":this.isItemActive(e),"p-focus":this.isItemFocused(e),"p-disabled":this.isItemDisabled(e)}]},getItemActionClass(e,t){return["p-menuitem-link",{"router-link-active":t&&t.isActive,"router-link-active-exact":this.exact&&t&&t.isExactActive}]},getItemIconClass(e){return["p-menuitem-icon",this.getItemProp(e,"icon")]},getSeparatorItemClass(e){return["p-menuitem-separator",this.getItemProp(e,"class")]}},components:{AngleRightIcon:Ie},directives:{ripple:be}};const He=["id","aria-label","aria-disabled","aria-expanded","aria-haspopup","aria-level","aria-setsize","aria-posinset"],Ze=["onClick","onMouseenter"],je=["href","onClick"],Ye=["href","target"],We=["id"];function Qe(e,t,s,o,a,n){const c=I("router-link"),d=I("AngleRightIcon"),l=I("TieredMenuSub",!0),p=ve("ripple");return h(),g("ul",ge(_e(e.ptm("menu"))),[(h(!0),g(A,null,ye(s.items,(i,u)=>(h(),g(A,{key:n.getItemKey(i)},[n.isItemVisible(i)&&!n.getItemProp(i,"separator")?(h(),g("li",_({key:0,id:n.getItemId(i),style:n.getItemProp(i,"style"),class:n.getItemClass(i),role:"menuitem","aria-label":n.getItemLabel(i),"aria-disabled":n.isItemDisabled(i)||void 0,"aria-expanded":n.isItemGroup(i)?n.isItemActive(i):void 0,"aria-haspopup":n.isItemGroup(i)&&!n.getItemProp(i,"to")?"menu":void 0,"aria-level":s.level+1,"aria-setsize":n.getAriaSetSize(),"aria-posinset":n.getAriaPosInset(u)},n.getPTOptions(i,"menuitem")),[r("div",_({class:"p-menuitem-content",onClick:f=>n.onItemClick(f,i),onMouseenter:f=>n.onItemMouseEnter(f,i)},n.getPTOptions(i,"content")),[s.templates.item?(h(),C(F(s.templates.item),{key:1,item:i.item},null,8,["item"])):(h(),g(A,{key:0},[n.getItemProp(i,"to")&&!n.isItemDisabled(i)?(h(),C(c,{key:0,to:n.getItemProp(i,"to"),custom:""},{default:y(({navigate:f,href:b,isActive:v,isExactActive:k})=>[te((h(),g("a",_({href:b,class:n.getItemActionClass(i,{isActive:v,isExactActive:k}),tabindex:"-1","aria-hidden":"true",onClick:q=>n.onItemActionClick(q,f)},n.getPTOptions(i,"action")),[s.templates.itemicon?(h(),C(F(s.templates.itemicon),{key:0,item:i.item,class:Y(n.getItemIconClass(i))},null,8,["item","class"])):n.getItemProp(i,"icon")?(h(),g("span",_({key:1,class:n.getItemIconClass(i)},n.getPTOptions(i,"icon")),null,16)):w("",!0),r("span",_({class:"p-menuitem-text"},n.getPTOptions(i,"label")),L(n.getItemLabel(i)),17)],16,je)),[[p]])]),_:2},1032,["to"])):te((h(),g("a",_({key:1,href:n.getItemProp(i,"url"),class:n.getItemActionClass(i),target:n.getItemProp(i,"target"),tabindex:"-1","aria-hidden":"true"},n.getPTOptions(i,"action")),[s.templates.itemicon?(h(),C(F(s.templates.itemicon),{key:0,item:i.item,class:Y(n.getItemIconClass(i))},null,8,["item","class"])):n.getItemProp(i,"icon")?(h(),g("span",_({key:1,class:n.getItemIconClass(i)},n.getPTOptions(i,"icon")),null,16)):w("",!0),r("span",_({class:"p-menuitem-text"},n.getPTOptions(i,"label")),L(n.getItemLabel(i)),17),n.getItemProp(i,"items")?(h(),g(A,{key:2},[s.templates.submenuicon?(h(),C(F(s.templates.submenuicon),_({key:0,class:"p-submenu-icon",active:n.isItemActive(i)},n.getPTOptions(i,"submenuIcon")),null,16,["active"])):(h(),C(d,_({key:1,class:"p-submenu-icon"},n.getPTOptions(i,"submenuIcon")),null,16))],64)):w("",!0)],16,Ye)),[[p]])],64))],16,Ze),n.isItemVisible(i)&&n.isItemGroup(i)?(h(),C(l,{key:0,id:n.getItemId(i)+"_list",role:"menu",class:"p-submenu-list",menuId:s.menuId,focusedItemId:s.focusedItemId,items:i.items,templates:s.templates,activeItemPath:s.activeItemPath,exact:s.exact,level:s.level+1,pt:e.pt,onItemClick:t[0]||(t[0]=f=>e.$emit("item-click",f)),onItemMouseenter:t[1]||(t[1]=f=>e.$emit("item-mouseenter",f))},null,8,["id","menuId","focusedItemId","items","templates","activeItemPath","exact","level","pt"])):w("",!0)],16,He)):w("",!0),n.isItemVisible(i)&&n.getItemProp(i,"separator")?(h(),g("li",_({key:1,id:n.getItemId(i),style:n.getItemProp(i,"style"),class:n.getSeparatorItemClass(i),role:"separator"},e.ptm("separator")),null,16,We)):w("",!0)],64))),128))],16)}le.render=Qe;var oe={name:"TieredMenu",extends:Q,inheritAttrs:!1,emits:["focus","blur","before-show","before-hide","hide","show"],props:{popup:{type:Boolean,default:!1},model:{type:Array,default:null},appendTo:{type:String,default:"body"},autoZIndex:{type:Boolean,default:!0},baseZIndex:{type:Number,default:0},exact:{type:Boolean,default:!0},disabled:{type:Boolean,default:!1},tabindex:{type:Number,default:0},"aria-labelledby":{type:String,default:null},"aria-label":{type:String,default:null}},outsideClickListener:null,scrollHandler:null,resizeListener:null,target:null,container:null,menubar:null,searchTimeout:null,searchValue:null,data(){return{id:this.$attrs.id,focused:!1,focusedItemInfo:{index:-1,level:0,parentKey:""},activeItemPath:[],visible:!this.popup,dirty:!1}},watch:{"$attrs.id":function(e){this.id=e||W()},activeItemPath(e){this.popup||(x.isNotEmpty(e)?(this.bindOutsideClickListener(),this.bindResizeListener()):(this.unbindOutsideClickListener(),this.unbindResizeListener()))}},mounted(){this.id=this.id||W()},beforeUnmount(){this.unbindOutsideClickListener(),this.unbindResizeListener(),this.scrollHandler&&(this.scrollHandler.destroy(),this.scrollHandler=null),this.container&&this.autoZIndex&&H.clear(this.container),this.target=null,this.container=null},methods:{getItemProp(e,t){return e?x.getItemValue(e[t]):void 0},getItemLabel(e){return this.getItemProp(e,"label")},isItemDisabled(e){return this.getItemProp(e,"disabled")},isItemGroup(e){return x.isNotEmpty(this.getItemProp(e,"items"))},isItemSeparator(e){return this.getItemProp(e,"separator")},getProccessedItemLabel(e){return e?this.getItemLabel(e.item):void 0},isProccessedItemGroup(e){return e&&x.isNotEmpty(e.items)},toggle(e){this.visible?this.hide(e,!0):this.show(e)},show(e,t){this.popup&&(this.$emit("before-show"),this.visible=!0,this.target=this.target||e.currentTarget,this.relatedTarget=e.relatedTarget||null),this.focusedItemInfo={index:this.findFirstFocusedItemIndex(),level:0,parentKey:""},t&&P.focus(this.menubar)},hide(e,t){this.popup&&(this.$emit("before-hide"),this.visible=!1),this.activeItemPath=[],this.focusedItemInfo={index:-1,level:0,parentKey:""},t&&P.focus(this.relatedTarget||this.target||this.menubar),this.dirty=!1},onFocus(e){this.focused=!0,this.focusedItemInfo=this.focusedItemInfo.index!==-1?this.focusedItemInfo:{index:this.findFirstFocusedItemIndex(),level:0,parentKey:""},this.$emit("focus",e)},onBlur(e){this.focused=!1,this.focusedItemInfo={index:-1,level:0,parentKey:""},this.searchValue="",this.dirty=!1,this.$emit("blur",e)},onKeyDown(e){if(this.disabled){e.preventDefault();return}const t=e.metaKey||e.ctrlKey;switch(e.code){case"ArrowDown":this.onArrowDownKey(e);break;case"ArrowUp":this.onArrowUpKey(e);break;case"ArrowLeft":this.onArrowLeftKey(e);break;case"ArrowRight":this.onArrowRightKey(e);break;case"Home":this.onHomeKey(e);break;case"End":this.onEndKey(e);break;case"Space":this.onSpaceKey(e);break;case"Enter":this.onEnterKey(e);break;case"Escape":this.onEscapeKey(e);break;case"Tab":this.onTabKey(e);break;case"PageDown":case"PageUp":case"Backspace":case"ShiftLeft":case"ShiftRight":break;default:!t&&x.isPrintableCharacter(e.key)&&this.searchItems(e,e.key);break}},onItemChange(e){const{processedItem:t,isFocus:s}=e;if(x.isEmpty(t))return;const{index:o,key:a,level:n,parentKey:c,items:d}=t,l=x.isNotEmpty(d),p=this.activeItemPath.filter(i=>i.parentKey!==c&&i.parentKey!==a);l&&p.push(t),this.focusedItemInfo={index:o,level:n,parentKey:c},this.activeItemPath=p,l&&(this.dirty=!0),s&&P.focus(this.menubar)},onOverlayClick(e){xe.emit("overlay-click",{originalEvent:e,target:this.target})},onItemClick(e){const{originalEvent:t,processedItem:s}=e,o=this.isProccessedItemGroup(s),a=x.isEmpty(s.parent);if(this.isSelected(s)){const{index:c,key:d,level:l,parentKey:p}=s;this.activeItemPath=this.activeItemPath.filter(i=>d!==i.key&&d.startsWith(i.key)),this.focusedItemInfo={index:c,level:l,parentKey:p},this.dirty=!a,P.focus(this.menubar)}else if(o)this.onItemChange(e);else{const c=a?s:this.activeItemPath.find(d=>d.parentKey==="");this.hide(t),this.changeFocusedItemIndex(t,c?c.index:-1),P.focus(this.menubar)}},onItemMouseEnter(e){this.dirty&&this.onItemChange(e)},onArrowDownKey(e){const t=this.focusedItemInfo.index!==-1?this.findNextItemIndex(this.focusedItemInfo.index):this.findFirstFocusedItemIndex();this.changeFocusedItemIndex(e,t),e.preventDefault()},onArrowUpKey(e){if(e.altKey){if(this.focusedItemInfo.index!==-1){const t=this.visibleItems[this.focusedItemInfo.index];!this.isProccessedItemGroup(t)&&this.onItemChange({originalEvent:e,processedItem:t})}this.popup&&this.hide(e,!0),e.preventDefault()}else{const t=this.focusedItemInfo.index!==-1?this.findPrevItemIndex(this.focusedItemInfo.index):this.findLastFocusedItemIndex();this.changeFocusedItemIndex(e,t),e.preventDefault()}},onArrowLeftKey(e){const t=this.visibleItems[this.focusedItemInfo.index],s=this.activeItemPath.find(a=>a.key===t.parentKey);x.isEmpty(t.parent)||(this.focusedItemInfo={index:-1,parentKey:s?s.parentKey:""},this.searchValue="",this.onArrowDownKey(e)),this.activeItemPath=this.activeItemPath.filter(a=>a.parentKey!==this.focusedItemInfo.parentKey),e.preventDefault()},onArrowRightKey(e){const t=this.visibleItems[this.focusedItemInfo.index];this.isProccessedItemGroup(t)&&(this.onItemChange({originalEvent:e,processedItem:t}),this.focusedItemInfo={index:-1,parentKey:t.key},this.searchValue="",this.onArrowDownKey(e)),e.preventDefault()},onHomeKey(e){this.changeFocusedItemIndex(e,this.findFirstItemIndex()),e.preventDefault()},onEndKey(e){this.changeFocusedItemIndex(e,this.findLastItemIndex()),e.preventDefault()},onEnterKey(e){if(this.focusedItemInfo.index!==-1){const t=P.findSingle(this.menubar,`li[id="${`${this.focusedItemId}`}"]`),s=t&&P.findSingle(t,".p-menuitem-link");if(s?s.click():t&&t.click(),!this.popup){const o=this.visibleItems[this.focusedItemInfo.index];!this.isProccessedItemGroup(o)&&(this.focusedItemInfo.index=this.findFirstFocusedItemIndex())}}e.preventDefault()},onSpaceKey(e){this.onEnterKey(e)},onEscapeKey(e){this.hide(e,!0),!this.popup&&(this.focusedItemInfo.index=this.findFirstFocusedItemIndex()),e.preventDefault()},onTabKey(e){if(this.focusedItemInfo.index!==-1){const t=this.visibleItems[this.focusedItemInfo.index];!this.isProccessedItemGroup(t)&&this.onItemChange({originalEvent:e,processedItem:t})}this.hide()},onEnter(e){this.autoZIndex&&H.set("menu",e,this.baseZIndex+this.$primevue.config.zIndex.menu),this.alignOverlay(),P.focus(this.menubar),this.scrollInView()},onAfterEnter(){this.bindOutsideClickListener(),this.bindScrollListener(),this.bindResizeListener(),this.$emit("show")},onLeave(){this.unbindOutsideClickListener(),this.unbindScrollListener(),this.unbindResizeListener(),this.$emit("hide"),this.container=null,this.dirty=!1},onAfterLeave(e){this.autoZIndex&&H.clear(e)},alignOverlay(){this.container.style.minWidth=P.getOuterWidth(this.target)+"px",P.absolutePosition(this.container,this.target)},bindOutsideClickListener(){this.outsideClickListener||(this.outsideClickListener=e=>{const t=this.container&&!this.container.contains(e.target),s=this.popup?!(this.target&&(this.target===e.target||this.target.contains(e.target))):!0;t&&s&&this.hide()},document.addEventListener("click",this.outsideClickListener))},unbindOutsideClickListener(){this.outsideClickListener&&(document.removeEventListener("click",this.outsideClickListener),this.outsideClickListener=null)},bindScrollListener(){this.scrollHandler||(this.scrollHandler=new ke(this.target,e=>{this.hide(e,!0)})),this.scrollHandler.bindScrollListener()},unbindScrollListener(){this.scrollHandler&&this.scrollHandler.unbindScrollListener()},bindResizeListener(){this.resizeListener||(this.resizeListener=e=>{P.isTouchDevice()||this.hide(e,!0)},window.addEventListener("resize",this.resizeListener))},unbindResizeListener(){this.resizeListener&&(window.removeEventListener("resize",this.resizeListener),this.resizeListener=null)},isItemMatched(e){return this.isValidItem(e)&&this.getProccessedItemLabel(e).toLocaleLowerCase().startsWith(this.searchValue.toLocaleLowerCase())},isValidItem(e){return!!e&&!this.isItemDisabled(e.item)&&!this.isItemSeparator(e.item)},isValidSelectedItem(e){return this.isValidItem(e)&&this.isSelected(e)},isSelected(e){return this.activeItemPath.some(t=>t.key===e.key)},findFirstItemIndex(){return this.visibleItems.findIndex(e=>this.isValidItem(e))},findLastItemIndex(){return x.findLastIndex(this.visibleItems,e=>this.isValidItem(e))},findNextItemIndex(e){const t=e<this.visibleItems.length-1?this.visibleItems.slice(e+1).findIndex(s=>this.isValidItem(s)):-1;return t>-1?t+e+1:e},findPrevItemIndex(e){const t=e>0?x.findLastIndex(this.visibleItems.slice(0,e),s=>this.isValidItem(s)):-1;return t>-1?t:e},findSelectedItemIndex(){return this.visibleItems.findIndex(e=>this.isValidSelectedItem(e))},findFirstFocusedItemIndex(){const e=this.findSelectedItemIndex();return e<0?this.findFirstItemIndex():e},findLastFocusedItemIndex(){const e=this.findSelectedItemIndex();return e<0?this.findLastItemIndex():e},searchItems(e,t){this.searchValue=(this.searchValue||"")+t;let s=-1,o=!1;return this.focusedItemInfo.index!==-1?(s=this.visibleItems.slice(this.focusedItemInfo.index).findIndex(a=>this.isItemMatched(a)),s=s===-1?this.visibleItems.slice(0,this.focusedItemInfo.index).findIndex(a=>this.isItemMatched(a)):s+this.focusedItemInfo.index):s=this.visibleItems.findIndex(a=>this.isItemMatched(a)),s!==-1&&(o=!0),s===-1&&this.focusedItemInfo.index===-1&&(s=this.findFirstFocusedItemIndex()),s!==-1&&this.changeFocusedItemIndex(e,s),this.searchTimeout&&clearTimeout(this.searchTimeout),this.searchTimeout=setTimeout(()=>{this.searchValue="",this.searchTimeout=null},500),o},changeFocusedItemIndex(e,t){this.focusedItemInfo.index!==t&&(this.focusedItemInfo.index=t,this.scrollInView())},scrollInView(e=-1){const t=e!==-1?`${this.id}_${e}`:this.focusedItemId,s=P.findSingle(this.menubar,`li[id="${t}"]`);s&&s.scrollIntoView&&s.scrollIntoView({block:"nearest",inline:"start"})},createProcessedItems(e,t=0,s={},o=""){const a=[];return e&&e.forEach((n,c)=>{const d=(o!==""?o+"_":"")+c,l={item:n,index:c,level:t,key:d,parent:s,parentKey:o};l.items=this.createProcessedItems(n.items,t+1,l,d),a.push(l)}),a},containerRef(e){this.container=e},menubarRef(e){this.menubar=e?e.$el:void 0}},computed:{containerClass(){return["p-tieredmenu p-component",{"p-tieredmenu-overlay":this.popup,"p-input-filled":this.$primevue.config.inputStyle==="filled","p-ripple-disabled":this.$primevue.config.ripple===!1}]},processedItems(){return this.createProcessedItems(this.model||[])},visibleItems(){const e=this.activeItemPath.find(t=>t.key===this.focusedItemInfo.parentKey);return e?e.items:this.processedItems},focusedItemId(){return this.focusedItemInfo.index!==-1?`${this.id}${x.isNotEmpty(this.focusedItemInfo.parentKey)?"_"+this.focusedItemInfo.parentKey:""}_${this.focusedItemInfo.index}`:null}},components:{TieredMenuSub:le,Portal:Ce}};const Je=["id"];function Xe(e,t,s,o,a,n){const c=I("TieredMenuSub"),d=I("Portal");return h(),C(d,{appendTo:s.appendTo,disabled:!s.popup},{default:y(()=>[m(De,{name:"p-connected-overlay",onEnter:n.onEnter,onAfterEnter:n.onAfterEnter,onLeave:n.onLeave,onAfterLeave:n.onAfterLeave},{default:y(()=>[a.visible?(h(),g("div",_({key:0,ref:n.containerRef,id:a.id,class:n.containerClass,onClick:t[0]||(t[0]=(...l)=>n.onOverlayClick&&n.onOverlayClick(...l))},{...e.$attrs,...e.ptm("root")}),[m(c,{ref:n.menubarRef,id:a.id+"_list",class:"p-tieredmenu-root-list",tabindex:s.disabled?-1:s.tabindex,role:"menubar","aria-label":e.ariaLabel,"aria-labelledby":e.ariaLabelledby,"aria-disabled":s.disabled||void 0,"aria-orientation":"vertical","aria-activedescendant":a.focused?n.focusedItemId:void 0,menuId:a.id,focusedItemId:a.focused?n.focusedItemId:void 0,items:n.processedItems,templates:e.$slots,activeItemPath:a.activeItemPath,exact:s.exact,level:0,pt:e.pt,onFocus:n.onFocus,onBlur:n.onBlur,onKeydown:n.onKeyDown,onItemClick:n.onItemClick,onItemMouseenter:n.onItemMouseEnter},null,8,["id","tabindex","aria-label","aria-labelledby","aria-disabled","aria-activedescendant","menuId","focusedItemId","items","templates","activeItemPath","exact","pt","onFocus","onBlur","onKeydown","onItemClick","onItemMouseenter"])],16,Je)):w("",!0)]),_:1},8,["onEnter","onAfterEnter","onLeave","onAfterLeave"])]),_:1},8,["appendTo","disabled"])}function $e(e,t){t===void 0&&(t={});var s=t.insertAt;if(!(!e||typeof document>"u")){var o=document.head||document.getElementsByTagName("head")[0],a=document.createElement("style");a.type="text/css",s==="top"&&o.firstChild?o.insertBefore(a,o.firstChild):o.appendChild(a),a.styleSheet?a.styleSheet.cssText=e:a.appendChild(document.createTextNode(e))}}var et=`
.p-tieredmenu-overlay {
    position: absolute;
    top: 0;
    left: 0;
}
.p-tieredmenu ul {
    margin: 0;
    padding: 0;
    list-style: none;
}
.p-tieredmenu .p-submenu-list {
    position: absolute;
    min-width: 100%;
    z-index: 1;
    display: none;
}
.p-tieredmenu .p-menuitem-link {
    cursor: pointer;
    display: flex;
    align-items: center;
    text-decoration: none;
    overflow: hidden;
    position: relative;
}
.p-tieredmenu .p-menuitem-text {
    line-height: 1;
}
.p-tieredmenu .p-menuitem {
    position: relative;
}
.p-tieredmenu .p-menuitem-link .p-submenu-icon {
    margin-left: auto;
}
.p-tieredmenu .p-menuitem-active > .p-submenu-list {
    display: block;
    left: 100%;
    top: 0;
}
`;$e(et);oe.render=Xe;var $={name:"SplitButton",extends:Q,emits:["click"],props:{label:{type:String,default:null},icon:{type:String,default:null},model:{type:Array,default:null},autoZIndex:{type:Boolean,default:!0},baseZIndex:{type:Number,default:0},appendTo:{type:String,default:"body"},disabled:{type:Boolean,default:!1},class:{type:null,default:null},style:{type:null,default:null},buttonProps:{type:null,default:null},menuButtonProps:{type:null,default:null},menuButtonIcon:{type:String,default:void 0},severity:{type:String,default:null},raised:{type:Boolean,default:!1},rounded:{type:Boolean,default:!1},text:{type:Boolean,default:!1},outlined:{type:Boolean,default:!1},size:{type:String,default:null},plain:{type:Boolean,default:!1}},data(){return{isExpanded:!1}},methods:{onDropdownButtonClick(){this.$refs.menu.toggle({currentTarget:this.$el,relatedTarget:this.$refs.button.$el}),this.isExpanded=!this.$refs.menu.visible},onDropdownKeydown(e){(e.code==="ArrowDown"||e.code==="ArrowUp")&&(this.onDropdownButtonClick(),e.preventDefault())},onDefaultButtonClick(e){this.isExpanded&&this.$refs.menu.hide(e),this.$emit("click",e)}},computed:{ariaId(){return W()},containerClass(){return["p-splitbutton p-component",this.class,{[`p-button-${this.severity}`]:this.severity,"p-button-raised":this.raised,"p-button-rounded":this.rounded,"p-button-text":this.text,"p-button-outlined":this.outlined,"p-button-sm":this.size==="small","p-button-lg":this.size==="large"}]}},components:{PVSButton:Pe,PVSMenu:oe,ChevronDownIcon:we}};function tt(e,t,s,o,a,n){const c=I("PVSButton"),d=I("PVSMenu");return h(),g("div",_({class:n.containerClass,style:s.style},e.ptm("root")),[M(e.$slots,"default",{},()=>[m(c,_({type:"button",class:"p-splitbutton-defaultbutton",label:s.label,disabled:s.disabled,"aria-label":s.label,onClick:n.onDefaultButtonClick,pt:e.ptm("button")},s.buttonProps),{icon:y(l=>[M(e.$slots,"icon",{},()=>[r("span",_({class:[s.icon,l.class]},e.ptm("button").icon),null,16)])]),_:3},16,["label","disabled","aria-label","onClick","pt"])]),m(c,_({ref:"button",type:"button",class:"p-splitbutton-menubutton",disabled:s.disabled,"aria-haspopup":"true","aria-expanded":a.isExpanded,"aria-controls":n.ariaId+"_overlay",onClick:n.onDropdownButtonClick,onKeydown:n.onDropdownKeydown,pt:e.ptm("menuButton")},s.menuButtonProps),{icon:y(l=>[M(e.$slots,"menubuttonicon",{},()=>[(h(),C(F(s.menuButtonIcon?"span":"ChevronDownIcon"),_({class:[s.menuButtonIcon,l.class]},e.ptm("menuButton").icon),null,16,["class"]))])]),_:3},16,["disabled","aria-expanded","aria-controls","onClick","onKeydown","pt"]),m(d,{ref:"menu",id:n.ariaId+"_overlay",model:s.model,popup:!0,autoZIndex:s.autoZIndex,baseZIndex:s.baseZIndex,appendTo:s.appendTo,pt:e.ptm("menu")},null,8,["id","model","autoZIndex","baseZIndex","appendTo","pt"])],16)}function it(e,t){t===void 0&&(t={});var s=t.insertAt;if(!(!e||typeof document>"u")){var o=document.head||document.getElementsByTagName("head")[0],a=document.createElement("style");a.type="text/css",s==="top"&&o.firstChild?o.insertBefore(a,o.firstChild):o.appendChild(a),a.styleSheet?a.styleSheet.cssText=e:a.appendChild(document.createTextNode(e))}}var nt=`
.p-splitbutton[data-v-29147f7b] {
    display: inline-flex;
    position: relative;
}
.p-splitbutton .p-splitbutton-defaultbutton[data-v-29147f7b],
.p-splitbutton.p-button-rounded > .p-splitbutton-defaultbutton.p-button[data-v-29147f7b],
.p-splitbutton.p-button-outlined > .p-splitbutton-defaultbutton.p-button[data-v-29147f7b] {
    flex: 1 1 auto;
    border-top-right-radius: 0;
    border-bottom-right-radius: 0;
    border-right: 0 none;
}
.p-splitbutton-menubutton[data-v-29147f7b],
.p-splitbutton.p-button-rounded > .p-splitbutton-menubutton.p-button[data-v-29147f7b],
.p-splitbutton.p-button-outlined > .p-splitbutton-menubutton.p-button[data-v-29147f7b] {
    display: flex;
    align-items: center;
    justify-content: center;
    border-top-left-radius: 0;
    border-bottom-left-radius: 0;
}
.p-splitbutton .p-menu[data-v-29147f7b] {
    min-width: 100%;
}
.p-fluid .p-splitbutton[data-v-29147f7b] {
    display: flex;
}
`;it(nt);$.render=tt;$.__scopeId="data-v-29147f7b";const st={key:0},at={class:"four-columns"},lt={class:"mt-2"},ot={class:"mt-2"},rt=r("label",{class:"block text-900 mb-2"},"Data Factura",-1),dt={class:"mt-2"},ut=r("label",{class:"block text-900 mb-2"},"Estat",-1),ct={class:"mt-2"},mt=r("label",{class:"block text-900 mb-2"},"Métode Pagament",-1),ht={class:"three-columns"},ft={class:"mt-1"},pt=r("label",{class:"block text-900 mb-2"},"Base",-1),It={class:"summary-field"},bt={class:"mt-1"},vt=r("label",{class:"block text-900 mb-2"},"Impostos",-1),yt={class:"summary-field"},gt={class:"mt-1"},_t=r("label",{class:"block text-900 mb-2"},"Total",-1),xt={class:"summary-field"},kt=O({__name:"FormSalesInvoice",props:{invoice:{}},emits:["submit","cancel"],setup(e,{emit:t}){J();const s=U(),o=X();return ae().shape({invoiceDate:ie().required("La data és obligatoria"),paymentMethodId:ie().required("El métode de pagament és obligatori")}),B({result:!1,errors:{}}),(a,n)=>{var p;const c=I("BaseInput"),d=I("Calendar"),l=I("Dropdown");return a.invoice?(h(),g("form",st,[r("header",null,[r("section",at,[r("div",lt,[m(c,{modelValue:a.invoice.invoiceNumber,"onUpdate:modelValue":n[0]||(n[0]=i=>a.invoice.invoiceNumber=i),label:"Número",disabled:!0},null,8,["modelValue"])]),r("div",ot,[rt,m(d,{modelValue:a.invoice.invoiceDate,"onUpdate:modelValue":n[1]||(n[1]=i=>a.invoice.invoiceDate=i),dateFormat:"dd/mm/yy"},null,8,["modelValue"])]),r("div",dt,[ut,m(l,{modelValue:a.invoice.statusId,"onUpdate:modelValue":n[2]||(n[2]=i=>a.invoice.statusId=i),editable:"",options:(p=D(o).lifecycle)==null?void 0:p.statuses,optionValue:"id",optionLabel:"name",class:"w-full"},null,8,["modelValue","options"])]),r("div",ct,[mt,m(l,{modelValue:a.invoice.paymentMethodId,"onUpdate:modelValue":n[3]||(n[3]=i=>a.invoice.paymentMethodId=i),editable:"",options:D(s).paymentMethods,optionValue:"id",optionLabel:"name",class:"w-full"},null,8,["modelValue","options"])])]),r("section",ht,[r("div",ft,[pt,r("span",It,L(a.invoice.baseAmount)+" €",1)]),r("div",bt,[vt,r("span",yt,L(a.invoice.taxAmount)+" €",1)]),r("div",gt,[_t,r("span",xt,L(a.invoice.netAmount)+" €",1)])])])])):w("",!0)}}}),Ct=["onClick"],Dt=O({__name:"TableInvoiceDetails",props:{details:{},headerVisible:{type:Boolean}},emits:["edit","delete"],setup(e,{emit:t}){const s=X(),o=U();se(async()=>{await s.fetchOneByName("SalesInvoice")});const a=c=>{var l;const d=(l=o.taxes)==null?void 0:l.find(p=>p.id===c);if(d)return`${d.percentatge} %`},n=(c,d)=>{t("delete",d)};return(c,d)=>{const l=I("Column"),p=I("DataTable");return h(),C(p,{class:"small-datatable",tableStyle:"min-width: 100%",scrollable:"",scrollHeight:"55vh",sortMode:"multiple",value:c.details},Se({default:y(()=>[m(l,{header:"Quantitat",field:"quantity",style:{width:"10%"}}),m(l,{header:"Descripció",field:"description",style:{width:"40%"}}),m(l,{header:"Preu unitat",field:"unitCost",style:{width:"10%"}},{body:y(i=>[T(L(i.data.unitCost)+" € ",1)]),_:1}),m(l,{header:"IVA",style:{width:"10%"}},{body:y(i=>[T(L(a(i.data.taxId)),1)]),_:1}),m(l,{header:"Total",field:"totalCost",style:{width:"10%"}},{body:y(i=>[T(L(i.data.amount)+" € ",1)]),_:1}),m(l,{style:{width:"10%"}},{body:y(i=>[r("i",{class:Y([D(R).TIMES,"grid_delete_column_button"]),onClick:u=>n(u,i.data)},null,10,Ct)]),_:1})]),_:2},[c.headerVisible?{name:"header",fn:y(()=>[M(c.$slots,"header")]),key:"0"}:void 0]),1032,["value"])}}}),Pt={key:0},wt={class:"two-columns-7525"},St={class:"mt-2"},Lt={class:"mt-2"},Vt=r("label",{class:"block text-900 mb-2"},"Impost",-1),Et={class:"three-columns"},Tt={class:"mt-2"},Bt={class:"mt-2"},At={class:"mt-2"},Ft=O({__name:"FormSalesInvoiceDetail",props:{invoiceDetail:{}},emits:["submit","cancel"],setup(e,{emit:t}){const s=e,o=J(),a=U(),n=()=>{const i=s.invoiceDetail;i.quantity&&i.quantity>0&&i.unitPrice&&i.unitPrice>0&&(s.invoiceDetail.unitCost=i.unitPrice,s.invoiceDetail.amount=qe.round(i.quantity*i.unitPrice,2),s.invoiceDetail.totalCost=s.invoiceDetail.amount)},c=ae().shape({quantity:ne().min(1).required("La quantitat ha de ser superior a 1"),unitPrice:ne().min(.01).required("El preu unitat és obligatori")}),d=B({result:!1,errors:{}}),l=()=>{const i=new Ue(c);d.value=i.validate(s.invoiceDetail)},p=async()=>{if(l(),d.value.result)t("submit",s.invoiceDetail);else{let i="";Object.entries(d.value.errors).forEach(u=>{i+=`${u[1].map(f=>f)}.   `}),o.add({severity:"warn",summary:"Formulari inválid",detail:i,life:5e3})}};return(i,u)=>{const f=I("Dropdown"),b=I("Button");return i.invoiceDetail?(h(),g("form",Pt,[r("section",wt,[r("div",St,[m(z,{label:"Descripció",modelValue:i.invoiceDetail.description,"onUpdate:modelValue":u[0]||(u[0]=v=>i.invoiceDetail.description=v)},null,8,["modelValue"])]),r("div",Lt,[Vt,m(f,{modelValue:i.invoiceDetail.taxId,"onUpdate:modelValue":u[1]||(u[1]=v=>i.invoiceDetail.taxId=v),editable:"",options:D(a).taxes,optionValue:"id",optionLabel:"name",class:"w-full"},null,8,["modelValue","options"])])]),r("section",Et,[r("div",Tt,[m(z,{type:D(Z).NUMERIC,label:"Quantitat",modelValue:i.invoiceDetail.quantity,"onUpdate:modelValue":[u[2]||(u[2]=v=>i.invoiceDetail.quantity=v),n]},null,8,["type","modelValue"])]),r("div",Bt,[m(z,{type:D(Z).CURRENCY,label:"Preu Unitat","model-value":i.invoiceDetail.unitPrice,"onUpdate:modelValue":[u[3]||(u[3]=v=>i.invoiceDetail.unitPrice=v),n]},null,8,["type","model-value"])]),r("div",At,[m(z,{type:D(Z).CURRENCY,label:"Total","model-value":i.invoiceDetail.amount,"onUpdate:modelValue":u[4]||(u[4]=v=>i.invoiceDetail.amount=v),disabled:""},null,8,["type","model-value"])])]),m(b,{label:"Crear",onClick:p,style:{float:"right"},size:"small",class:"mt-2"})])):w("",!0)}}}),Ot=e=>(Ve("data-v-f38440b9"),e=e(),Ee(),e),Kt={class:"selector-filter"},zt={class:"selector-filter-field"},Mt=Ot(()=>r("label",{for:""},"Comanda",-1)),Nt={class:"selector-filter-button"},Rt={class:"flex align-items-center gap-2"},Ut=O({__name:"SelectorOrderDetails",props:{details:{},headerVisible:{type:Boolean}},emits:["selected"],setup(e,{emit:t}){const s=e,o=B([]),a=B(""),n=Le(()=>{var d;return a.value.length===0?s.details:(d=s.details)==null?void 0:d.filter(l=>l.salesOrderNumber.toString().includes(a.value))}),c=()=>{if(o.value.length===0)return;const d=o.value.map(l=>({salesOrderHeaderId:l.salesOrderId,description:l.description,isInvoiced:!0,isServed:l.isServed,quantity:l.quantity,referenceId:l.referenceId,id:l.id,unitCost:l.unitCost,unitPrice:l.unitPrice,totalCost:l.totalCost,amount:l.amount}));t("selected",d)};return(d,l)=>{const p=I("InputText"),i=I("Button"),u=I("Column"),f=I("DataTable");return h(),C(f,{class:"small-datatable",tableStyle:"min-width: 100%",scrollable:"",scrollHeight:"70vh",value:n.value,selectionMode:"multiple",selection:o.value,"onUpdate:selection":l[1]||(l[1]=b=>o.value=b),"meta-key-selection":!1,rowGroupMode:"subheader",groupRowsBy:"salesOrderNumber",sortMode:"single",sortField:"salesOrderNumber"},{header:y(()=>[r("header",Kt,[r("div",zt,[Mt,T("   "),m(p,{style:{width:"150px",height:"35px"},modelValue:a.value,"onUpdate:modelValue":l[0]||(l[0]=b=>a.value=b),size:"small"},null,8,["modelValue"])]),r("div",Nt,[m(i,{onClick:c,size:"small",icon:D(R).CHECK_SQUARE},null,8,["icon"])])])]),groupheader:y(b=>[r("div",Rt,[r("b",null,"Comanda "+L(b.data.salesOrderNumber)+" - "+L(D(N)(b.data.salesOrderDate)),1)])]),default:y(()=>[m(u,{header:"Quantitat",field:"quantity",style:{width:"10%"}}),m(u,{header:"Descripció",field:"description",style:{width:"50%"}}),m(u,{header:"Preu",field:"amount",style:{width:"10%"}},{body:y(b=>[T(L(b.data.amount)+" € ",1)]),_:1})]),_:1},8,["value","selection"])}}});const qt=Te(Ut,[["__scopeId","data-v-f38440b9"]]),Gt={key:0},Ht={class:"flex flex-wrap align-items-center justify-content-between gap-2"},Zt=r("span",{class:"text-xl text-900 font-bold"},"Detall de la factura",-1),li=O({__name:"SalesInvoice",setup(e){const t=[{label:"Generar factura",icon:R.FILE_PDF,command:()=>s()}],s=()=>{},o=J(),a=Be(),n=Ae(),c=Fe(),d=Oe(),l=U(),p=Ne(),i=X(),u=Me(),{invoice:f}=Ke(u),b={Free:0,FromOrder:1},v=B(0),k=j({visible:!1,title:"",closable:!0,position:"center",modal:!0});se(async()=>{l.fetchMasterData(),p.fetchCustomers(),i.fetchOneByName("SalesInvoice"),await u.GetById(n.params.id),u.invoice.invoiceDate=N(u.invoice.invoiceDate),d.setMenuItem({icon:R.WALLET,title:`Factura de venta ${f.value.invoiceNumber} - ${f.value.customerComercialName}`,backButtonVisible:!0})});const q=async()=>{f.value.invoiceDate=Re(f.value.invoiceDate),await u.Update(f.value)&&(o.add({summary:"Factura de venta",detail:"Actualizada correctament",life:5e3}),c.back())},ee=B([]),G=j({}),re=async()=>{f.value&&(ee.value=await Ge.SalesInvoice.GetInvoiceableOrderDetails(f.value.customerId),G.invoiceId=f.value.id,v.value=b.FromOrder,k.title="Selecció de linees de comanda",k.visible=!0)},de=async S=>{G.orderDetails=S,await u.CreateInvoiceDetailsFromOrderDetails(G)&&await u.GetById(n.params.id),k.visible=!1},V=j({}),ue=()=>{var S;if(v.value=b.Free,f.value){V.salesInvoiceId=f.value.id,V.quantity=1,V.description="",V.totalCost=0;const E=(S=l.taxes)==null?void 0:S.find(K=>K.name.includes("0"));E&&(V.taxId=E.id),k.title="Introducció de línea lliure",k.visible=!0}},ce=async()=>{await u.CreateInvoiceDetail(V),k.visible=!1,u.invoice.invoiceDate=N(u.invoice.invoiceDate)},me=async S=>{await u.UpdateInvoiceDetail(S)},he=async S=>{a.require({message:`Està segur que vol eliminar la línea ${S.description}?`,icon:"pi pi-question-circle",acceptIcon:"pi pi-check",rejectIcon:"pi pi-times",accept:async()=>{await u.DeleteInvoiceDetail(S),u.invoice.invoiceDate=N(u.invoice.invoiceDate)}})};return(S,E)=>{const K=I("Button"),fe=I("Dialog");return h(),g(A,null,[m(D($),{label:"Guardar",onClick:q,model:t,size:"small",class:"grid_add_row_button"}),D(f)?(h(),g("main",Gt,[m(kt,{class:"mt-3 mr-3",invoice:D(f)},null,8,["invoice"]),m(Dt,{class:"mt-3","header-visible":!0,details:D(f).salesInvoiceDetails,onEdit:me,onDelete:he},{header:y(()=>[r("div",Ht,[Zt,r("div",null,[m(K,{size:"small",label:"Afegir de comanda",onClick:re}),T("    "),m(K,{size:"small",label:"Crear linia lliure",onClick:ue})])])]),_:1},8,["details"])])):w("",!0),m(fe,{visible:k.visible,"onUpdate:visible":E[0]||(E[0]=pe=>k.visible=pe),header:k.title,closable:k.closable,modal:k.modal,style:ze({width:v.value===b.Free?"50vw":"60vw"}),maximizable:v.value===b.FromOrder},{default:y(()=>[v.value===b.Free?(h(),C(Ft,{key:0,invoiceDetail:V,onSubmit:ce},null,8,["invoiceDetail"])):w("",!0),v.value===b.FromOrder?(h(),C(qt,{key:1,headerVisible:!0,details:ee.value,onSelected:de},{header:y(()=>[]),_:1},8,["details"])):w("",!0)]),_:1},8,["visible","header","closable","modal","style","maximizable"])],64)}}});export{li as default};
