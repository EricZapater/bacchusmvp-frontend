import{i as h}from"./item.service-d2d46a5c.js";import{c as b}from"./category.service-dced4e30.js";import{u as I,_ as C,r as m,o as D,c as x,a as t,b as s,w as r,F as U,d as c,t as g}from"./index-1b5a493a.js";const P={name:"item-list",setup(){return{confirm:I()}},data(){return{ret:null,items:[],categories:[],currentCategory:null,currentItem:{id:0,code:"",description:"",costPrice:0,salePrice:0,categoryId:0,forPurchase:!1,forManufacture:!1,forSale:!1,active:!1},currentIndex:-1,code:"",display:!1}},methods:{fetchData(){h.getAll().then(l=>{this.items=l.data,console.log(l.data)}).catch(l=>{console.log(l)}),b.getAll().then(l=>{console.log(this.categories),this.categories=l.data}).catch(l=>{console.log(l)})},formatCurrency(l){return l.toLocaleString("es-ES",{style:"currency",currency:"EUR"})},onRowSelect(l){this.currentItem=l.data,console.log(l.data)},openDialog(l){l!==0?(console.log("diferent de 0"),this.currentItem=this.items.find(({id:o})=>o===l),this.display=!0):(this.resetData(),this.fetchData(),this.display=!0)},closeDialog(){this.display=!1},save(){console.log(this.currentCategory),this.currentItem.id===0?h.create(this.currentItem).then(l=>{l.status===null&&this.$toast.add({severity:"error",summary:"Error Message",detail:"Error al crear el registre: ",life:3e3}),l.status===201&&(this.$toast.add({severity:"success",summary:"Succes Message",detail:"Registre creat",life:3e3}),this.fetchData())}):h.update(this.currentItem).then(l=>{l.status===null&&this.$toast.add({severity:"error",summary:"Error Message",detail:"Error a l'actualitzar el registre: ",life:3e3}),l.status===201&&this.$toast.add({severity:"success",summary:"Succes Message",detail:"Registre actualitzat",life:3e3})}),this.fetchData(),this.closeDialog()},drop(l){this.confirm.require({message:"Vols esborrar el registre seleccionat?"+this.currentItem.code,header:"Confirmation",icon:"pi pi-exclamation-triangle",accept:()=>{h.delete(l).then(o=>{o.status===202&&(this.$toast.add({severity:"success",summary:"Succes Message",detail:"Registre eliminat correctament",life:3e3}),this.fetchData())})},reject:()=>{},onHide:()=>{}})},resetData(){this.currentItem.id=0,this.currentItem.code="",this.currentItem.description="",this.currentItem.costPrice=0,this.currentItem.salePrice=0,this.currentItem.categoryId=0,this.currentItem.forPurchase=!1,this.currentItem.forManufacture=!1,this.currentItem.forSale=!1,this.currentItem.active=!1}},mounted(){this.fetchData()}},S={class:"grid p-fluid"},A=t("div",{class:"col-12 md:col-11"},null,-1),k={class:"col-12 md:col-1"},E={class:"row"},F={class:"grid p-fluid"},w={class:"col-12 md:col-4"},M={class:"p-inputgroup"},R=t("span",{class:"p-inputgroup-addon"}," Codi: ",-1),N={class:"col-12 md:col-8"},B={class:"p-inputgroup"},T=t("span",{class:"p-inputgroup-addon"}," Descripció: ",-1),L={class:"col-12 md:col-4"},z={class:"p-inputgroup"},j=t("span",{class:"p-inputgroup-addon"}," Categoria: ",-1),q={class:"col-12 md:col-4"},G={class:"p-inputgroup"},H=t("span",{class:"p-inputgroup-addon"}," Preu de cost: ",-1),K=t("span",{class:"p-inputgroup-addon"},"€",-1),J={class:"col-12 md:col-4"},O={class:"p-inputgroup"},Q=t("span",{class:"p-inputgroup-addon"}," Preu de venta: ",-1),W=t("span",{class:"p-inputgroup-addon"},"€",-1),X={class:"col-12 md:col-3"},Y={class:"p-inputgroup"},Z={class:"p-inputgroup-addon"},$={class:"col-12 md:col-3"},ee={class:"p-inputgroup"},te={class:"p-inputgroup-addon"},oe={class:"col-12 md:col-3"},se={class:"p-inputgroup"},le={class:"p-inputgroup-addon"},ae={class:"col-12 md:col-3"},re={class:"p-inputgroup"},ie={class:"p-inputgroup-addon"},ne=t("div",{class:"col-12 md:col-8"},null,-1),ce={class:"col-12 md:col-2"},de={class:"col-12 md:col-2"};function ue(l,o,me,pe,a,d){const p=m("Button"),n=m("Column"),f=m("InputText"),u=m("Checkbox"),v=m("DataTable"),y=m("Dropdown"),_=m("InputNumber"),V=m("Dialog");return D(),x(U,null,[t("div",S,[A,t("div",k,[s(p,{label:"Afegir",icon:"pi pi-add",class:"p-button-success",onClick:o[0]||(o[0]=e=>d.openDialog(0))})])]),t("div",E,[s(v,{value:a.items,selection:a.currentItem,"onUpdate:selection":o[1]||(o[1]=e=>a.currentItem=e),datakey:"id",stripedRows:"",responsiveLayout:"scroll",paginator:!0,showGridlines:"",rows:10,filterDisplay:"menu",globalFilterFields:["description"],onRowClick:d.onRowSelect},{empty:r(()=>[c(" No hi ha articles. ")]),loading:r(()=>[c(" Carregant articles, si us plau espereu. ")]),default:r(()=>[s(n,{field:"code",header:"Codi",sortable:!0}),s(n,{field:"description",header:"Descripció"},{filter:r(({filterModel:e})=>[s(f,{type:"text",modelValue:e.value,"onUpdate:modelValue":i=>e.value=i,class:"p-column-filter",placeholder:"Search by name"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),s(n,{field:"costprice",header:"Preu Cost",sortable:!0},{body:r(e=>[c(g(d.formatCurrency(e.data.costPrice)),1)]),_:1}),s(n,{field:"salePrice",header:"Preu Venta",sortable:!0},{body:r(e=>[c(g(d.formatCurrency(e.data.salePrice)),1)]),_:1}),s(n,{field:"categoryDescription",header:"Categoria",sortable:!0}),s(n,{field:"forPurchase",header:"Compra",sortable:!0},{body:r(e=>[s(u,{modelValue:e.data.forPurchase,"onUpdate:modelValue":i=>e.data.forPurchase=i,binary:!0,disabled:!0},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),s(n,{field:"forManufacture",header:"Producció",sortable:!0},{body:r(e=>[s(u,{modelValue:e.data.forManufacture,"onUpdate:modelValue":i=>e.data.forManufacture=i,binary:!0,disabled:!0},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),s(n,{field:"forSale",header:"Venta",sortable:!0},{body:r(e=>[s(u,{modelValue:e.data.forSale,"onUpdate:modelValue":i=>e.data.forSale=i,binary:!0,disabled:!0},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),s(n,{field:"active",header:"Actiu",sortable:!0},{body:r(e=>[s(u,{modelValue:e.data.active,"onUpdate:modelValue":i=>e.data.active=i,binary:!0,disabled:!0},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),s(n,{field:"id",header:""},{body:r(e=>[s(p,{label:"",icon:"pi pi-pencil",onClick:i=>d.openDialog(e.data.id)},null,8,["onClick"]),c("    "),s(p,{label:"",icon:"pi pi-trash",onClick:i=>d.drop(e.data.id)},null,8,["onClick"])]),_:1})]),_:1},8,["value","selection","onRowClick"])]),s(V,{header:"Article",visible:a.display,"onUpdate:visible":o[13]||(o[13]=e=>a.display=e)},{default:r(()=>[t("div",null,[t("div",F,[t("div",w,[t("div",M,[R,s(f,{placeholder:"Codi",modelValue:a.currentItem.code,"onUpdate:modelValue":o[2]||(o[2]=e=>a.currentItem.code=e)},null,8,["modelValue"])])]),t("div",N,[t("div",B,[T,s(f,{placeholder:"Descripció",modelValue:a.currentItem.description,"onUpdate:modelValue":o[3]||(o[3]=e=>a.currentItem.description=e)},null,8,["modelValue"])])]),t("div",L,[t("div",z,[j,s(y,{modelValue:a.currentItem.categoryId,"onUpdate:modelValue":o[4]||(o[4]=e=>a.currentItem.categoryId=e),options:a.categories,optionLabel:"description",optionValue:"id",dataKey:"id"},null,8,["modelValue","options"])])]),t("div",q,[t("div",G,[H,s(_,{placeholder:"Cost Price",mode:"decimal",minFractionDigits:2,maxFractionDigits:2,modelValue:a.currentItem.costPrice,"onUpdate:modelValue":o[5]||(o[5]=e=>a.currentItem.costPrice=e),currency:"EUR",locale:"es-ES"},null,8,["modelValue"]),K])]),t("div",J,[t("div",O,[Q,s(_,{placeholder:"Preu de venta",mode:"decimal",minFractionDigits:2,maxFractionDigits:2,modelValue:a.currentItem.salePrice,"onUpdate:modelValue":o[6]||(o[6]=e=>a.currentItem.salePrice=e),currency:"EUR",locale:"es-ES"},null,8,["modelValue"]),W])]),t("div",X,[t("div",Y,[t("span",Z,[s(u,{modelValue:a.currentItem.forPurchase,"onUpdate:modelValue":o[7]||(o[7]=e=>a.currentItem.forPurchase=e),binary:!0},null,8,["modelValue"]),c("   Es de compra ")])])]),t("div",$,[t("div",ee,[t("span",te,[s(u,{modelValue:a.currentItem.forSale,"onUpdate:modelValue":o[8]||(o[8]=e=>a.currentItem.forSale=e),binary:!0},null,8,["modelValue"]),c("   Es de venta ")])])]),t("div",oe,[t("div",se,[t("span",le,[s(u,{modelValue:a.currentItem.forManufacture,"onUpdate:modelValue":o[9]||(o[9]=e=>a.currentItem.forManufacture=e),binary:!0},null,8,["modelValue"]),c("   Es de producció ")])])]),t("div",ae,[t("div",re,[t("span",ie,[s(u,{modelValue:a.currentItem.active,"onUpdate:modelValue":o[10]||(o[10]=e=>a.currentItem.active=e),binary:!0},null,8,["modelValue"]),c("   Actiu ")])])]),ne,t("div",ce,[s(p,{label:"Acceptar",onClick:o[11]||(o[11]=e=>d.save())})]),t("div",de,[s(p,{label:"Cancelar",onClick:o[12]||(o[12]=e=>d.closeDialog())})])])])]),_:1},8,["visible"])],64)}const ge=C(P,[["render",ue]]);export{ge as default};
