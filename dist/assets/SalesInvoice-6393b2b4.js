import{O as Q,V as x,W as be,X as ve,h as I,Y as ye,a as f,c as g,G as B,S as ge,R as _,e as r,m as C,w as y,Z as te,$ as F,n as j,l as S,D as L,a0 as _e,a1 as ke,a2 as Y,a3 as G,a4 as P,a5 as xe,a6 as De,a7 as Ce,i as m,a8 as we,a9 as Pe,aa as Se,Q as z,d as O,j as J,r as A,k as w,o as ae,ab as Le,C as E,P as N,y as R,s as H,J as Ve,p as Te,b as Ee,f as Ae,I as Be,x as Fe,v as Oe,g as Ke,u as Re,z as ze,E as Z,ac as Ne}from"./index-75cc375f.js";import{u as Me}from"./invoice-7f731cbc.js";import{u as Ue}from"./customers-624e3938.js";import{u as M}from"./masterData-653c1c50.js";import{u as X}from"./lifecycle-d7be4408.js";import{f as W,b as qe,e as Ge}from"./functions-224f323d.js";import{c as le,a as ie,d as ne,F as He}from"./form-validator-c10fa122.js";import{l as Ze}from"./lodash-e1855bb1.js";import{s as je}from"./index-0caf257d.js";import{R as Ye}from"./constants-cc9165e4.js";import{S as se}from"./index-81cd819e.js";import"./base.service-c816a16d.js";import"./index-98390d1b.js";import"./v4-a960c1f4.js";import"./reference.service-d49c812d.js";import"./file.service-644f4363.js";var oe={name:"TieredMenuSub",extends:Q,emits:["item-click","item-mouseenter"],props:{menuId:{type:String,default:null},focusedItemId:{type:String,default:null},items:{type:Array,default:null},level:{type:Number,default:0},templates:{type:Object,default:null},activeItemPath:{type:Object,default:null},exact:{type:Boolean,default:!0}},methods:{getItemId(e){return`${this.menuId}_${e.key}`},getItemKey(e){return this.getItemId(e)},getItemProp(e,t,i){return e&&e.item?x.getItemValue(e.item[t],i):void 0},getItemLabel(e){return this.getItemProp(e,"label")},getPTOptions(e,t){return this.ptm(t,{context:{active:this.isItemActive(e),focused:this.isItemFocused(e)}})},isItemActive(e){return this.activeItemPath.some(t=>t.key===e.key)},isItemVisible(e){return this.getItemProp(e,"visible")!==!1},isItemDisabled(e){return this.getItemProp(e,"disabled")},isItemFocused(e){return this.focusedItemId===this.getItemId(e)},isItemGroup(e){return x.isNotEmpty(e.items)},onItemClick(e,t){this.getItemProp(t,"command",{originalEvent:e,item:t.item}),this.$emit("item-click",{originalEvent:e,processedItem:t,isFocus:!0})},onItemMouseEnter(e,t){this.$emit("item-mouseenter",{originalEvent:e,processedItem:t})},onItemActionClick(e,t){t&&t(e)},getAriaSetSize(){return this.items.filter(e=>this.isItemVisible(e)&&!this.getItemProp(e,"separator")).length},getAriaPosInset(e){return e-this.items.slice(0,e).filter(t=>this.isItemVisible(t)&&this.getItemProp(t,"separator")).length+1},getItemClass(e){return["p-menuitem",this.getItemProp(e,"class"),{"p-menuitem-active p-highlight":this.isItemActive(e),"p-focus":this.isItemFocused(e),"p-disabled":this.isItemDisabled(e)}]},getItemActionClass(e,t){return["p-menuitem-link",{"router-link-active":t&&t.isActive,"router-link-active-exact":this.exact&&t&&t.isExactActive}]},getItemIconClass(e){return["p-menuitem-icon",this.getItemProp(e,"icon")]},getSeparatorItemClass(e){return["p-menuitem-separator",this.getItemProp(e,"class")]}},components:{AngleRightIcon:be},directives:{ripple:ve}};const We=["id","aria-label","aria-disabled","aria-expanded","aria-haspopup","aria-level","aria-setsize","aria-posinset"],Qe=["onClick","onMouseenter"],Je=["href","onClick"],Xe=["href","target"],$e=["id"];function et(e,t,i,o,a,s){const u=I("router-link"),d=I("AngleRightIcon"),l=I("TieredMenuSub",!0),p=ye("ripple");return f(),g("ul",_e(ke(e.ptm("menu"))),[(f(!0),g(B,null,ge(i.items,(n,c)=>(f(),g(B,{key:s.getItemKey(n)},[s.isItemVisible(n)&&!s.getItemProp(n,"separator")?(f(),g("li",_({key:0,id:s.getItemId(n),style:s.getItemProp(n,"style"),class:s.getItemClass(n),role:"menuitem","aria-label":s.getItemLabel(n),"aria-disabled":s.isItemDisabled(n)||void 0,"aria-expanded":s.isItemGroup(n)?s.isItemActive(n):void 0,"aria-haspopup":s.isItemGroup(n)&&!s.getItemProp(n,"to")?"menu":void 0,"aria-level":i.level+1,"aria-setsize":s.getAriaSetSize(),"aria-posinset":s.getAriaPosInset(c)},s.getPTOptions(n,"menuitem")),[r("div",_({class:"p-menuitem-content",onClick:h=>s.onItemClick(h,n),onMouseenter:h=>s.onItemMouseEnter(h,n)},s.getPTOptions(n,"content")),[i.templates.item?(f(),C(F(i.templates.item),{key:1,item:n.item},null,8,["item"])):(f(),g(B,{key:0},[s.getItemProp(n,"to")&&!s.isItemDisabled(n)?(f(),C(u,{key:0,to:s.getItemProp(n,"to"),custom:""},{default:y(({navigate:h,href:b,isActive:v,isExactActive:D})=>[te((f(),g("a",_({href:b,class:s.getItemActionClass(n,{isActive:v,isExactActive:D}),tabindex:"-1","aria-hidden":"true",onClick:U=>s.onItemActionClick(U,h)},s.getPTOptions(n,"action")),[i.templates.itemicon?(f(),C(F(i.templates.itemicon),{key:0,item:n.item,class:j(s.getItemIconClass(n))},null,8,["item","class"])):s.getItemProp(n,"icon")?(f(),g("span",_({key:1,class:s.getItemIconClass(n)},s.getPTOptions(n,"icon")),null,16)):S("",!0),r("span",_({class:"p-menuitem-text"},s.getPTOptions(n,"label")),L(s.getItemLabel(n)),17)],16,Je)),[[p]])]),_:2},1032,["to"])):te((f(),g("a",_({key:1,href:s.getItemProp(n,"url"),class:s.getItemActionClass(n),target:s.getItemProp(n,"target"),tabindex:"-1","aria-hidden":"true"},s.getPTOptions(n,"action")),[i.templates.itemicon?(f(),C(F(i.templates.itemicon),{key:0,item:n.item,class:j(s.getItemIconClass(n))},null,8,["item","class"])):s.getItemProp(n,"icon")?(f(),g("span",_({key:1,class:s.getItemIconClass(n)},s.getPTOptions(n,"icon")),null,16)):S("",!0),r("span",_({class:"p-menuitem-text"},s.getPTOptions(n,"label")),L(s.getItemLabel(n)),17),s.getItemProp(n,"items")?(f(),g(B,{key:2},[i.templates.submenuicon?(f(),C(F(i.templates.submenuicon),_({key:0,class:"p-submenu-icon",active:s.isItemActive(n)},s.getPTOptions(n,"submenuIcon")),null,16,["active"])):(f(),C(d,_({key:1,class:"p-submenu-icon"},s.getPTOptions(n,"submenuIcon")),null,16))],64)):S("",!0)],16,Xe)),[[p]])],64))],16,Qe),s.isItemVisible(n)&&s.isItemGroup(n)?(f(),C(l,{key:0,id:s.getItemId(n)+"_list",role:"menu",class:"p-submenu-list",menuId:i.menuId,focusedItemId:i.focusedItemId,items:n.items,templates:i.templates,activeItemPath:i.activeItemPath,exact:i.exact,level:i.level+1,pt:e.pt,onItemClick:t[0]||(t[0]=h=>e.$emit("item-click",h)),onItemMouseenter:t[1]||(t[1]=h=>e.$emit("item-mouseenter",h))},null,8,["id","menuId","focusedItemId","items","templates","activeItemPath","exact","level","pt"])):S("",!0)],16,We)):S("",!0),s.isItemVisible(n)&&s.getItemProp(n,"separator")?(f(),g("li",_({key:1,id:s.getItemId(n),style:s.getItemProp(n,"style"),class:s.getSeparatorItemClass(n),role:"separator"},e.ptm("separator")),null,16,$e)):S("",!0)],64))),128))],16)}oe.render=et;var re={name:"TieredMenu",extends:Q,inheritAttrs:!1,emits:["focus","blur","before-show","before-hide","hide","show"],props:{popup:{type:Boolean,default:!1},model:{type:Array,default:null},appendTo:{type:String,default:"body"},autoZIndex:{type:Boolean,default:!0},baseZIndex:{type:Number,default:0},exact:{type:Boolean,default:!0},disabled:{type:Boolean,default:!1},tabindex:{type:Number,default:0},"aria-labelledby":{type:String,default:null},"aria-label":{type:String,default:null}},outsideClickListener:null,scrollHandler:null,resizeListener:null,target:null,container:null,menubar:null,searchTimeout:null,searchValue:null,data(){return{id:this.$attrs.id,focused:!1,focusedItemInfo:{index:-1,level:0,parentKey:""},activeItemPath:[],visible:!this.popup,dirty:!1}},watch:{"$attrs.id":function(e){this.id=e||Y()},activeItemPath(e){this.popup||(x.isNotEmpty(e)?(this.bindOutsideClickListener(),this.bindResizeListener()):(this.unbindOutsideClickListener(),this.unbindResizeListener()))}},mounted(){this.id=this.id||Y()},beforeUnmount(){this.unbindOutsideClickListener(),this.unbindResizeListener(),this.scrollHandler&&(this.scrollHandler.destroy(),this.scrollHandler=null),this.container&&this.autoZIndex&&G.clear(this.container),this.target=null,this.container=null},methods:{getItemProp(e,t){return e?x.getItemValue(e[t]):void 0},getItemLabel(e){return this.getItemProp(e,"label")},isItemDisabled(e){return this.getItemProp(e,"disabled")},isItemGroup(e){return x.isNotEmpty(this.getItemProp(e,"items"))},isItemSeparator(e){return this.getItemProp(e,"separator")},getProccessedItemLabel(e){return e?this.getItemLabel(e.item):void 0},isProccessedItemGroup(e){return e&&x.isNotEmpty(e.items)},toggle(e){this.visible?this.hide(e,!0):this.show(e)},show(e,t){this.popup&&(this.$emit("before-show"),this.visible=!0,this.target=this.target||e.currentTarget,this.relatedTarget=e.relatedTarget||null),this.focusedItemInfo={index:this.findFirstFocusedItemIndex(),level:0,parentKey:""},t&&P.focus(this.menubar)},hide(e,t){this.popup&&(this.$emit("before-hide"),this.visible=!1),this.activeItemPath=[],this.focusedItemInfo={index:-1,level:0,parentKey:""},t&&P.focus(this.relatedTarget||this.target||this.menubar),this.dirty=!1},onFocus(e){this.focused=!0,this.focusedItemInfo=this.focusedItemInfo.index!==-1?this.focusedItemInfo:{index:this.findFirstFocusedItemIndex(),level:0,parentKey:""},this.$emit("focus",e)},onBlur(e){this.focused=!1,this.focusedItemInfo={index:-1,level:0,parentKey:""},this.searchValue="",this.dirty=!1,this.$emit("blur",e)},onKeyDown(e){if(this.disabled){e.preventDefault();return}const t=e.metaKey||e.ctrlKey;switch(e.code){case"ArrowDown":this.onArrowDownKey(e);break;case"ArrowUp":this.onArrowUpKey(e);break;case"ArrowLeft":this.onArrowLeftKey(e);break;case"ArrowRight":this.onArrowRightKey(e);break;case"Home":this.onHomeKey(e);break;case"End":this.onEndKey(e);break;case"Space":this.onSpaceKey(e);break;case"Enter":this.onEnterKey(e);break;case"Escape":this.onEscapeKey(e);break;case"Tab":this.onTabKey(e);break;case"PageDown":case"PageUp":case"Backspace":case"ShiftLeft":case"ShiftRight":break;default:!t&&x.isPrintableCharacter(e.key)&&this.searchItems(e,e.key);break}},onItemChange(e){const{processedItem:t,isFocus:i}=e;if(x.isEmpty(t))return;const{index:o,key:a,level:s,parentKey:u,items:d}=t,l=x.isNotEmpty(d),p=this.activeItemPath.filter(n=>n.parentKey!==u&&n.parentKey!==a);l&&p.push(t),this.focusedItemInfo={index:o,level:s,parentKey:u},this.activeItemPath=p,l&&(this.dirty=!0),i&&P.focus(this.menubar)},onOverlayClick(e){xe.emit("overlay-click",{originalEvent:e,target:this.target})},onItemClick(e){const{originalEvent:t,processedItem:i}=e,o=this.isProccessedItemGroup(i),a=x.isEmpty(i.parent);if(this.isSelected(i)){const{index:u,key:d,level:l,parentKey:p}=i;this.activeItemPath=this.activeItemPath.filter(n=>d!==n.key&&d.startsWith(n.key)),this.focusedItemInfo={index:u,level:l,parentKey:p},this.dirty=!a,P.focus(this.menubar)}else if(o)this.onItemChange(e);else{const u=a?i:this.activeItemPath.find(d=>d.parentKey==="");this.hide(t),this.changeFocusedItemIndex(t,u?u.index:-1),P.focus(this.menubar)}},onItemMouseEnter(e){this.dirty&&this.onItemChange(e)},onArrowDownKey(e){const t=this.focusedItemInfo.index!==-1?this.findNextItemIndex(this.focusedItemInfo.index):this.findFirstFocusedItemIndex();this.changeFocusedItemIndex(e,t),e.preventDefault()},onArrowUpKey(e){if(e.altKey){if(this.focusedItemInfo.index!==-1){const t=this.visibleItems[this.focusedItemInfo.index];!this.isProccessedItemGroup(t)&&this.onItemChange({originalEvent:e,processedItem:t})}this.popup&&this.hide(e,!0),e.preventDefault()}else{const t=this.focusedItemInfo.index!==-1?this.findPrevItemIndex(this.focusedItemInfo.index):this.findLastFocusedItemIndex();this.changeFocusedItemIndex(e,t),e.preventDefault()}},onArrowLeftKey(e){const t=this.visibleItems[this.focusedItemInfo.index],i=this.activeItemPath.find(a=>a.key===t.parentKey);x.isEmpty(t.parent)||(this.focusedItemInfo={index:-1,parentKey:i?i.parentKey:""},this.searchValue="",this.onArrowDownKey(e)),this.activeItemPath=this.activeItemPath.filter(a=>a.parentKey!==this.focusedItemInfo.parentKey),e.preventDefault()},onArrowRightKey(e){const t=this.visibleItems[this.focusedItemInfo.index];this.isProccessedItemGroup(t)&&(this.onItemChange({originalEvent:e,processedItem:t}),this.focusedItemInfo={index:-1,parentKey:t.key},this.searchValue="",this.onArrowDownKey(e)),e.preventDefault()},onHomeKey(e){this.changeFocusedItemIndex(e,this.findFirstItemIndex()),e.preventDefault()},onEndKey(e){this.changeFocusedItemIndex(e,this.findLastItemIndex()),e.preventDefault()},onEnterKey(e){if(this.focusedItemInfo.index!==-1){const t=P.findSingle(this.menubar,`li[id="${`${this.focusedItemId}`}"]`),i=t&&P.findSingle(t,".p-menuitem-link");if(i?i.click():t&&t.click(),!this.popup){const o=this.visibleItems[this.focusedItemInfo.index];!this.isProccessedItemGroup(o)&&(this.focusedItemInfo.index=this.findFirstFocusedItemIndex())}}e.preventDefault()},onSpaceKey(e){this.onEnterKey(e)},onEscapeKey(e){this.hide(e,!0),!this.popup&&(this.focusedItemInfo.index=this.findFirstFocusedItemIndex()),e.preventDefault()},onTabKey(e){if(this.focusedItemInfo.index!==-1){const t=this.visibleItems[this.focusedItemInfo.index];!this.isProccessedItemGroup(t)&&this.onItemChange({originalEvent:e,processedItem:t})}this.hide()},onEnter(e){this.autoZIndex&&G.set("menu",e,this.baseZIndex+this.$primevue.config.zIndex.menu),this.alignOverlay(),P.focus(this.menubar),this.scrollInView()},onAfterEnter(){this.bindOutsideClickListener(),this.bindScrollListener(),this.bindResizeListener(),this.$emit("show")},onLeave(){this.unbindOutsideClickListener(),this.unbindScrollListener(),this.unbindResizeListener(),this.$emit("hide"),this.container=null,this.dirty=!1},onAfterLeave(e){this.autoZIndex&&G.clear(e)},alignOverlay(){this.container.style.minWidth=P.getOuterWidth(this.target)+"px",P.absolutePosition(this.container,this.target)},bindOutsideClickListener(){this.outsideClickListener||(this.outsideClickListener=e=>{const t=this.container&&!this.container.contains(e.target),i=this.popup?!(this.target&&(this.target===e.target||this.target.contains(e.target))):!0;t&&i&&this.hide()},document.addEventListener("click",this.outsideClickListener))},unbindOutsideClickListener(){this.outsideClickListener&&(document.removeEventListener("click",this.outsideClickListener),this.outsideClickListener=null)},bindScrollListener(){this.scrollHandler||(this.scrollHandler=new De(this.target,e=>{this.hide(e,!0)})),this.scrollHandler.bindScrollListener()},unbindScrollListener(){this.scrollHandler&&this.scrollHandler.unbindScrollListener()},bindResizeListener(){this.resizeListener||(this.resizeListener=e=>{P.isTouchDevice()||this.hide(e,!0)},window.addEventListener("resize",this.resizeListener))},unbindResizeListener(){this.resizeListener&&(window.removeEventListener("resize",this.resizeListener),this.resizeListener=null)},isItemMatched(e){return this.isValidItem(e)&&this.getProccessedItemLabel(e).toLocaleLowerCase().startsWith(this.searchValue.toLocaleLowerCase())},isValidItem(e){return!!e&&!this.isItemDisabled(e.item)&&!this.isItemSeparator(e.item)},isValidSelectedItem(e){return this.isValidItem(e)&&this.isSelected(e)},isSelected(e){return this.activeItemPath.some(t=>t.key===e.key)},findFirstItemIndex(){return this.visibleItems.findIndex(e=>this.isValidItem(e))},findLastItemIndex(){return x.findLastIndex(this.visibleItems,e=>this.isValidItem(e))},findNextItemIndex(e){const t=e<this.visibleItems.length-1?this.visibleItems.slice(e+1).findIndex(i=>this.isValidItem(i)):-1;return t>-1?t+e+1:e},findPrevItemIndex(e){const t=e>0?x.findLastIndex(this.visibleItems.slice(0,e),i=>this.isValidItem(i)):-1;return t>-1?t:e},findSelectedItemIndex(){return this.visibleItems.findIndex(e=>this.isValidSelectedItem(e))},findFirstFocusedItemIndex(){const e=this.findSelectedItemIndex();return e<0?this.findFirstItemIndex():e},findLastFocusedItemIndex(){const e=this.findSelectedItemIndex();return e<0?this.findLastItemIndex():e},searchItems(e,t){this.searchValue=(this.searchValue||"")+t;let i=-1,o=!1;return this.focusedItemInfo.index!==-1?(i=this.visibleItems.slice(this.focusedItemInfo.index).findIndex(a=>this.isItemMatched(a)),i=i===-1?this.visibleItems.slice(0,this.focusedItemInfo.index).findIndex(a=>this.isItemMatched(a)):i+this.focusedItemInfo.index):i=this.visibleItems.findIndex(a=>this.isItemMatched(a)),i!==-1&&(o=!0),i===-1&&this.focusedItemInfo.index===-1&&(i=this.findFirstFocusedItemIndex()),i!==-1&&this.changeFocusedItemIndex(e,i),this.searchTimeout&&clearTimeout(this.searchTimeout),this.searchTimeout=setTimeout(()=>{this.searchValue="",this.searchTimeout=null},500),o},changeFocusedItemIndex(e,t){this.focusedItemInfo.index!==t&&(this.focusedItemInfo.index=t,this.scrollInView())},scrollInView(e=-1){const t=e!==-1?`${this.id}_${e}`:this.focusedItemId,i=P.findSingle(this.menubar,`li[id="${t}"]`);i&&i.scrollIntoView&&i.scrollIntoView({block:"nearest",inline:"start"})},createProcessedItems(e,t=0,i={},o=""){const a=[];return e&&e.forEach((s,u)=>{const d=(o!==""?o+"_":"")+u,l={item:s,index:u,level:t,key:d,parent:i,parentKey:o};l.items=this.createProcessedItems(s.items,t+1,l,d),a.push(l)}),a},containerRef(e){this.container=e},menubarRef(e){this.menubar=e?e.$el:void 0}},computed:{containerClass(){return["p-tieredmenu p-component",{"p-tieredmenu-overlay":this.popup,"p-input-filled":this.$primevue.config.inputStyle==="filled","p-ripple-disabled":this.$primevue.config.ripple===!1}]},processedItems(){return this.createProcessedItems(this.model||[])},visibleItems(){const e=this.activeItemPath.find(t=>t.key===this.focusedItemInfo.parentKey);return e?e.items:this.processedItems},focusedItemId(){return this.focusedItemInfo.index!==-1?`${this.id}${x.isNotEmpty(this.focusedItemInfo.parentKey)?"_"+this.focusedItemInfo.parentKey:""}_${this.focusedItemInfo.index}`:null}},components:{TieredMenuSub:oe,Portal:Ce}};const tt=["id"];function it(e,t,i,o,a,s){const u=I("TieredMenuSub"),d=I("Portal");return f(),C(d,{appendTo:i.appendTo,disabled:!i.popup},{default:y(()=>[m(we,{name:"p-connected-overlay",onEnter:s.onEnter,onAfterEnter:s.onAfterEnter,onLeave:s.onLeave,onAfterLeave:s.onAfterLeave},{default:y(()=>[a.visible?(f(),g("div",_({key:0,ref:s.containerRef,id:a.id,class:s.containerClass,onClick:t[0]||(t[0]=(...l)=>s.onOverlayClick&&s.onOverlayClick(...l))},{...e.$attrs,...e.ptm("root")}),[m(u,{ref:s.menubarRef,id:a.id+"_list",class:"p-tieredmenu-root-list",tabindex:i.disabled?-1:i.tabindex,role:"menubar","aria-label":e.ariaLabel,"aria-labelledby":e.ariaLabelledby,"aria-disabled":i.disabled||void 0,"aria-orientation":"vertical","aria-activedescendant":a.focused?s.focusedItemId:void 0,menuId:a.id,focusedItemId:a.focused?s.focusedItemId:void 0,items:s.processedItems,templates:e.$slots,activeItemPath:a.activeItemPath,exact:i.exact,level:0,pt:e.pt,onFocus:s.onFocus,onBlur:s.onBlur,onKeydown:s.onKeyDown,onItemClick:s.onItemClick,onItemMouseenter:s.onItemMouseEnter},null,8,["id","tabindex","aria-label","aria-labelledby","aria-disabled","aria-activedescendant","menuId","focusedItemId","items","templates","activeItemPath","exact","pt","onFocus","onBlur","onKeydown","onItemClick","onItemMouseenter"])],16,tt)):S("",!0)]),_:1},8,["onEnter","onAfterEnter","onLeave","onAfterLeave"])]),_:1},8,["appendTo","disabled"])}function nt(e,t){t===void 0&&(t={});var i=t.insertAt;if(!(!e||typeof document>"u")){var o=document.head||document.getElementsByTagName("head")[0],a=document.createElement("style");a.type="text/css",i==="top"&&o.firstChild?o.insertBefore(a,o.firstChild):o.appendChild(a),a.styleSheet?a.styleSheet.cssText=e:a.appendChild(document.createTextNode(e))}}var st=`
.p-tieredmenu-overlay {
    position: absolute;
    top: 0;
    left: 0;
}
.p-tieredmenu ul {
    margin: 0;
    padding: 0;
    list-style: none;
}
.p-tieredmenu .p-submenu-list {
    position: absolute;
    min-width: 100%;
    z-index: 1;
    display: none;
}
.p-tieredmenu .p-menuitem-link {
    cursor: pointer;
    display: flex;
    align-items: center;
    text-decoration: none;
    overflow: hidden;
    position: relative;
}
.p-tieredmenu .p-menuitem-text {
    line-height: 1;
}
.p-tieredmenu .p-menuitem {
    position: relative;
}
.p-tieredmenu .p-menuitem-link .p-submenu-icon {
    margin-left: auto;
}
.p-tieredmenu .p-menuitem-active > .p-submenu-list {
    display: block;
    left: 100%;
    top: 0;
}
`;nt(st);re.render=it;var $={name:"SplitButton",extends:Q,emits:["click"],props:{label:{type:String,default:null},icon:{type:String,default:null},model:{type:Array,default:null},autoZIndex:{type:Boolean,default:!0},baseZIndex:{type:Number,default:0},appendTo:{type:String,default:"body"},disabled:{type:Boolean,default:!1},class:{type:null,default:null},style:{type:null,default:null},buttonProps:{type:null,default:null},menuButtonProps:{type:null,default:null},menuButtonIcon:{type:String,default:void 0},severity:{type:String,default:null},raised:{type:Boolean,default:!1},rounded:{type:Boolean,default:!1},text:{type:Boolean,default:!1},outlined:{type:Boolean,default:!1},size:{type:String,default:null},plain:{type:Boolean,default:!1}},data(){return{isExpanded:!1}},methods:{onDropdownButtonClick(){this.$refs.menu.toggle({currentTarget:this.$el,relatedTarget:this.$refs.button.$el}),this.isExpanded=!this.$refs.menu.visible},onDropdownKeydown(e){(e.code==="ArrowDown"||e.code==="ArrowUp")&&(this.onDropdownButtonClick(),e.preventDefault())},onDefaultButtonClick(e){this.isExpanded&&this.$refs.menu.hide(e),this.$emit("click",e)}},computed:{ariaId(){return Y()},containerClass(){return["p-splitbutton p-component",this.class,{[`p-button-${this.severity}`]:this.severity,"p-button-raised":this.raised,"p-button-rounded":this.rounded,"p-button-text":this.text,"p-button-outlined":this.outlined,"p-button-sm":this.size==="small","p-button-lg":this.size==="large"}]}},components:{PVSButton:Pe,PVSMenu:re,ChevronDownIcon:Se}};function at(e,t,i,o,a,s){const u=I("PVSButton"),d=I("PVSMenu");return f(),g("div",_({class:s.containerClass,style:i.style},e.ptm("root")),[z(e.$slots,"default",{},()=>[m(u,_({type:"button",class:"p-splitbutton-defaultbutton",label:i.label,disabled:i.disabled,"aria-label":i.label,onClick:s.onDefaultButtonClick,pt:e.ptm("button")},i.buttonProps),{icon:y(l=>[z(e.$slots,"icon",{},()=>[r("span",_({class:[i.icon,l.class]},e.ptm("button").icon),null,16)])]),_:3},16,["label","disabled","aria-label","onClick","pt"])]),m(u,_({ref:"button",type:"button",class:"p-splitbutton-menubutton",disabled:i.disabled,"aria-haspopup":"true","aria-expanded":a.isExpanded,"aria-controls":s.ariaId+"_overlay",onClick:s.onDropdownButtonClick,onKeydown:s.onDropdownKeydown,pt:e.ptm("menuButton")},i.menuButtonProps),{icon:y(l=>[z(e.$slots,"menubuttonicon",{},()=>[(f(),C(F(i.menuButtonIcon?"span":"ChevronDownIcon"),_({class:[i.menuButtonIcon,l.class]},e.ptm("menuButton").icon),null,16,["class"]))])]),_:3},16,["disabled","aria-expanded","aria-controls","onClick","onKeydown","pt"]),m(d,{ref:"menu",id:s.ariaId+"_overlay",model:i.model,popup:!0,autoZIndex:i.autoZIndex,baseZIndex:i.baseZIndex,appendTo:i.appendTo,pt:e.ptm("menu")},null,8,["id","model","autoZIndex","baseZIndex","appendTo","pt"])],16)}function lt(e,t){t===void 0&&(t={});var i=t.insertAt;if(!(!e||typeof document>"u")){var o=document.head||document.getElementsByTagName("head")[0],a=document.createElement("style");a.type="text/css",i==="top"&&o.firstChild?o.insertBefore(a,o.firstChild):o.appendChild(a),a.styleSheet?a.styleSheet.cssText=e:a.appendChild(document.createTextNode(e))}}var ot=`
.p-splitbutton[data-v-29147f7b] {
    display: inline-flex;
    position: relative;
}
.p-splitbutton .p-splitbutton-defaultbutton[data-v-29147f7b],
.p-splitbutton.p-button-rounded > .p-splitbutton-defaultbutton.p-button[data-v-29147f7b],
.p-splitbutton.p-button-outlined > .p-splitbutton-defaultbutton.p-button[data-v-29147f7b] {
    flex: 1 1 auto;
    border-top-right-radius: 0;
    border-bottom-right-radius: 0;
    border-right: 0 none;
}
.p-splitbutton-menubutton[data-v-29147f7b],
.p-splitbutton.p-button-rounded > .p-splitbutton-menubutton.p-button[data-v-29147f7b],
.p-splitbutton.p-button-outlined > .p-splitbutton-menubutton.p-button[data-v-29147f7b] {
    display: flex;
    align-items: center;
    justify-content: center;
    border-top-left-radius: 0;
    border-bottom-left-radius: 0;
}
.p-splitbutton .p-menu[data-v-29147f7b] {
    min-width: 100%;
}
.p-fluid .p-splitbutton[data-v-29147f7b] {
    display: flex;
}
`;lt(ot);$.render=at;$.__scopeId="data-v-29147f7b";const rt={key:0},dt={class:"four-columns"},ut={class:"mt-2"},ct={class:"mt-2"},mt=r("label",{class:"block text-900 mb-2"},"Data Factura",-1),ht={class:"mt-2"},ft=r("label",{class:"block text-900 mb-2"},"Estat",-1),pt={class:"mt-2"},It=r("label",{class:"block text-900 mb-2"},"Métode Pagament",-1),bt={class:"four-columns"},vt={class:"mt-1"},yt=r("label",{class:"block text-900 mb-2"},"Base",-1),gt={class:"summary-field"},_t={class:"mt-1"},kt=r("label",{class:"block text-900 mb-2"},"Impostos",-1),xt={class:"summary-field"},Dt={class:"mt-1"},Ct=r("label",{class:"block text-900 mb-2"},"Total",-1),wt={class:"summary-field"},Pt=O({__name:"FormSalesInvoice",props:{invoice:{}},emits:["submit","cancel"],setup(e,{emit:t}){J();const i=M(),o=X();return le().shape({invoiceDate:ie().required("La data és obligatoria"),paymentMethodId:ie().required("El métode de pagament és obligatori")}),A({result:!1,errors:{}}),(a,s)=>{var p;const u=I("BaseInput"),d=I("Calendar"),l=I("Dropdown");return a.invoice?(f(),g("form",rt,[r("header",null,[r("section",dt,[r("div",ut,[m(u,{modelValue:a.invoice.invoiceNumber,"onUpdate:modelValue":s[0]||(s[0]=n=>a.invoice.invoiceNumber=n),label:"Número",disabled:!0},null,8,["modelValue"])]),r("div",ct,[mt,m(d,{modelValue:a.invoice.invoiceDate,"onUpdate:modelValue":s[1]||(s[1]=n=>a.invoice.invoiceDate=n),dateFormat:"dd/mm/yy"},null,8,["modelValue"])]),r("div",ht,[ft,m(l,{modelValue:a.invoice.statusId,"onUpdate:modelValue":s[2]||(s[2]=n=>a.invoice.statusId=n),editable:"",options:(p=w(o).lifecycle)==null?void 0:p.statuses,optionValue:"id",optionLabel:"name",class:"w-full"},null,8,["modelValue","options"])]),r("div",pt,[It,m(l,{modelValue:a.invoice.paymentMethodId,"onUpdate:modelValue":s[3]||(s[3]=n=>a.invoice.paymentMethodId=n),editable:"",options:w(i).paymentMethods,optionValue:"id",optionLabel:"name",class:"w-full"},null,8,["modelValue","options"])])]),r("section",bt,[r("div",vt,[yt,r("span",gt,L(a.invoice.baseAmount)+" €",1)]),r("div",_t,[kt,r("span",xt,L(a.invoice.taxAmount)+" €",1)]),r("div",Dt,[Ct,r("span",wt,L(a.invoice.netAmount)+" €",1)])])])])):S("",!0)}}}),St=["onClick"],Lt=O({__name:"TableInvoiceDetails",props:{details:{},headerVisible:{type:Boolean}},emits:["edit","delete"],setup(e,{emit:t}){const i=X(),o=M();ae(async()=>{await i.fetchOneByName("SalesInvoice")});const a=u=>{var l;const d=(l=o.taxes)==null?void 0:l.find(p=>p.id===u);if(d)return`${d.percentatge} %`},s=(u,d)=>{t("delete",d)};return(u,d)=>{const l=I("Column"),p=I("DataTable");return f(),C(p,{class:"small-datatable",tableStyle:"min-width: 100%",scrollable:"",scrollHeight:"55vh",sortMode:"multiple",value:u.details},Le({default:y(()=>[m(l,{header:"Quantitat",field:"quantity",style:{width:"10%"}}),m(l,{header:"Descripció",field:"description",style:{width:"40%"}}),m(l,{header:"Preu unitat",field:"unitCost",style:{width:"10%"}},{body:y(n=>[E(L(n.data.unitCost)+" € ",1)]),_:1}),m(l,{header:"IVA",style:{width:"10%"}},{body:y(n=>[E(L(a(n.data.taxId)),1)]),_:1}),m(l,{header:"Total",field:"totalCost",style:{width:"10%"}},{body:y(n=>[E(L(n.data.amount)+" € ",1)]),_:1}),m(l,{style:{width:"10%"}},{body:y(n=>[r("i",{class:j([w(N).TIMES,"grid_delete_column_button"]),onClick:c=>s(c,n.data)},null,10,St)]),_:1})]),_:2},[u.headerVisible?{name:"header",fn:y(()=>[z(u.$slots,"header")]),key:"0"}:void 0]),1032,["value"])}}}),Vt={key:0},Tt={class:"two-columns-7525"},Et={class:"mt-2"},At={class:"mt-2"},Bt=r("label",{class:"block text-900 mb-2"},"Impost",-1),Ft={class:"three-columns"},Ot={class:"mt-2"},Kt={class:"mt-2"},Rt={class:"mt-2"},zt=O({__name:"FormSalesInvoiceDetail",props:{invoiceDetail:{}},emits:["submit","cancel"],setup(e,{emit:t}){const i=e,o=J(),a=M(),s=()=>{const n=i.invoiceDetail;n.quantity&&n.quantity>0&&n.unitPrice&&n.unitPrice>0&&(i.invoiceDetail.unitCost=n.unitPrice,i.invoiceDetail.amount=Ze.round(n.quantity*n.unitPrice,2),i.invoiceDetail.totalCost=i.invoiceDetail.amount)},u=le().shape({quantity:ne().min(1).required("La quantitat ha de ser superior a 1"),unitPrice:ne().min(.01).required("El preu unitat és obligatori")}),d=A({result:!1,errors:{}}),l=()=>{const n=new He(u);d.value=n.validate(i.invoiceDetail)},p=async()=>{if(l(),d.value.result)t("submit",i.invoiceDetail);else{let n="";Object.entries(d.value.errors).forEach(c=>{n+=`${c[1].map(h=>h)}.   `}),o.add({severity:"warn",summary:"Formulari inválid",detail:n,life:5e3})}};return(n,c)=>{const h=I("Dropdown"),b=I("Button");return n.invoiceDetail?(f(),g("form",Vt,[r("section",Tt,[r("div",Et,[m(R,{label:"Descripció",modelValue:n.invoiceDetail.description,"onUpdate:modelValue":c[0]||(c[0]=v=>n.invoiceDetail.description=v)},null,8,["modelValue"])]),r("div",At,[Bt,m(h,{modelValue:n.invoiceDetail.taxId,"onUpdate:modelValue":c[1]||(c[1]=v=>n.invoiceDetail.taxId=v),editable:"",options:w(a).taxes,optionValue:"id",optionLabel:"name",class:"w-full"},null,8,["modelValue","options"])])]),r("section",Ft,[r("div",Ot,[m(R,{type:w(H).NUMERIC,label:"Quantitat",modelValue:n.invoiceDetail.quantity,"onUpdate:modelValue":[c[2]||(c[2]=v=>n.invoiceDetail.quantity=v),s]},null,8,["type","modelValue"])]),r("div",Kt,[m(R,{type:w(H).CURRENCY,label:"Preu Unitat","model-value":n.invoiceDetail.unitPrice,"onUpdate:modelValue":[c[3]||(c[3]=v=>n.invoiceDetail.unitPrice=v),s]},null,8,["type","model-value"])]),r("div",Rt,[m(R,{type:w(H).CURRENCY,label:"Total","model-value":n.invoiceDetail.amount,"onUpdate:modelValue":c[4]||(c[4]=v=>n.invoiceDetail.amount=v),disabled:""},null,8,["type","model-value"])])]),m(b,{label:"Crear",onClick:p,style:{float:"right"},size:"small",class:"mt-2"})])):S("",!0)}}}),Nt=e=>(Te("data-v-f38440b9"),e=e(),Ee(),e),Mt={class:"selector-filter"},Ut={class:"selector-filter-field"},qt=Nt(()=>r("label",{for:""},"Comanda",-1)),Gt={class:"selector-filter-button"},Ht={class:"flex align-items-center gap-2"},Zt=O({__name:"SelectorOrderDetails",props:{details:{},headerVisible:{type:Boolean}},emits:["selected"],setup(e,{emit:t}){const i=e,o=A([]),a=A(""),s=Ve(()=>{var d;return a.value.length===0?i.details:(d=i.details)==null?void 0:d.filter(l=>l.salesOrderNumber.toString().includes(a.value))}),u=()=>{if(o.value.length===0)return;const d=o.value.map(l=>({salesOrderHeaderId:l.salesOrderId,description:l.description,isInvoiced:!0,isServed:l.isServed,quantity:l.quantity,referenceId:l.referenceId,id:l.id,unitCost:l.unitCost,unitPrice:l.unitPrice,totalCost:l.totalCost,amount:l.amount}));t("selected",d)};return(d,l)=>{const p=I("InputText"),n=I("Button"),c=I("Column"),h=I("DataTable");return f(),C(h,{class:"small-datatable",tableStyle:"min-width: 100%",scrollable:"",scrollHeight:"70vh",value:s.value,selectionMode:"multiple",selection:o.value,"onUpdate:selection":l[1]||(l[1]=b=>o.value=b),"meta-key-selection":!1,rowGroupMode:"subheader",groupRowsBy:"salesOrderNumber",sortMode:"single",sortField:"salesOrderNumber"},{header:y(()=>[r("header",Mt,[r("div",Ut,[qt,E("   "),m(p,{style:{width:"150px",height:"35px"},modelValue:a.value,"onUpdate:modelValue":l[0]||(l[0]=b=>a.value=b),size:"small"},null,8,["modelValue"])]),r("div",Gt,[m(n,{onClick:u,size:"small",icon:w(N).CHECK_SQUARE},null,8,["icon"])])])]),groupheader:y(b=>[r("div",Ht,[r("b",null,"Comanda "+L(b.data.salesOrderNumber)+" - "+L(w(W)(b.data.salesOrderDate)),1)])]),default:y(()=>[m(c,{header:"Quantitat",field:"quantity",style:{width:"10%"}}),m(c,{header:"Descripció",field:"description",style:{width:"50%"}}),m(c,{header:"Preu",field:"amount",style:{width:"10%"}},{body:y(b=>[E(L(b.data.amount)+" € ",1)]),_:1})]),_:1},8,["value","selection"])}}});const jt=Ae(Zt,[["__scopeId","data-v-f38440b9"]]),Yt=Be({id:"reports",state:()=>({reports:void 0}),getters:{getReportByName:e=>t=>{if(e.reports)return e.reports.find(i=>i.originalName.includes(t))}},actions:{async fetchAll(){this.reports=await se.File.GetEntityFiles("Reports",Ye)},async generateAndDownload(e,t,i){const o=await se.File.DownloadReport(e,t);o&&qe(i,o)}}}),Wt={key:0},Qt={class:"flex flex-wrap align-items-center justify-content-between gap-2"},Jt=r("span",{class:"text-xl text-900 font-bold"},"Detall de la factura",-1),fi=O({__name:"SalesInvoice",setup(e){const t=[{label:"Generar factura",icon:N.FILE_PDF,command:()=>de()}],i=J(),o=Fe(),a=Oe(),s=Ke(),u=Re(),d=M(),l=Yt(),p=Ue(),n=X(),c=Me(),{invoice:h}=ze(c),b={Free:0,FromOrder:1},v=A(0),D=Z({visible:!1,title:"",closable:!0,position:"center",modal:!0});ae(async()=>{d.fetchMasterData(),p.fetchCustomers(),n.fetchOneByName("SalesInvoice"),l.fetchAll(),await c.GetById(a.params.id),c.invoice.invoiceDate=W(c.invoice.invoiceDate),u.setMenuItem({icon:N.WALLET,title:`Factura de venta ${h.value.invoiceNumber} - ${h.value.customerComercialName}`,backButtonVisible:!0})});const U=async()=>{h.value.invoiceDate=Ge(h.value.invoiceDate),await c.Update(h.value)&&(i.add({summary:"Factura de venta",detail:"Actualizada correctament",life:5e3}),s.back())},de=()=>{var V;const k=l.getReportByName("SalesInvoice");k&&l.generateAndDownload(k,[{key:"InvoiceId",value:h.value.id}],`Temges_Factura_${(V=h.value)==null?void 0:V.invoiceNumber}.pdf`)},ee=A([]),q=Z({}),ue=async()=>{h.value&&(ee.value=await je.SalesInvoice.GetInvoiceableOrderDetails(h.value.customerId),q.invoiceId=h.value.id,v.value=b.FromOrder,D.title="Selecció de linees de comanda",D.visible=!0)},ce=async k=>{q.orderDetails=k,await c.CreateInvoiceDetailsFromOrderDetails(q)&&await c.GetById(a.params.id),D.visible=!1},T=Z({}),me=()=>{var k;if(v.value=b.Free,h.value){T.salesInvoiceId=h.value.id,T.quantity=1,T.description="",T.totalCost=0;const V=(k=d.taxes)==null?void 0:k.find(K=>K.name.includes("0"));V&&(T.taxId=V.id),D.title="Introducció de línea lliure",D.visible=!0}},he=async()=>{const k=await c.CreateInvoiceDetail(T);D.visible=!1,console.log("createInvoiceDetail",k)},fe=async k=>{o.require({message:`Està segur que vol eliminar la línea ${k.description}?`,icon:"pi pi-question-circle",acceptIcon:"pi pi-check",rejectIcon:"pi pi-times",accept:async()=>{await c.DeleteInvoiceDetail(k),c.invoice.invoiceDate=W(c.invoice.invoiceDate)}})};return(k,V)=>{const K=I("Button"),pe=I("Dialog");return f(),g(B,null,[m(w($),{label:"Guardar",onClick:U,model:t,size:"small",class:"grid_add_row_button"}),w(h)?(f(),g("main",Wt,[m(Pt,{class:"mt-3 mr-3",invoice:w(h)},null,8,["invoice"]),m(Lt,{class:"mt-3","header-visible":!0,details:w(h).salesInvoiceDetails,onDelete:fe},{header:y(()=>[r("div",Qt,[Jt,r("div",null,[m(K,{size:"small",label:"Afegir de comanda",onClick:ue}),E("    "),m(K,{size:"small",label:"Crear linia lliure",onClick:me})])])]),_:1},8,["details"])])):S("",!0),m(pe,{visible:D.visible,"onUpdate:visible":V[0]||(V[0]=Ie=>D.visible=Ie),header:D.title,closable:D.closable,modal:D.modal,style:Ne({width:v.value===b.Free?"50vw":"60vw"}),maximizable:v.value===b.FromOrder},{default:y(()=>[v.value===b.Free?(f(),C(zt,{key:0,invoiceDetail:T,onSubmit:he},null,8,["invoiceDetail"])):S("",!0),v.value===b.FromOrder?(f(),C(jt,{key:1,headerVisible:!0,details:ee.value,onSelected:ce},{header:y(()=>[]),_:1},8,["details"])):S("",!0)]),_:1},8,["visible","header","closable","modal","style","maximizable"])],64)}}});export{fi as default};
