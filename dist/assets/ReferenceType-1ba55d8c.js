import{d as k,j as w,r as M,h as b,c as B,e as s,i,n as u,y as T,l as _,a as R,F as d,v as P,u as h,z as F,o as I,k as V,m as N,P as U,I as g}from"./index-42358d85.js";import{c as D,a as C,F as S}from"./form-validator-fe04ca9d.js";import{u as $}from"./referenceType-46683c00.js";import"./index-162c6393.js";import"./base.service-ed93fa00.js";const z={key:0},A={class:"three-columns"},L=s("label",{class:"block text-900 mb-2"},"Desactivat",-1),j={class:"three-columns"},q=s("label",{class:"block text-900 mb-2"},"Color Primari",-1),G=s("label",{class:"block text-900 mb-2"},"Color Secundari",-1),O={class:"mt-2"},H=k({__name:"FormReferenceType",props:{referenceType:{}},emits:["submit","cancel"],setup(v,{emit:c}){const m=v,p=w(),t=D().shape({name:C().required("El nom és obligatori").max(250,"El nom no pot superar els 250 carácters"),description:C().required("La descripció és obligatori").max(250,"La descripció pot superar els 250 carácters")}),r=M({result:!1,errors:{}}),f=()=>{const a=new S(t);r.value=a.validate(m.referenceType)},y=async()=>{if(f(),r.value.result)c("submit",m.referenceType);else{let a="";Object.entries(r.value.errors).forEach(e=>{a+=`${e[1].map(l=>l)}.   `}),p.add({severity:"warn",summary:"Formulari inválid",detail:a,life:5e3})}};return(a,e)=>{const l=b("Checkbox"),n=b("ColorPicker"),E=b("Button");return a.referenceType?(R(),B("form",z,[s("section",A,[i(T,{class:u(["mb-2",{"p-invalid":r.value.errors.name}]),label:"Nom",id:"name",modelValue:a.referenceType.name,"onUpdate:modelValue":e[0]||(e[0]=o=>a.referenceType.name=o)},null,8,["modelValue","class"]),i(T,{class:u(["mb-2",{"p-invalid":r.value.errors.description}]),label:"Descripció",id:"description",modelValue:a.referenceType.description,"onUpdate:modelValue":e[1]||(e[1]=o=>a.referenceType.description=o)},null,8,["modelValue","class"]),s("div",null,[L,i(l,{modelValue:a.referenceType.disabled,"onUpdate:modelValue":e[2]||(e[2]=o=>a.referenceType.disabled=o),class:"w-full",binary:!0},null,8,["modelValue"])])]),s("section",j,[s("div",null,[q,i(n,{modelValue:a.referenceType.primaryColor,"onUpdate:modelValue":e[3]||(e[3]=o=>a.referenceType.primaryColor=o),class:u(["mb-2",{"p-invalid":r.value.errors.color}]),label:"Color",id:"color"},null,8,["modelValue","class"])]),s("div",null,[G,i(n,{modelValue:a.referenceType.secondaryColor,"onUpdate:modelValue":e[4]||(e[4]=o=>a.referenceType.secondaryColor=o),class:u(["mb-2",{"p-invalid":r.value.errors.color}]),label:"Color",id:"color"},null,8,["modelValue","class"])])]),s("div",O,[i(E,{label:"Guardar",class:"mr-2",onClick:y})])])):_("",!0)}}}),Y=k({__name:"ReferenceType",setup(v){const c=M(d.EDIT),m=P(),p=h(),t=$(),{referenceType:r}=F(t),f=async()=>{await t.fetchRawMaterialType(m.params.id);let e="";r.value?(c.value=d.EDIT,e=`Magatzem ${r.value.name}`):(c.value=d.CREATE,t.setNewRawMaterialType(m.params.id),e="Alta de tipus de matèria prima"),p.setMenuItem({icon:U.BUILDING,backButtonVisible:!0,title:e})};I(async()=>{await f()});const y=w(),a=async()=>{const e=r.value;let l=!1,n="";c.value===d.CREATE?(l=await t.createRawMaterialType(e),n="MMPP creada correctament"):(l=await t.updateRawMaterialType(e.id,e),n="MMPP actualizada correctament"),l&&(y.add({severity:"success",summary:n,life:5e3}),g.back())};return(e,l)=>V(r)?(R(),N(H,{key:0,"reference-type":V(r),onSubmit:a},null,8,["reference-type"])):_("",!0)}});export{Y as default};
