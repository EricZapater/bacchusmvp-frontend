import{b as M}from"./vue-router-b024814c.js";import{j as S,ax as x,M as w,k as P,f as h,l as o,c as g,e as a,h as l,n as p,d as k,o as A,u as L,a as T,P as D}from"./index-2bfc80b2.js";import{u as y}from"./usetoast.esm-82b2df9e.js";import{F as _}from"./component-c8ee66ae.js";import"./router-059ec17d.js";import{B as m}from"./BaseInput-ac691025.js";import{u as $}from"./paymentMethod-f7b30784.js";import{u as R}from"./exercise-add99abf.js";import{u as j}from"./suppliers-48d539e5.js";import{u as B}from"./invoices-7f9e766d.js";import{c as z,a as O,F as q}from"./form-validator-1a569dfe.js";import"./runtime-dom.esm-bundler-0884c737.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./base.service-8b4a1a4e.js";const G={key:0},Y={class:"four-columns"},H=a("label",{class:"block text-900 mb-2"},"Exercici",-1),J=a("label",{class:"block text-900 mb-1"},"Sèrie",-1),K=a("label",{class:"block text-900 mb-1"},"Estat",-1),Q={class:"three-columns"},W=a("label",{class:"block text-900 mb-1"},"Proveïdor",-1),X=a("div",null,[a("label",{class:"block text-900 mb-2"},"Comptabilitzada")],-1),Z={class:"four-columns"},ee=a("div",null,[a("label",{class:"block text-900 mb-1"},"IVA")],-1),oe={class:"mt-2"},se=S({__name:"FormPurchaseInvoice",props:{purchaseInvoice:{}},emits:["submit","cancel"],setup(f,{emit:b}){const v=f,u=R(),r=B(),d=j(),V=$(),{purchaseInvoice:e}=x(r),I=y();w(async()=>{await u.fetchAll(),await V.fetchAll(),await d.fetchSuppliers(),await r.fetchPurchaseInvoiceSeries(),await r.fetchPurchaseInvoiceStatuses()});const n=P({result:!1,errors:{}}),N=z().shape({supplierId:O().required("El proveïdor es obligatori")}),E=()=>{const c=new q(N);n.value=c.validate(v.purchaseInvoice)},F=async()=>{if(E(),n.value.result)b("submit",e.value);else{let c="";Object.entries(n.value.errors).forEach(s=>{c+=`${s[1].map(i=>i)}.   `}),I.add({severity:"warn",summary:"Formulari inválid",detail:c,life:5e3})}},U=()=>{console.log(e)};return(c,s)=>{const i=h("Dropdown"),C=h("Button");return o(e)?(A(),g("form",G,[a("section",Y,[a("div",null,[H,l(i,{modelValue:o(e).exerciseId,"onUpdate:modelValue":s[0]||(s[0]=t=>o(e).exerciseId=t),editable:"",options:o(u).exercises,optionValue:"id",optionLabel:"name",class:p(["w-full",{"p-invalid":n.value.errors.exercise}])},null,8,["modelValue","options","class"])]),a("div",null,[J,l(i,{modelValue:o(e).purchaseInvoiceSerieId,"onUpdate:modelValue":s[1]||(s[1]=t=>o(e).purchaseInvoiceSerieId=t),editable:"",options:o(r).purchaseInvoiceSeries,optionValue:"id",optionLabel:"name",class:p(["w-full",{"p-invalid":n.value.errors.purchaseinvoiceserie}])},null,8,["modelValue","options","class"])]),l(m,{label:"Num. Fra. Intern",id:"number",modelValue:o(e).number,"onUpdate:modelValue":s[2]||(s[2]=t=>o(e).number=t),disabled:""},null,8,["modelValue"]),a("div",null,[K,l(i,{modelValue:o(e).purchaseInvoiceStatusId,"onUpdate:modelValue":s[3]||(s[3]=t=>o(e).purchaseInvoiceStatusId=t),editable:"",options:o(r).purchaseInvoiceStatuses,optionValue:"id",optionLabel:"name",class:p(["w-full",{"p-invalid":n.value.errors.purchaseinvoicestatus}])},null,8,["modelValue","options","class"])])]),a("section",Q,[a("div",null,[W,l(i,{modelValue:o(e).supplierId,"onUpdate:modelValue":s[4]||(s[4]=t=>o(e).supplierId=t),editable:"",options:o(d).suppliers,optionValue:"id",optionLabel:"comercialName",class:p(["w-full",{"p-invalid":n.value.errors.supplierId}]),onChange:U},null,8,["modelValue","options","class"])]),l(m,{label:"Num. Fra. Proveïdor",id:"supplierNumber",modelValue:o(e).supplierNumber,"onUpdate:modelValue":s[5]||(s[5]=t=>o(e).supplierNumber=t)},null,8,["modelValue"]),X]),a("section",Z,[l(m,{label:"Base",id:"baseAmount",modelValue:o(e).baseAmount,"onUpdate:modelValue":s[6]||(s[6]=t=>o(e).baseAmount=t)},null,8,["modelValue"]),l(m,{label:"Ports",id:"transportAmount",modelValue:o(e).transportAmount,"onUpdate:modelValue":s[7]||(s[7]=t=>o(e).transportAmount=t)},null,8,["modelValue"]),ee,l(m,{label:"Dto.",id:"discountPercentage",modelValue:o(e).discountPercentage,"onUpdate:modelValue":s[8]||(s[8]=t=>o(e).discountPercentage=t)},null,8,["modelValue"])]),a("div",oe,[l(C,{label:"Guardar",class:"mr-2",onClick:F})])])):k("",!0)}}}),fe=S({__name:"PurchaseInvoice",setup(f){const b=P(_.EDIT);M();const v=L(),u=B(),{purchaseInvoice:r}=x(u),d=async()=>{let e="";b.value=_.CREATE,u.setNewPurchaseInvoice(),e="Alta de factura de compra",v.setMenuItem({icon:D.MONEY_BILL,backButtonVisible:!0,text:e})};w(async()=>{await d()}),y();const V=async()=>{r.value};return(e,I)=>o(r)?(A(),T(se,{key:0,purchaseInvoice:o(r),onSubmit:V},null,8,["purchaseInvoice"])):k("",!0)}});export{fe as default};
