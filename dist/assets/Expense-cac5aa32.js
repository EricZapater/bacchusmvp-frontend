import{d as w,o as g,z as C,r as T,j as I,h as m,k as a,c as R,e as t,i as r,n as p,y as E,l as h,a as B,s as M,F as y,v as S,u as q,m as N,P as $,J as z}from"./index-ed8fb5bb.js";import{u as U}from"./expense-f51402a5.js";import{c as P,a as D,F as j}from"./form-validator-95718e4a.js";import"./index-2188bf6e.js";import"./base.service-1efb2a9b.js";const G={key:0},J={class:"four-columns"},O={class:"mt-2"},W=t("label",{class:"block text-900 mb-2"},"Tipus",-1),Y={class:"mt-2"},H=t("label",{class:"block text-900 mb-2"},"Data Alta",-1),K={class:"mt-2"},Q=t("label",{class:"block text-900 mb-2"},"Data Pagament",-1),X={class:"mt-2"},Z={class:"four-columns"},ee={class:"mt-2"},ae=t("label",{class:"block text-900 mb-2"},"Recurrent",-1),se={class:"mt-2"},te=t("label",{class:"block text-900 mb-2"},"Freqüència",-1),oe={class:"mt-2"},le={class:"mt-2"},ne=t("label",{class:"block text-900 mb-2"},"Data fi",-1),ie=t("label",{class:"block text-900 mb-2"},"Descripció",-1),re={class:"mt-2"},de=w({__name:"FormExpense",props:{expense:{}},emits:["submit","cancel"],setup(k,{emit:c}){const b=k;g(()=>{});const v=U(),{expense:e}=C(v),l=T([{id:1,name:"Mensual"},{id:2,name:"Bimensual"},{id:3,name:"Trimestral"},{id:6,name:"Semestral"},{id:12,name:"Anual"}]),V=P().shape({expenseTypeId:D().required("El tipus de despesa es obligatoria"),creationDate:D().required("La data de creació es obligatoria"),paymentDate:D().required("La data de pagament es obligatoria"),amount:D().required("L'import es obligatori")}),n=T({result:!1,errors:{}}),x=()=>{const d=new j(V);n.value=d.validate(b.expense)},i=I(),u=async()=>{if(x(),n.value.result)c("submit",e.value);else{let d="";Object.entries(n.value.errors).forEach(s=>{d+=`${s[1].map(_=>_)}.   `}),i.add({severity:"warn",summary:"Formulari inválid",detail:d,life:5e3})}};return(d,s)=>{const _=m("Dropdown"),f=m("Calendar"),F=m("Checkbox"),A=m("Textarea"),L=m("Button");return a(e)?(B(),R("form",G,[t("section",J,[t("div",O,[W,r(_,{modelValue:a(e).expenseTypeId,"onUpdate:modelValue":s[0]||(s[0]=o=>a(e).expenseTypeId=o),editable:"",options:a(v).expenseTypes,optionValue:"id",optionLabel:"name",class:p(["w-full",{"p-invalid":n.value.errors.expenseTypeId}])},null,8,["modelValue","options","class"])]),t("div",Y,[H,r(f,{id:"creationDate",modelValue:a(e).creationDate,"onUpdate:modelValue":s[1]||(s[1]=o=>a(e).creationDate=o),class:p({"p-invalid":n.value.errors.creationDate})},null,8,["modelValue","class"])]),t("div",K,[Q,r(f,{id:"paymentDate",modelValue:a(e).paymentDate,"onUpdate:modelValue":s[2]||(s[2]=o=>a(e).paymentDate=o),class:p({"p-invalid":n.value.errors.paymentDate})},null,8,["modelValue","class"])]),t("div",X,[r(E,{label:"Import",id:"amount",modelValue:a(e).amount,"onUpdate:modelValue":s[3]||(s[3]=o=>a(e).amount=o),type:a(M).CURRENCY,class:p({"p-invalid":n.value.errors.amount})},null,8,["modelValue","type","class"])])]),t("section",Z,[t("div",ee,[ae,r(F,{modelValue:a(e).recurring,"onUpdate:modelValue":s[4]||(s[4]=o=>a(e).recurring=o),class:"w-full",binary:!0},null,8,["modelValue"])]),t("div",se,[te,r(_,{modelValue:a(e).frecuency,"onUpdate:modelValue":s[5]||(s[5]=o=>a(e).frecuency=o),disabled:!a(e).recurring,editable:"",options:l.value,optionValue:"id",optionLabel:"name",class:p(["w-full",{"p-invalid":n.value.errors.expenseTypeId}])},null,8,["modelValue","disabled","options","class"])]),t("div",oe,[r(E,{label:"Dia de pagament",id:"paymentDay",modelValue:a(e).paymentDay,"onUpdate:modelValue":s[6]||(s[6]=o=>a(e).paymentDay=o),disabled:!a(e).recurring},null,8,["modelValue","disabled"])]),t("div",le,[ne,r(f,{id:"endDate",modelValue:a(e).endDate,"onUpdate:modelValue":s[7]||(s[7]=o=>a(e).endDate=o),disabled:!a(e).recurring},null,8,["modelValue","disabled"])])]),t("div",null,[ie,r(A,{modelValue:a(e).description,"onUpdate:modelValue":s[8]||(s[8]=o=>a(e).description=o),class:"w-full"},null,8,["modelValue"])]),t("div",re,[r(L,{label:"Guardar",class:"mr-2",onClick:u})])])):h("",!0)}}}),ve=w({__name:"Expense",setup(k){const c=T(y.EDIT),b=S(),v=q(),e=U(),{expense:l}=C(e),V=async()=>{await e.fetchExpense(b.params.id);let i="";l.value?(c.value=y.EDIT,i="Modificació de despeses",l.value.creationDate=new Date(l.value.creationDate),l.value.endDate=new Date(l.value.endDate),l.value.paymentDate=new Date(l.value.paymentDate)):(c.value=y.CREATE,e.setNewExpense(b.params.id),i="Alta de despeses"),v.setMenuItem({icon:$.WALLET,backButtonVisible:!0,title:i})};g(async()=>{await V()});const n=I(),x=async()=>{const i=l.value;let u=!1,d="";c.value===y.CREATE?(u=await e.createExpense(i),d="Despesa registrada correctament"):(u=await e.updateExpense(i.id,i),d="Despesa actualizada correctament"),u&&(n.add({severity:"success",summary:d,life:5e3}),z.back())};return(i,u)=>a(l)?(B(),N(de,{key:0,expense:a(l),onSubmit:x},null,8,["expense"])):h("",!0)}});export{ve as default};
