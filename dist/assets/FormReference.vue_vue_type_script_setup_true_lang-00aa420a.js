import{d as F,j as U,z as w,o as R,r as q,h as f,c as _,e as t,i as a,k as e,n as u,y as d,m as I,l as V,G as T,a as m,s as p}from"./index-f2f50ed2.js";import{c as L,a as i,F as N}from"./form-validator-929472fd.js";import{F as S}from"./FileEntityPicker-111325b9.js";import{u as z}from"./reference-a3279674.js";import{u as D}from"./tax-fd4f47ea.js";const P=t("br",null,null,-1),$={key:0},j={class:"three-columns"},G={class:"mt-1"},M={class:"mt-1"},Y={class:"mt-1"},A={class:"three-columns"},O={class:"mt-1"},X={class:"mt-1"},H={class:"mt-1"},J=t("label",{class:"block text-900 mb-2"},"Impost",-1),K=t("br",null,null,-1),oe=F({__name:"FormReference",props:{reference:{}},emits:["submit","cancel"],setup(y,{emit:x}){const v=y,C=U(),E=z(),b=D(),{reference:s}=w(E);R(async()=>{await b.fetchAll()});const k=L().shape({code:i().required("El codi és obligatori").max(50,"El codi no pot superar els 50 carácters"),description:i().required("La descripció és obligatori").max(250,"La descripció pot superar els 250 carácters"),version:i().required("La versió és obligatoria").max(20,"La versió pot superar els 20 carácters"),cost:i().required("El cost es obligatori"),price:i().required("El preu es obligatori"),taxId:i().required("El tipus d'iva es obligatori")}),r=q({result:!1,errors:{}}),g=()=>{const n=new N(k);r.value=n.validate(v.reference)},h=async()=>{if(g(),r.value.result)x("submit",v.reference);else{let n="";Object.entries(r.value.errors).forEach(o=>{n+=`${o[1].map(c=>c)}.   `}),C.add({severity:"warn",summary:"Formulari inválid",detail:n,life:5e3})}};return(n,o)=>{const c=f("Button"),B=f("Dropdown");return m(),_(T,null,[t("div",null,[a(c,{label:"Guardar",class:"grid_add_row_button",size:"small",onClick:h}),P]),e(s)?(m(),_("form",$,[t("section",j,[t("div",G,[a(d,{class:u(["mb-2",{"p-invalid":r.value.errors.code}]),label:"Codi",id:"code",modelValue:e(s).code,"onUpdate:modelValue":o[0]||(o[0]=l=>e(s).code=l)},null,8,["modelValue","class"])]),t("div",M,[a(d,{class:u(["mb-2",{"p-invalid":r.value.errors.description}]),label:"Descripció",id:"description",modelValue:e(s).description,"onUpdate:modelValue":o[1]||(o[1]=l=>e(s).description=l)},null,8,["modelValue","class"])]),t("div",Y,[a(d,{type:e(p).TEXT,label:"Versió",id:"version",modelValue:e(s).version,"onUpdate:modelValue":o[2]||(o[2]=l=>e(s).version=l)},null,8,["type","modelValue"])])]),t("section",A,[t("div",O,[a(d,{type:e(p).CURRENCY,label:"Cost",id:"cost",modelValue:e(s).cost,"onUpdate:modelValue":o[3]||(o[3]=l=>e(s).cost=l)},null,8,["type","modelValue"])]),t("div",X,[a(d,{type:e(p).CURRENCY,label:"Preu",id:"price",modelValue:e(s).price,"onUpdate:modelValue":o[4]||(o[4]=l=>e(s).price=l)},null,8,["type","modelValue"])]),t("div",H,[J,a(B,{modelValue:e(s).taxId,"onUpdate:modelValue":o[5]||(o[5]=l=>e(s).taxId=l),editable:"",options:e(b).taxes,optionValue:"id",optionLabel:"name",class:u(["w-full",{"p-invalid":r.value.errors.taxid}])},null,8,["modelValue","options","class"])])]),t("section",null,[K,e(s)?(m(),I(S,{key:0,title:"Planos",entity:"referenceMaps",id:e(s).id},null,8,["id"])):V("",!0)])])):V("",!0)],64)}}});export{oe as _};
