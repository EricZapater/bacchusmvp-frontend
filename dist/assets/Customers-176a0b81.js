import{d as B,r as D,j as q,x as $,g as P,u as A,o as H,P as u,h as d,c as M,i as e,k as i,w as a,G as V,a as j,e as c,n as p,D as F}from"./index-f2f50ed2.js";import{u as G}from"./customers-7e619cc2.js";import{v as b}from"./v4-a960c1f4.js";import"./base.service-1bae7a9f.js";const R=c("span",null,"Clients",-1),L=["onClick"],U=c("span",null,"Tipus de client",-1),z=["onClick"],X=B({__name:"Customers",setup(K){const _=D(0),f=q(),y=$(),m=P(),w=A(),l=G();H(async()=>{await l.fetchCustomers(),await l.fetchCustomerTypes(),w.setMenuItem({title:"Clients",icon:u.HASHTAG})});const g=t=>{var r;const o=(r=l.customerTypes)==null?void 0:r.find(s=>s.id===t);if(o)return o.name},I=(t,o)=>{y.require({target:t.currentTarget,message:`Está segur que vol eliminar el client ${o.comercialName}?`,icon:"pi pi-question-circle",acceptIcon:"pi pi-check",rejectIcon:"pi pi-times",accept:async()=>{await l.deleteCustomer(o.id)&&(f.add({severity:"success",summary:"Eliminat",life:3e3}),await l.fetchCustomers())}})},k=(t,o)=>{y.require({target:t.currentTarget,message:`Está segur que vol eliminar el tipus de client ${o.name}?`,icon:"pi pi-question-circle",acceptIcon:"pi pi-check",rejectIcon:"pi pi-times",accept:async()=>{await l.deleteCustomerType(o.id)&&(f.add({severity:"success",summary:"Eliminat",life:3e3}),await l.fetchCustomerTypes())}})},N=t=>{t.originalEvent.target.className.includes("grid_delete_column_button")||m.push({path:`/customers/${t.data.id}`})},S=t=>{t.originalEvent.target.className.includes("grid_delete_column_button")||m.push({path:`/customer-types/${t.data.id}`})},x=()=>{_.value===0?m.push({path:`/customers/${b()}`}):m.push({path:`/customer-types/${b()}`})};return(t,o)=>{const r=d("Button"),s=d("Column"),C=d("BooleanColumn"),v=d("DataTable"),T=d("TabPanel"),E=d("TabView");return j(),M(V,null,[e(r,{icon:i(u).PLUS,class:"grid_add_row_button",rounded:"",onClick:x},null,8,["icon"]),e(E,{activeIndex:_.value,"onUpdate:activeIndex":o[0]||(o[0]=n=>_.value=n)},{default:a(()=>[e(T,null,{header:a(()=>[c("i",{class:p([i(u).LINK,"mr-2"])},null,2),R]),default:a(()=>[e(v,{value:i(l).customers,tableStyle:"min-width: 100%",onRowClick:N},{default:a(()=>[e(s,{field:"comercialName",header:"Nom comercial",sortable:"",style:{width:"20%"}}),e(s,{field:"taxName",header:"Nom Fiscal",style:{width:"20%"}}),e(s,{field:"vatNumber",header:"CIF",style:{width:"20%"}}),e(s,{header:"Tipus",style:{width:"20%"}},{body:a(n=>[c("span",null,F(g(n.data.customerTypeId)),1)]),_:1}),e(s,{header:"Desactivat",sortable:"",style:{width:"20%"}},{body:a(n=>[e(C,{value:n.data.disabled,showColor:!1},null,8,["value"])]),_:1}),e(s,null,{body:a(n=>[c("i",{class:p([i(u).TIMES,"grid_delete_column_button"]),onClick:h=>I(h,n.data)},null,10,L)]),_:1})]),_:1},8,["value"])]),_:1}),e(T,null,{header:a(()=>[c("i",{class:p([i(u).HASHTAG,"mr-2"])},null,2),U]),default:a(()=>[e(v,{value:i(l).customerTypes,tableStyle:"min-width: 100%",onRowClick:S},{default:a(()=>[e(s,{field:"name",header:"Nom",style:{width:"33%"}}),e(s,{field:"description",header:"Descripció",style:{width:"33%"}}),e(s,{header:"Desactivat",style:{width:"33%"}},{body:a(n=>[e(C,{value:n.data.disabled},null,8,["value"])]),_:1}),e(s,null,{body:a(n=>[c("i",{class:p([i(u).TIMES,"grid_delete_column_button"]),onClick:h=>k(h,n.data)},null,10,z)]),_:1})]),_:1},8,["value"])]),_:1})]),_:1},8,["activeIndex"])],64)}}});export{X as default};
