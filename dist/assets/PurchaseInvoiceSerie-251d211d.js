import{b as w}from"./vue-router-b024814c.js";import{j as _,k,f as h,c as B,e as m,h as l,n as S,d as y,o as E,u as C,ax as F,M as T,l as b,a as N,P as D}from"./index-2bfc80b2.js";import{u as M}from"./invoices-7f9e766d.js";import{u as P}from"./usetoast.esm-82b2df9e.js";import{F as u}from"./component-c8ee66ae.js";import{r as $}from"./router-059ec17d.js";import{B as I}from"./BaseInput-ac691025.js";import{c as g,a as V,F as A}from"./form-validator-1a569dfe.js";import"./base.service-8b4a1a4e.js";import"./runtime-dom.esm-bundler-0884c737.js";import"./_plugin-vue_export-helper-c27b6911.js";const R={key:0},U={class:"three-columns"},x=m("label",{class:"block text-900 mb-2"},"Desactivada",-1),j={class:"mt-2"},q=_({__name:"FormPurchaseInvoiceSerie",props:{purchaseInvoiceSerie:{}},emits:["submit","cancel"],setup(f,{emit:i}){const t=f,d=P(),o=g().shape({name:V().required("El nom de la sèrie és obligatori").max(50,"El nom de la sèrie no pot superar els 50 caràcters"),description:V().required("La descripció de la sèrie és obligatòria").max(250,"La descripció de la sèrie no pot superar els 50 caràcters")}),r=k({result:!1,errors:{}}),p=()=>{const a=new A(o);r.value=a.validate(t.purchaseInvoiceSerie)},v=async()=>{if(p(),r.value.result)i("submit",t.purchaseInvoiceSerie);else{let a="";Object.entries(r.value.errors).forEach(e=>{a+=`${e[1].map(s=>s)}.   `}),d.add({severity:"warn",summary:"Formulari inválid",detail:a,life:5e3})}};return(a,e)=>{const s=h("Checkbox"),c=h("Button");return a.purchaseInvoiceSerie?(E(),B("form",R,[m("div",U,[l(I,{name:"name",class:S(["mb-2",{"p-invalid":r.value.errors.name}]),label:"Nom de la sèrie",id:"name",modelValue:a.purchaseInvoiceSerie.name,"onUpdate:modelValue":e[0]||(e[0]=n=>a.purchaseInvoiceSerie.name=n)},null,8,["modelValue","class"]),l(I,{name:"description",class:S(["mb-2",{"p-invalid":r.value.errors.description}]),label:"Descripció",id:"description",modelValue:a.purchaseInvoiceSerie.description,"onUpdate:modelValue":e[1]||(e[1]=n=>a.purchaseInvoiceSerie.description=n)},null,8,["modelValue","class"]),m("div",null,[x,l(s,{modelValue:a.purchaseInvoiceSerie.disabled,"onUpdate:modelValue":e[2]||(e[2]=n=>a.purchaseInvoiceSerie.disabled=n),class:"w-full",binary:!0},null,8,["modelValue"])])]),m("div",j,[l(c,{label:"Guardar",class:"mr-2",onClick:v})])])):y("",!0)}}}),Z=_({__name:"PurchaseInvoiceSerie",setup(f){const i=k(u.EDIT),t=w(),d=C(),o=M(),{purchaseInvoiceSerie:r}=F(o),p=async()=>{await o.fetchPurchaseInvoiceSerie(t.params.id);let e="";r.value?(i.value=u.EDIT,e=`Sèrie de facturació: ${r.value.name}`):(i.value=u.CREATE,o.setNewPurchaseInvoiceSerie(t.params.id),e="Alta de sèrie de facturació"),d.setMenuItem({icon:D.POUND,backButtonVisible:!0,text:e})};T(async()=>{await p()});const v=P(),a=async()=>{const e=r.value;let s=!1,c="";i.value===u.CREATE?(s=await o.createPurchaseInvoiceSerie(e),c="Sèrie de facturació creada correctament"):(s=await o.updatePurchaseInvoiceSerie(e.id,e),c="Sèrie de facturació actualizada correctament"),s&&(v.add({severity:"success",summary:c,life:5e3}),$.back())};return(e,s)=>b(r)?(E(),N(q,{key:0,purchaseInvoiceSerie:b(r),onSubmit:a},null,8,["purchaseInvoiceSerie"])):y("",!0)}});export{Z as default};
