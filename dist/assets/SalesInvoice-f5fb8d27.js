import{O as Q,V as x,W as Ie,X as be,h as b,Y as ve,a as h,c as g,G as A,S as ye,R as _,e as r,m as C,w as y,Z as ee,$ as B,n as j,l as P,D as S,a0 as ge,a1 as _e,a2 as W,a3 as G,a4 as w,a5 as ke,a6 as xe,a7 as Ce,i as m,a8 as De,a9 as we,aa as Pe,Q as R,d as F,j as Y,r as T,k as D,o as se,ab as Se,C as E,P as N,y as K,s as H,J as Le,p as Ve,b as Ee,f as Te,I as Ae,x as Be,v as Fe,g as Oe,u as Ke,z as Re,E as Z,ac as Ne}from"./index-f48f9a35.js";import{u as ze}from"./invoice-65a3ef13.js";import{u as Me}from"./customers-bac37636.js";import{u as z}from"./masterData-85c47cae.js";import{u as J}from"./lifecycle-39bb64f9.js";import{f as ae,b as Ue}from"./functions-13b40d42.js";import{c as le,a as te,d as ie,F as qe}from"./form-validator-7737fda2.js";import{l as Ge}from"./lodash-bdd13a9c.js";import{s as He}from"./index-87d7aad1.js";import{R as Ze}from"./constants-cc9165e4.js";import{S as ne}from"./index-6d36e7ed.js";import"./base.service-b546ad79.js";import"./index-6e87418c.js";import"./v4-a960c1f4.js";import"./reference.service-f5765ba1.js";import"./file.service-d10fe1fe.js";var oe={name:"TieredMenuSub",extends:Q,emits:["item-click","item-mouseenter"],props:{menuId:{type:String,default:null},focusedItemId:{type:String,default:null},items:{type:Array,default:null},level:{type:Number,default:0},templates:{type:Object,default:null},activeItemPath:{type:Object,default:null},exact:{type:Boolean,default:!0}},methods:{getItemId(e){return`${this.menuId}_${e.key}`},getItemKey(e){return this.getItemId(e)},getItemProp(e,i,n){return e&&e.item?x.getItemValue(e.item[i],n):void 0},getItemLabel(e){return this.getItemProp(e,"label")},getPTOptions(e,i){return this.ptm(i,{context:{active:this.isItemActive(e),focused:this.isItemFocused(e)}})},isItemActive(e){return this.activeItemPath.some(i=>i.key===e.key)},isItemVisible(e){return this.getItemProp(e,"visible")!==!1},isItemDisabled(e){return this.getItemProp(e,"disabled")},isItemFocused(e){return this.focusedItemId===this.getItemId(e)},isItemGroup(e){return x.isNotEmpty(e.items)},onItemClick(e,i){this.getItemProp(i,"command",{originalEvent:e,item:i.item}),this.$emit("item-click",{originalEvent:e,processedItem:i,isFocus:!0})},onItemMouseEnter(e,i){this.$emit("item-mouseenter",{originalEvent:e,processedItem:i})},onItemActionClick(e,i){i&&i(e)},getAriaSetSize(){return this.items.filter(e=>this.isItemVisible(e)&&!this.getItemProp(e,"separator")).length},getAriaPosInset(e){return e-this.items.slice(0,e).filter(i=>this.isItemVisible(i)&&this.getItemProp(i,"separator")).length+1},getItemClass(e){return["p-menuitem",this.getItemProp(e,"class"),{"p-menuitem-active p-highlight":this.isItemActive(e),"p-focus":this.isItemFocused(e),"p-disabled":this.isItemDisabled(e)}]},getItemActionClass(e,i){return["p-menuitem-link",{"router-link-active":i&&i.isActive,"router-link-active-exact":this.exact&&i&&i.isExactActive}]},getItemIconClass(e){return["p-menuitem-icon",this.getItemProp(e,"icon")]},getSeparatorItemClass(e){return["p-menuitem-separator",this.getItemProp(e,"class")]}},components:{AngleRightIcon:Ie},directives:{ripple:be}};const je=["id","aria-label","aria-disabled","aria-expanded","aria-haspopup","aria-level","aria-setsize","aria-posinset"],We=["onClick","onMouseenter"],Qe=["href","onClick"],Ye=["href","target"],Je=["id"];function Xe(e,i,n,o,a,s){const c=b("router-link"),d=b("AngleRightIcon"),l=b("TieredMenuSub",!0),I=ve("ripple");return h(),g("ul",ge(_e(e.ptm("menu"))),[(h(!0),g(A,null,ye(n.items,(t,u)=>(h(),g(A,{key:s.getItemKey(t)},[s.isItemVisible(t)&&!s.getItemProp(t,"separator")?(h(),g("li",_({key:0,id:s.getItemId(t),style:s.getItemProp(t,"style"),class:s.getItemClass(t),role:"menuitem","aria-label":s.getItemLabel(t),"aria-disabled":s.isItemDisabled(t)||void 0,"aria-expanded":s.isItemGroup(t)?s.isItemActive(t):void 0,"aria-haspopup":s.isItemGroup(t)&&!s.getItemProp(t,"to")?"menu":void 0,"aria-level":n.level+1,"aria-setsize":s.getAriaSetSize(),"aria-posinset":s.getAriaPosInset(u)},s.getPTOptions(t,"menuitem")),[r("div",_({class:"p-menuitem-content",onClick:p=>s.onItemClick(p,t),onMouseenter:p=>s.onItemMouseEnter(p,t)},s.getPTOptions(t,"content")),[n.templates.item?(h(),C(B(n.templates.item),{key:1,item:t.item},null,8,["item"])):(h(),g(A,{key:0},[s.getItemProp(t,"to")&&!s.isItemDisabled(t)?(h(),C(c,{key:0,to:s.getItemProp(t,"to"),custom:""},{default:y(({navigate:p,href:v,isActive:f,isExactActive:M})=>[ee((h(),g("a",_({href:v,class:s.getItemActionClass(t,{isActive:f,isExactActive:M}),tabindex:"-1","aria-hidden":"true",onClick:U=>s.onItemActionClick(U,p)},s.getPTOptions(t,"action")),[n.templates.itemicon?(h(),C(B(n.templates.itemicon),{key:0,item:t.item,class:j(s.getItemIconClass(t))},null,8,["item","class"])):s.getItemProp(t,"icon")?(h(),g("span",_({key:1,class:s.getItemIconClass(t)},s.getPTOptions(t,"icon")),null,16)):P("",!0),r("span",_({class:"p-menuitem-text"},s.getPTOptions(t,"label")),S(s.getItemLabel(t)),17)],16,Qe)),[[I]])]),_:2},1032,["to"])):ee((h(),g("a",_({key:1,href:s.getItemProp(t,"url"),class:s.getItemActionClass(t),target:s.getItemProp(t,"target"),tabindex:"-1","aria-hidden":"true"},s.getPTOptions(t,"action")),[n.templates.itemicon?(h(),C(B(n.templates.itemicon),{key:0,item:t.item,class:j(s.getItemIconClass(t))},null,8,["item","class"])):s.getItemProp(t,"icon")?(h(),g("span",_({key:1,class:s.getItemIconClass(t)},s.getPTOptions(t,"icon")),null,16)):P("",!0),r("span",_({class:"p-menuitem-text"},s.getPTOptions(t,"label")),S(s.getItemLabel(t)),17),s.getItemProp(t,"items")?(h(),g(A,{key:2},[n.templates.submenuicon?(h(),C(B(n.templates.submenuicon),_({key:0,class:"p-submenu-icon",active:s.isItemActive(t)},s.getPTOptions(t,"submenuIcon")),null,16,["active"])):(h(),C(d,_({key:1,class:"p-submenu-icon"},s.getPTOptions(t,"submenuIcon")),null,16))],64)):P("",!0)],16,Ye)),[[I]])],64))],16,We),s.isItemVisible(t)&&s.isItemGroup(t)?(h(),C(l,{key:0,id:s.getItemId(t)+"_list",role:"menu",class:"p-submenu-list",menuId:n.menuId,focusedItemId:n.focusedItemId,items:t.items,templates:n.templates,activeItemPath:n.activeItemPath,exact:n.exact,level:n.level+1,pt:e.pt,onItemClick:i[0]||(i[0]=p=>e.$emit("item-click",p)),onItemMouseenter:i[1]||(i[1]=p=>e.$emit("item-mouseenter",p))},null,8,["id","menuId","focusedItemId","items","templates","activeItemPath","exact","level","pt"])):P("",!0)],16,je)):P("",!0),s.isItemVisible(t)&&s.getItemProp(t,"separator")?(h(),g("li",_({key:1,id:s.getItemId(t),style:s.getItemProp(t,"style"),class:s.getSeparatorItemClass(t),role:"separator"},e.ptm("separator")),null,16,Je)):P("",!0)],64))),128))],16)}oe.render=Xe;var re={name:"TieredMenu",extends:Q,inheritAttrs:!1,emits:["focus","blur","before-show","before-hide","hide","show"],props:{popup:{type:Boolean,default:!1},model:{type:Array,default:null},appendTo:{type:String,default:"body"},autoZIndex:{type:Boolean,default:!0},baseZIndex:{type:Number,default:0},exact:{type:Boolean,default:!0},disabled:{type:Boolean,default:!1},tabindex:{type:Number,default:0},"aria-labelledby":{type:String,default:null},"aria-label":{type:String,default:null}},outsideClickListener:null,scrollHandler:null,resizeListener:null,target:null,container:null,menubar:null,searchTimeout:null,searchValue:null,data(){return{id:this.$attrs.id,focused:!1,focusedItemInfo:{index:-1,level:0,parentKey:""},activeItemPath:[],visible:!this.popup,dirty:!1}},watch:{"$attrs.id":function(e){this.id=e||W()},activeItemPath(e){this.popup||(x.isNotEmpty(e)?(this.bindOutsideClickListener(),this.bindResizeListener()):(this.unbindOutsideClickListener(),this.unbindResizeListener()))}},mounted(){this.id=this.id||W()},beforeUnmount(){this.unbindOutsideClickListener(),this.unbindResizeListener(),this.scrollHandler&&(this.scrollHandler.destroy(),this.scrollHandler=null),this.container&&this.autoZIndex&&G.clear(this.container),this.target=null,this.container=null},methods:{getItemProp(e,i){return e?x.getItemValue(e[i]):void 0},getItemLabel(e){return this.getItemProp(e,"label")},isItemDisabled(e){return this.getItemProp(e,"disabled")},isItemGroup(e){return x.isNotEmpty(this.getItemProp(e,"items"))},isItemSeparator(e){return this.getItemProp(e,"separator")},getProccessedItemLabel(e){return e?this.getItemLabel(e.item):void 0},isProccessedItemGroup(e){return e&&x.isNotEmpty(e.items)},toggle(e){this.visible?this.hide(e,!0):this.show(e)},show(e,i){this.popup&&(this.$emit("before-show"),this.visible=!0,this.target=this.target||e.currentTarget,this.relatedTarget=e.relatedTarget||null),this.focusedItemInfo={index:this.findFirstFocusedItemIndex(),level:0,parentKey:""},i&&w.focus(this.menubar)},hide(e,i){this.popup&&(this.$emit("before-hide"),this.visible=!1),this.activeItemPath=[],this.focusedItemInfo={index:-1,level:0,parentKey:""},i&&w.focus(this.relatedTarget||this.target||this.menubar),this.dirty=!1},onFocus(e){this.focused=!0,this.focusedItemInfo=this.focusedItemInfo.index!==-1?this.focusedItemInfo:{index:this.findFirstFocusedItemIndex(),level:0,parentKey:""},this.$emit("focus",e)},onBlur(e){this.focused=!1,this.focusedItemInfo={index:-1,level:0,parentKey:""},this.searchValue="",this.dirty=!1,this.$emit("blur",e)},onKeyDown(e){if(this.disabled){e.preventDefault();return}const i=e.metaKey||e.ctrlKey;switch(e.code){case"ArrowDown":this.onArrowDownKey(e);break;case"ArrowUp":this.onArrowUpKey(e);break;case"ArrowLeft":this.onArrowLeftKey(e);break;case"ArrowRight":this.onArrowRightKey(e);break;case"Home":this.onHomeKey(e);break;case"End":this.onEndKey(e);break;case"Space":this.onSpaceKey(e);break;case"Enter":this.onEnterKey(e);break;case"Escape":this.onEscapeKey(e);break;case"Tab":this.onTabKey(e);break;case"PageDown":case"PageUp":case"Backspace":case"ShiftLeft":case"ShiftRight":break;default:!i&&x.isPrintableCharacter(e.key)&&this.searchItems(e,e.key);break}},onItemChange(e){const{processedItem:i,isFocus:n}=e;if(x.isEmpty(i))return;const{index:o,key:a,level:s,parentKey:c,items:d}=i,l=x.isNotEmpty(d),I=this.activeItemPath.filter(t=>t.parentKey!==c&&t.parentKey!==a);l&&I.push(i),this.focusedItemInfo={index:o,level:s,parentKey:c},this.activeItemPath=I,l&&(this.dirty=!0),n&&w.focus(this.menubar)},onOverlayClick(e){ke.emit("overlay-click",{originalEvent:e,target:this.target})},onItemClick(e){const{originalEvent:i,processedItem:n}=e,o=this.isProccessedItemGroup(n),a=x.isEmpty(n.parent);if(this.isSelected(n)){const{index:c,key:d,level:l,parentKey:I}=n;this.activeItemPath=this.activeItemPath.filter(t=>d!==t.key&&d.startsWith(t.key)),this.focusedItemInfo={index:c,level:l,parentKey:I},this.dirty=!a,w.focus(this.menubar)}else if(o)this.onItemChange(e);else{const c=a?n:this.activeItemPath.find(d=>d.parentKey==="");this.hide(i),this.changeFocusedItemIndex(i,c?c.index:-1),w.focus(this.menubar)}},onItemMouseEnter(e){this.dirty&&this.onItemChange(e)},onArrowDownKey(e){const i=this.focusedItemInfo.index!==-1?this.findNextItemIndex(this.focusedItemInfo.index):this.findFirstFocusedItemIndex();this.changeFocusedItemIndex(e,i),e.preventDefault()},onArrowUpKey(e){if(e.altKey){if(this.focusedItemInfo.index!==-1){const i=this.visibleItems[this.focusedItemInfo.index];!this.isProccessedItemGroup(i)&&this.onItemChange({originalEvent:e,processedItem:i})}this.popup&&this.hide(e,!0),e.preventDefault()}else{const i=this.focusedItemInfo.index!==-1?this.findPrevItemIndex(this.focusedItemInfo.index):this.findLastFocusedItemIndex();this.changeFocusedItemIndex(e,i),e.preventDefault()}},onArrowLeftKey(e){const i=this.visibleItems[this.focusedItemInfo.index],n=this.activeItemPath.find(a=>a.key===i.parentKey);x.isEmpty(i.parent)||(this.focusedItemInfo={index:-1,parentKey:n?n.parentKey:""},this.searchValue="",this.onArrowDownKey(e)),this.activeItemPath=this.activeItemPath.filter(a=>a.parentKey!==this.focusedItemInfo.parentKey),e.preventDefault()},onArrowRightKey(e){const i=this.visibleItems[this.focusedItemInfo.index];this.isProccessedItemGroup(i)&&(this.onItemChange({originalEvent:e,processedItem:i}),this.focusedItemInfo={index:-1,parentKey:i.key},this.searchValue="",this.onArrowDownKey(e)),e.preventDefault()},onHomeKey(e){this.changeFocusedItemIndex(e,this.findFirstItemIndex()),e.preventDefault()},onEndKey(e){this.changeFocusedItemIndex(e,this.findLastItemIndex()),e.preventDefault()},onEnterKey(e){if(this.focusedItemInfo.index!==-1){const i=w.findSingle(this.menubar,`li[id="${`${this.focusedItemId}`}"]`),n=i&&w.findSingle(i,".p-menuitem-link");if(n?n.click():i&&i.click(),!this.popup){const o=this.visibleItems[this.focusedItemInfo.index];!this.isProccessedItemGroup(o)&&(this.focusedItemInfo.index=this.findFirstFocusedItemIndex())}}e.preventDefault()},onSpaceKey(e){this.onEnterKey(e)},onEscapeKey(e){this.hide(e,!0),!this.popup&&(this.focusedItemInfo.index=this.findFirstFocusedItemIndex()),e.preventDefault()},onTabKey(e){if(this.focusedItemInfo.index!==-1){const i=this.visibleItems[this.focusedItemInfo.index];!this.isProccessedItemGroup(i)&&this.onItemChange({originalEvent:e,processedItem:i})}this.hide()},onEnter(e){this.autoZIndex&&G.set("menu",e,this.baseZIndex+this.$primevue.config.zIndex.menu),this.alignOverlay(),w.focus(this.menubar),this.scrollInView()},onAfterEnter(){this.bindOutsideClickListener(),this.bindScrollListener(),this.bindResizeListener(),this.$emit("show")},onLeave(){this.unbindOutsideClickListener(),this.unbindScrollListener(),this.unbindResizeListener(),this.$emit("hide"),this.container=null,this.dirty=!1},onAfterLeave(e){this.autoZIndex&&G.clear(e)},alignOverlay(){this.container.style.minWidth=w.getOuterWidth(this.target)+"px",w.absolutePosition(this.container,this.target)},bindOutsideClickListener(){this.outsideClickListener||(this.outsideClickListener=e=>{const i=this.container&&!this.container.contains(e.target),n=this.popup?!(this.target&&(this.target===e.target||this.target.contains(e.target))):!0;i&&n&&this.hide()},document.addEventListener("click",this.outsideClickListener))},unbindOutsideClickListener(){this.outsideClickListener&&(document.removeEventListener("click",this.outsideClickListener),this.outsideClickListener=null)},bindScrollListener(){this.scrollHandler||(this.scrollHandler=new xe(this.target,e=>{this.hide(e,!0)})),this.scrollHandler.bindScrollListener()},unbindScrollListener(){this.scrollHandler&&this.scrollHandler.unbindScrollListener()},bindResizeListener(){this.resizeListener||(this.resizeListener=e=>{w.isTouchDevice()||this.hide(e,!0)},window.addEventListener("resize",this.resizeListener))},unbindResizeListener(){this.resizeListener&&(window.removeEventListener("resize",this.resizeListener),this.resizeListener=null)},isItemMatched(e){return this.isValidItem(e)&&this.getProccessedItemLabel(e).toLocaleLowerCase().startsWith(this.searchValue.toLocaleLowerCase())},isValidItem(e){return!!e&&!this.isItemDisabled(e.item)&&!this.isItemSeparator(e.item)},isValidSelectedItem(e){return this.isValidItem(e)&&this.isSelected(e)},isSelected(e){return this.activeItemPath.some(i=>i.key===e.key)},findFirstItemIndex(){return this.visibleItems.findIndex(e=>this.isValidItem(e))},findLastItemIndex(){return x.findLastIndex(this.visibleItems,e=>this.isValidItem(e))},findNextItemIndex(e){const i=e<this.visibleItems.length-1?this.visibleItems.slice(e+1).findIndex(n=>this.isValidItem(n)):-1;return i>-1?i+e+1:e},findPrevItemIndex(e){const i=e>0?x.findLastIndex(this.visibleItems.slice(0,e),n=>this.isValidItem(n)):-1;return i>-1?i:e},findSelectedItemIndex(){return this.visibleItems.findIndex(e=>this.isValidSelectedItem(e))},findFirstFocusedItemIndex(){const e=this.findSelectedItemIndex();return e<0?this.findFirstItemIndex():e},findLastFocusedItemIndex(){const e=this.findSelectedItemIndex();return e<0?this.findLastItemIndex():e},searchItems(e,i){this.searchValue=(this.searchValue||"")+i;let n=-1,o=!1;return this.focusedItemInfo.index!==-1?(n=this.visibleItems.slice(this.focusedItemInfo.index).findIndex(a=>this.isItemMatched(a)),n=n===-1?this.visibleItems.slice(0,this.focusedItemInfo.index).findIndex(a=>this.isItemMatched(a)):n+this.focusedItemInfo.index):n=this.visibleItems.findIndex(a=>this.isItemMatched(a)),n!==-1&&(o=!0),n===-1&&this.focusedItemInfo.index===-1&&(n=this.findFirstFocusedItemIndex()),n!==-1&&this.changeFocusedItemIndex(e,n),this.searchTimeout&&clearTimeout(this.searchTimeout),this.searchTimeout=setTimeout(()=>{this.searchValue="",this.searchTimeout=null},500),o},changeFocusedItemIndex(e,i){this.focusedItemInfo.index!==i&&(this.focusedItemInfo.index=i,this.scrollInView())},scrollInView(e=-1){const i=e!==-1?`${this.id}_${e}`:this.focusedItemId,n=w.findSingle(this.menubar,`li[id="${i}"]`);n&&n.scrollIntoView&&n.scrollIntoView({block:"nearest",inline:"start"})},createProcessedItems(e,i=0,n={},o=""){const a=[];return e&&e.forEach((s,c)=>{const d=(o!==""?o+"_":"")+c,l={item:s,index:c,level:i,key:d,parent:n,parentKey:o};l.items=this.createProcessedItems(s.items,i+1,l,d),a.push(l)}),a},containerRef(e){this.container=e},menubarRef(e){this.menubar=e?e.$el:void 0}},computed:{containerClass(){return["p-tieredmenu p-component",{"p-tieredmenu-overlay":this.popup,"p-input-filled":this.$primevue.config.inputStyle==="filled","p-ripple-disabled":this.$primevue.config.ripple===!1}]},processedItems(){return this.createProcessedItems(this.model||[])},visibleItems(){const e=this.activeItemPath.find(i=>i.key===this.focusedItemInfo.parentKey);return e?e.items:this.processedItems},focusedItemId(){return this.focusedItemInfo.index!==-1?`${this.id}${x.isNotEmpty(this.focusedItemInfo.parentKey)?"_"+this.focusedItemInfo.parentKey:""}_${this.focusedItemInfo.index}`:null}},components:{TieredMenuSub:oe,Portal:Ce}};const $e=["id"];function et(e,i,n,o,a,s){const c=b("TieredMenuSub"),d=b("Portal");return h(),C(d,{appendTo:n.appendTo,disabled:!n.popup},{default:y(()=>[m(De,{name:"p-connected-overlay",onEnter:s.onEnter,onAfterEnter:s.onAfterEnter,onLeave:s.onLeave,onAfterLeave:s.onAfterLeave},{default:y(()=>[a.visible?(h(),g("div",_({key:0,ref:s.containerRef,id:a.id,class:s.containerClass,onClick:i[0]||(i[0]=(...l)=>s.onOverlayClick&&s.onOverlayClick(...l))},{...e.$attrs,...e.ptm("root")}),[m(c,{ref:s.menubarRef,id:a.id+"_list",class:"p-tieredmenu-root-list",tabindex:n.disabled?-1:n.tabindex,role:"menubar","aria-label":e.ariaLabel,"aria-labelledby":e.ariaLabelledby,"aria-disabled":n.disabled||void 0,"aria-orientation":"vertical","aria-activedescendant":a.focused?s.focusedItemId:void 0,menuId:a.id,focusedItemId:a.focused?s.focusedItemId:void 0,items:s.processedItems,templates:e.$slots,activeItemPath:a.activeItemPath,exact:n.exact,level:0,pt:e.pt,onFocus:s.onFocus,onBlur:s.onBlur,onKeydown:s.onKeyDown,onItemClick:s.onItemClick,onItemMouseenter:s.onItemMouseEnter},null,8,["id","tabindex","aria-label","aria-labelledby","aria-disabled","aria-activedescendant","menuId","focusedItemId","items","templates","activeItemPath","exact","pt","onFocus","onBlur","onKeydown","onItemClick","onItemMouseenter"])],16,$e)):P("",!0)]),_:1},8,["onEnter","onAfterEnter","onLeave","onAfterLeave"])]),_:1},8,["appendTo","disabled"])}function tt(e,i){i===void 0&&(i={});var n=i.insertAt;if(!(!e||typeof document>"u")){var o=document.head||document.getElementsByTagName("head")[0],a=document.createElement("style");a.type="text/css",n==="top"&&o.firstChild?o.insertBefore(a,o.firstChild):o.appendChild(a),a.styleSheet?a.styleSheet.cssText=e:a.appendChild(document.createTextNode(e))}}var it=`
.p-tieredmenu-overlay {
    position: absolute;
    top: 0;
    left: 0;
}
.p-tieredmenu ul {
    margin: 0;
    padding: 0;
    list-style: none;
}
.p-tieredmenu .p-submenu-list {
    position: absolute;
    min-width: 100%;
    z-index: 1;
    display: none;
}
.p-tieredmenu .p-menuitem-link {
    cursor: pointer;
    display: flex;
    align-items: center;
    text-decoration: none;
    overflow: hidden;
    position: relative;
}
.p-tieredmenu .p-menuitem-text {
    line-height: 1;
}
.p-tieredmenu .p-menuitem {
    position: relative;
}
.p-tieredmenu .p-menuitem-link .p-submenu-icon {
    margin-left: auto;
}
.p-tieredmenu .p-menuitem-active > .p-submenu-list {
    display: block;
    left: 100%;
    top: 0;
}
`;tt(it);re.render=et;var X={name:"SplitButton",extends:Q,emits:["click"],props:{label:{type:String,default:null},icon:{type:String,default:null},model:{type:Array,default:null},autoZIndex:{type:Boolean,default:!0},baseZIndex:{type:Number,default:0},appendTo:{type:String,default:"body"},disabled:{type:Boolean,default:!1},class:{type:null,default:null},style:{type:null,default:null},buttonProps:{type:null,default:null},menuButtonProps:{type:null,default:null},menuButtonIcon:{type:String,default:void 0},severity:{type:String,default:null},raised:{type:Boolean,default:!1},rounded:{type:Boolean,default:!1},text:{type:Boolean,default:!1},outlined:{type:Boolean,default:!1},size:{type:String,default:null},plain:{type:Boolean,default:!1}},data(){return{isExpanded:!1}},methods:{onDropdownButtonClick(){this.$refs.menu.toggle({currentTarget:this.$el,relatedTarget:this.$refs.button.$el}),this.isExpanded=!this.$refs.menu.visible},onDropdownKeydown(e){(e.code==="ArrowDown"||e.code==="ArrowUp")&&(this.onDropdownButtonClick(),e.preventDefault())},onDefaultButtonClick(e){this.isExpanded&&this.$refs.menu.hide(e),this.$emit("click",e)}},computed:{ariaId(){return W()},containerClass(){return["p-splitbutton p-component",this.class,{[`p-button-${this.severity}`]:this.severity,"p-button-raised":this.raised,"p-button-rounded":this.rounded,"p-button-text":this.text,"p-button-outlined":this.outlined,"p-button-sm":this.size==="small","p-button-lg":this.size==="large"}]}},components:{PVSButton:we,PVSMenu:re,ChevronDownIcon:Pe}};function nt(e,i,n,o,a,s){const c=b("PVSButton"),d=b("PVSMenu");return h(),g("div",_({class:s.containerClass,style:n.style},e.ptm("root")),[R(e.$slots,"default",{},()=>[m(c,_({type:"button",class:"p-splitbutton-defaultbutton",label:n.label,disabled:n.disabled,"aria-label":n.label,onClick:s.onDefaultButtonClick,pt:e.ptm("button")},n.buttonProps),{icon:y(l=>[R(e.$slots,"icon",{},()=>[r("span",_({class:[n.icon,l.class]},e.ptm("button").icon),null,16)])]),_:3},16,["label","disabled","aria-label","onClick","pt"])]),m(c,_({ref:"button",type:"button",class:"p-splitbutton-menubutton",disabled:n.disabled,"aria-haspopup":"true","aria-expanded":a.isExpanded,"aria-controls":s.ariaId+"_overlay",onClick:s.onDropdownButtonClick,onKeydown:s.onDropdownKeydown,pt:e.ptm("menuButton")},n.menuButtonProps),{icon:y(l=>[R(e.$slots,"menubuttonicon",{},()=>[(h(),C(B(n.menuButtonIcon?"span":"ChevronDownIcon"),_({class:[n.menuButtonIcon,l.class]},e.ptm("menuButton").icon),null,16,["class"]))])]),_:3},16,["disabled","aria-expanded","aria-controls","onClick","onKeydown","pt"]),m(d,{ref:"menu",id:s.ariaId+"_overlay",model:n.model,popup:!0,autoZIndex:n.autoZIndex,baseZIndex:n.baseZIndex,appendTo:n.appendTo,pt:e.ptm("menu")},null,8,["id","model","autoZIndex","baseZIndex","appendTo","pt"])],16)}function st(e,i){i===void 0&&(i={});var n=i.insertAt;if(!(!e||typeof document>"u")){var o=document.head||document.getElementsByTagName("head")[0],a=document.createElement("style");a.type="text/css",n==="top"&&o.firstChild?o.insertBefore(a,o.firstChild):o.appendChild(a),a.styleSheet?a.styleSheet.cssText=e:a.appendChild(document.createTextNode(e))}}var at=`
.p-splitbutton[data-v-29147f7b] {
    display: inline-flex;
    position: relative;
}
.p-splitbutton .p-splitbutton-defaultbutton[data-v-29147f7b],
.p-splitbutton.p-button-rounded > .p-splitbutton-defaultbutton.p-button[data-v-29147f7b],
.p-splitbutton.p-button-outlined > .p-splitbutton-defaultbutton.p-button[data-v-29147f7b] {
    flex: 1 1 auto;
    border-top-right-radius: 0;
    border-bottom-right-radius: 0;
    border-right: 0 none;
}
.p-splitbutton-menubutton[data-v-29147f7b],
.p-splitbutton.p-button-rounded > .p-splitbutton-menubutton.p-button[data-v-29147f7b],
.p-splitbutton.p-button-outlined > .p-splitbutton-menubutton.p-button[data-v-29147f7b] {
    display: flex;
    align-items: center;
    justify-content: center;
    border-top-left-radius: 0;
    border-bottom-left-radius: 0;
}
.p-splitbutton .p-menu[data-v-29147f7b] {
    min-width: 100%;
}
.p-fluid .p-splitbutton[data-v-29147f7b] {
    display: flex;
}
`;st(at);X.render=nt;X.__scopeId="data-v-29147f7b";const lt={key:0},ot={class:"four-columns"},rt={class:"mt-2"},dt={class:"mt-2"},ut=r("label",{class:"block text-900 mb-2"},"Data Factura",-1),ct={class:"mt-2"},mt=r("label",{class:"block text-900 mb-2"},"Estat",-1),ht={class:"mt-2"},ft=r("label",{class:"block text-900 mb-2"},"Métode Pagament",-1),pt={class:"four-columns"},It={class:"mt-1"},bt=r("label",{class:"block text-900 mb-2"},"Base",-1),vt={class:"summary-field"},yt={class:"mt-1"},gt=r("label",{class:"block text-900 mb-2"},"Impostos",-1),_t={class:"summary-field"},kt={class:"mt-1"},xt=r("label",{class:"block text-900 mb-2"},"Total",-1),Ct={class:"summary-field"},Dt=F({__name:"FormSalesInvoice",props:{invoice:{}},emits:["submit","cancel"],setup(e,{emit:i}){Y();const n=z(),o=J();return le().shape({invoiceDate:te().required("La data és obligatoria"),paymentMethodId:te().required("El métode de pagament és obligatori")}),T({result:!1,errors:{}}),(a,s)=>{var I;const c=b("BaseInput"),d=b("Calendar"),l=b("Dropdown");return a.invoice?(h(),g("form",lt,[r("header",null,[r("section",ot,[r("div",rt,[m(c,{modelValue:a.invoice.invoiceNumber,"onUpdate:modelValue":s[0]||(s[0]=t=>a.invoice.invoiceNumber=t),label:"Número",disabled:!0},null,8,["modelValue"])]),r("div",dt,[ut,m(d,{modelValue:a.invoice.invoiceDate,"onUpdate:modelValue":s[1]||(s[1]=t=>a.invoice.invoiceDate=t),dateFormat:"dd/mm/yy"},null,8,["modelValue"])]),r("div",ct,[mt,m(l,{modelValue:a.invoice.statusId,"onUpdate:modelValue":s[2]||(s[2]=t=>a.invoice.statusId=t),editable:"",options:(I=D(o).lifecycle)==null?void 0:I.statuses,optionValue:"id",optionLabel:"name",class:"w-full"},null,8,["modelValue","options"])]),r("div",ht,[ft,m(l,{modelValue:a.invoice.paymentMethodId,"onUpdate:modelValue":s[3]||(s[3]=t=>a.invoice.paymentMethodId=t),editable:"",options:D(n).paymentMethods,optionValue:"id",optionLabel:"name",class:"w-full"},null,8,["modelValue","options"])])]),r("section",pt,[r("div",It,[bt,r("span",vt,S(a.invoice.baseAmount)+" €",1)]),r("div",yt,[gt,r("span",_t,S(a.invoice.taxAmount)+" €",1)]),r("div",kt,[xt,r("span",Ct,S(a.invoice.netAmount)+" €",1)])])])])):P("",!0)}}}),wt=["onClick"],Pt=F({__name:"TableInvoiceDetails",props:{details:{},headerVisible:{type:Boolean}},emits:["edit","delete"],setup(e,{emit:i}){const n=J(),o=z();se(async()=>{await n.fetchOneByName("SalesInvoice")});const a=c=>{var l;const d=(l=o.taxes)==null?void 0:l.find(I=>I.id===c);if(d)return`${d.percentatge} %`},s=(c,d)=>{i("delete",d)};return(c,d)=>{const l=b("Column"),I=b("DataTable");return h(),C(I,{class:"small-datatable",tableStyle:"min-width: 100%",scrollable:"",scrollHeight:"55vh",sortMode:"multiple",value:c.details},Se({default:y(()=>[m(l,{header:"Quantitat",field:"quantity",style:{width:"10%"}}),m(l,{header:"Descripció",field:"description",style:{width:"40%"}}),m(l,{header:"Preu unitat",field:"unitCost",style:{width:"10%"}},{body:y(t=>[E(S(t.data.unitCost)+" € ",1)]),_:1}),m(l,{header:"IVA",style:{width:"10%"}},{body:y(t=>[E(S(a(t.data.taxId)),1)]),_:1}),m(l,{header:"Total",field:"totalCost",style:{width:"10%"}},{body:y(t=>[E(S(t.data.amount)+" € ",1)]),_:1}),m(l,{style:{width:"10%"}},{body:y(t=>[r("i",{class:j([D(N).TIMES,"grid_delete_column_button"]),onClick:u=>s(u,t.data)},null,10,wt)]),_:1})]),_:2},[c.headerVisible?{name:"header",fn:y(()=>[R(c.$slots,"header")]),key:"0"}:void 0]),1032,["value"])}}}),St={key:0},Lt={class:"two-columns-7525"},Vt={class:"mt-2"},Et={class:"mt-2"},Tt=r("label",{class:"block text-900 mb-2"},"Impost",-1),At={class:"three-columns"},Bt={class:"mt-2"},Ft={class:"mt-2"},Ot={class:"mt-2"},Kt=F({__name:"FormSalesInvoiceDetail",props:{invoiceDetail:{}},emits:["submit","cancel"],setup(e,{emit:i}){const n=e,o=Y(),a=z(),s=()=>{const t=n.invoiceDetail;t.quantity&&t.quantity>0&&t.unitPrice&&t.unitPrice>0&&(n.invoiceDetail.unitCost=t.unitPrice,n.invoiceDetail.amount=Ge.round(t.quantity*t.unitPrice,2),n.invoiceDetail.totalCost=n.invoiceDetail.amount)},c=le().shape({quantity:ie().min(1).required("La quantitat ha de ser superior a 1"),unitPrice:ie().min(.01).required("El preu unitat és obligatori")}),d=T({result:!1,errors:{}}),l=()=>{const t=new qe(c);d.value=t.validate(n.invoiceDetail)},I=async()=>{if(l(),d.value.result)i("submit",n.invoiceDetail);else{let t="";Object.entries(d.value.errors).forEach(u=>{t+=`${u[1].map(p=>p)}.   `}),o.add({severity:"warn",summary:"Formulari inválid",detail:t,life:5e3})}};return(t,u)=>{const p=b("Dropdown"),v=b("Button");return t.invoiceDetail?(h(),g("form",St,[r("section",Lt,[r("div",Vt,[m(K,{label:"Descripció",modelValue:t.invoiceDetail.description,"onUpdate:modelValue":u[0]||(u[0]=f=>t.invoiceDetail.description=f)},null,8,["modelValue"])]),r("div",Et,[Tt,m(p,{modelValue:t.invoiceDetail.taxId,"onUpdate:modelValue":u[1]||(u[1]=f=>t.invoiceDetail.taxId=f),editable:"",options:D(a).taxes,optionValue:"id",optionLabel:"name",class:"w-full"},null,8,["modelValue","options"])])]),r("section",At,[r("div",Bt,[m(K,{type:D(H).NUMERIC,label:"Quantitat",modelValue:t.invoiceDetail.quantity,"onUpdate:modelValue":[u[2]||(u[2]=f=>t.invoiceDetail.quantity=f),s]},null,8,["type","modelValue"])]),r("div",Ft,[m(K,{type:D(H).CURRENCY,label:"Preu Unitat","model-value":t.invoiceDetail.unitPrice,"onUpdate:modelValue":[u[3]||(u[3]=f=>t.invoiceDetail.unitPrice=f),s]},null,8,["type","model-value"])]),r("div",Ot,[m(K,{type:D(H).CURRENCY,label:"Total","model-value":t.invoiceDetail.amount,"onUpdate:modelValue":u[4]||(u[4]=f=>t.invoiceDetail.amount=f),disabled:""},null,8,["type","model-value"])])]),m(v,{label:"Crear",onClick:I,style:{float:"right"},size:"small",class:"mt-2"})])):P("",!0)}}}),Rt=e=>(Ve("data-v-f38440b9"),e=e(),Ee(),e),Nt={class:"selector-filter"},zt={class:"selector-filter-field"},Mt=Rt(()=>r("label",{for:""},"Comanda",-1)),Ut={class:"selector-filter-button"},qt={class:"flex align-items-center gap-2"},Gt=F({__name:"SelectorOrderDetails",props:{details:{},headerVisible:{type:Boolean}},emits:["selected"],setup(e,{emit:i}){const n=e,o=T([]),a=T(""),s=Le(()=>{var d;return a.value.length===0?n.details:(d=n.details)==null?void 0:d.filter(l=>l.salesOrderNumber.toString().includes(a.value))}),c=()=>{if(o.value.length===0)return;const d=o.value.map(l=>({salesOrderHeaderId:l.salesOrderId,description:l.description,isInvoiced:!0,isServed:l.isServed,quantity:l.quantity,referenceId:l.referenceId,id:l.id,unitCost:l.unitCost,unitPrice:l.unitPrice,totalCost:l.totalCost,amount:l.amount}));i("selected",d)};return(d,l)=>{const I=b("InputText"),t=b("Button"),u=b("Column"),p=b("DataTable");return h(),C(p,{class:"small-datatable",tableStyle:"min-width: 100%",scrollable:"",scrollHeight:"70vh",value:s.value,selectionMode:"multiple",selection:o.value,"onUpdate:selection":l[1]||(l[1]=v=>o.value=v),"meta-key-selection":!1,rowGroupMode:"subheader",groupRowsBy:"salesOrderNumber",sortMode:"single",sortField:"salesOrderNumber"},{header:y(()=>[r("header",Nt,[r("div",zt,[Mt,E("   "),m(I,{style:{width:"150px",height:"35px"},modelValue:a.value,"onUpdate:modelValue":l[0]||(l[0]=v=>a.value=v),size:"small"},null,8,["modelValue"])]),r("div",Ut,[m(t,{onClick:c,size:"small",icon:D(N).CHECK_SQUARE},null,8,["icon"])])])]),groupheader:y(v=>[r("div",qt,[r("b",null,"Comanda "+S(v.data.salesOrderNumber)+" - "+S(D(ae)(v.data.salesOrderDate)),1)])]),default:y(()=>[m(u,{header:"Quantitat",field:"quantity",style:{width:"10%"}}),m(u,{header:"Descripció",field:"description",style:{width:"50%"}}),m(u,{header:"Preu",field:"amount",style:{width:"10%"}},{body:y(v=>[E(S(v.data.amount)+" € ",1)]),_:1})]),_:1},8,["value","selection"])}}});const Ht=Te(Gt,[["__scopeId","data-v-f38440b9"]]),Zt=Ae({id:"reports",state:()=>({reports:void 0}),getters:{getReportByName:e=>i=>{if(e.reports)return e.reports.find(n=>n.originalName.includes(i))}},actions:{async fetchAll(){this.reports=await ne.File.GetEntityFiles("Reports",Ze)},async generateAndDownload(e,i,n){const o=await ne.File.DownloadReport(e,i);o&&Ue(n,o)}}}),jt={key:0},Wt={class:"flex flex-wrap align-items-center justify-content-between gap-2"},Qt=r("span",{class:"text-xl text-900 font-bold"},"Detall de la factura",-1),mi=F({__name:"SalesInvoice",setup(e){const i=[{label:"Generar factura",icon:N.FILE_PDF,command:()=>U()}];Y();const n=Be(),o=Fe(),a=Oe(),s=Ke(),c=z(),d=Zt(),l=Me(),I=J(),t=ze(),{invoice:u}=Re(t),p={Free:0,FromOrder:1},v=T(0),f=Z({visible:!1,title:"",closable:!0,position:"center",modal:!0});se(async()=>{c.fetchMasterData(),l.fetchCustomers(),I.fetchOneByName("SalesInvoice"),d.fetchAll(),await t.GetById(o.params.id),s.setMenuItem({icon:N.WALLET,title:`Factura de venta ${u.value.invoiceNumber} - ${u.value.customerComercialName}`,backButtonVisible:!0})});const M=async()=>{await t.Update(u.value)&&a.back()},U=()=>{var L;const k=d.getReportByName("SalesInvoice");k&&d.generateAndDownload(k,[{key:"InvoiceId",value:u.value.id}],`Temges_Factura_${(L=u.value)==null?void 0:L.invoiceNumber}.pdf`)},$=T([]),q=Z({}),de=async()=>{u.value&&($.value=await He.SalesInvoice.GetInvoiceableOrderDetails(u.value.customerId),q.invoiceId=u.value.id,v.value=p.FromOrder,f.title="Selecció de linees de comanda",f.visible=!0)},ue=async k=>{q.orderDetails=k,await t.CreateInvoiceDetailsFromOrderDetails(q)&&await t.GetById(o.params.id),f.visible=!1},V=Z({}),ce=()=>{var k;if(v.value=p.Free,u.value){V.salesInvoiceId=u.value.id,V.quantity=1,V.description="",V.totalCost=0;const L=(k=c.taxes)==null?void 0:k.find(O=>O.name.includes("0"));L&&(V.taxId=L.id),f.title="Introducció de línea lliure",f.visible=!0}},me=async()=>{const k=await t.CreateInvoiceDetail(V);f.visible=!1,console.log("createInvoiceDetail",k)},he=async k=>{n.require({message:`Està segur que vol eliminar la línea ${k.description}?`,icon:"pi pi-question-circle",acceptIcon:"pi pi-check",rejectIcon:"pi pi-times",accept:async()=>{await t.DeleteInvoiceDetail(k),t.invoice.invoiceDate=ae(t.invoice.invoiceDate)}})};return(k,L)=>{const O=b("Button"),fe=b("Dialog");return h(),g(A,null,[m(D(X),{label:"Guardar",onClick:M,model:i,size:"small",class:"grid_add_row_button"}),D(u)?(h(),g("main",jt,[m(Dt,{class:"mt-3 mr-3",invoice:D(u)},null,8,["invoice"]),m(Pt,{class:"mt-3","header-visible":!0,details:D(u).salesInvoiceDetails,onDelete:he},{header:y(()=>[r("div",Wt,[Qt,r("div",null,[m(O,{size:"small",label:"Afegir de comanda",onClick:de}),E("    "),m(O,{size:"small",label:"Crear linia lliure",onClick:ce})])])]),_:1},8,["details"])])):P("",!0),m(fe,{visible:f.visible,"onUpdate:visible":L[0]||(L[0]=pe=>f.visible=pe),header:f.title,closable:f.closable,modal:f.modal,style:Ne({width:v.value===p.Free?"50vw":"60vw"}),maximizable:v.value===p.FromOrder},{default:y(()=>[v.value===p.Free?(h(),C(Kt,{key:0,invoiceDetail:V,onSubmit:me},null,8,["invoiceDetail"])):P("",!0),v.value===p.FromOrder?(h(),C(Ht,{key:1,headerVisible:!0,details:$.value,onSelected:ue},{header:y(()=>[]),_:1},8,["details"])):P("",!0)]),_:1},8,["visible","header","closable","modal","style","maximizable"])],64)}}});export{mi as default};
