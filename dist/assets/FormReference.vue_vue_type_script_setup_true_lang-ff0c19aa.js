import{d as _,H as V,j as B,r as q,h as I,c as d,e as l,i as r,n as u,y as n,k as a,l as c,m as N,G as S,a as i,s as p}from"./index-e1f2f827.js";import{c as P,a as b,d as y,F as D}from"./form-validator-d0c5af4e.js";import{F as $}from"./FileEntityPicker-2c4d6f3e.js";import{u as Y}from"./tax-1cd55388.js";import{u as j}from"./reference-ee955fc0.js";import{u as z}from"./referenceType-dcd3c232.js";const G=l("br",null,null,-1),M={key:0},H={class:"three-columns"},O={class:"mt-1"},X={class:"mt-1"},A={key:0,class:"mt-1"},J={key:1,class:"mt-1"},K=l("label",{class:"block text-900 mb-2"},"Tipus de material",-1),Q={key:0,class:"four-columns"},W={class:"mt-1"},Z=l("label",{class:"block text-900 mb-2"},"Format",-1),x={class:"mt-1"},ee={class:"mt-1"},oe={class:"mt-1"},se=l("label",{class:"block text-900 mb-2"},"Impost",-1),le={key:1,class:"three-columns"},re={class:"mt-1"},te={class:"mt-1"},ae={class:"mt-1"},ne=l("label",{class:"block text-900 mb-2"},"Impost",-1),ie=l("br",null,null,-1),be=_({__name:"FormReference",props:{module:{},reference:{}},emits:["submit","cancel"],setup(E,{emit:F}){const m=E,C=V(()=>m.module==="sales"),k=V(()=>m.module==="purchase");V(()=>m.module==="production");const h=B(),U=Y(),T=j(),R=z(),g=P().shape({code:b().required("El codi és obligatori").max(50,"El codi no pot superar els 50 carácters"),description:b().required("La descripció és obligatori").max(250,"La descripció pot superar els 250 carácters"),version:b().required("La versió és obligatoria").max(20,"La versió pot superar els 20 carácters"),cost:y().required("El cost es obligatori"),price:y().required("El preu es obligatori"),density:y().required("La densitat és obligatoria"),taxId:b().required("El tipus d'iva es obligatori")}),t=q({result:!1,errors:{}}),w=()=>{const e=new D(g);t.value=e.validate(m.reference)},L=async()=>{if(w(),t.value.result)F("submit",m.reference);else{let e="";Object.entries(t.value.errors).forEach(o=>{e+=`${o[1].map(v=>v)}.   `}),h.add({severity:"warn",summary:"Formulari inválid",detail:e,life:5e3})}};return(e,o)=>{const v=I("Button"),f=I("Dropdown");return i(),d(S,null,[l("div",null,[r(v,{label:"Guardar",class:"grid_add_row_button",size:"small",onClick:L}),G]),e.reference?(i(),d("form",M,[l("section",H,[l("div",O,[r(n,{class:u(["mb-2",{"p-invalid":t.value.errors.code}]),label:"Codi",id:"code",modelValue:e.reference.code,"onUpdate:modelValue":o[0]||(o[0]=s=>e.reference.code=s)},null,8,["modelValue","class"])]),l("div",X,[r(n,{class:u(["mb-2",{"p-invalid":t.value.errors.description}]),label:"Descripció",id:"description",modelValue:e.reference.description,"onUpdate:modelValue":o[1]||(o[1]=s=>e.reference.description=s)},null,8,["modelValue","class"])]),C.value?(i(),d("div",A,[r(n,{type:a(p).TEXT,label:"Versió",id:"version",modelValue:e.reference.version,"onUpdate:modelValue":o[2]||(o[2]=s=>e.reference.version=s)},null,8,["type","modelValue"])])):c("",!0),k.value?(i(),d("div",J,[K,r(f,{modelValue:e.reference.referenceTypeId,"onUpdate:modelValue":o[3]||(o[3]=s=>e.reference.referenceTypeId=s),editable:"",options:a(R).referenceTypes,optionValue:"id",optionLabel:"name",class:u(["w-full",{"p-invalid":t.value.errors.taxid}])},null,8,["modelValue","options","class"])])):c("",!0)]),k.value?(i(),d("section",Q,[l("div",W,[Z,r(f,{modelValue:e.reference.referenceFormatId,"onUpdate:modelValue":o[4]||(o[4]=s=>e.reference.referenceFormatId=s),editable:"",options:a(T).referenceFormats,optionValue:"id",optionLabel:"description",class:u(["w-full",{"p-invalid":t.value.errors.taxid}])},null,8,["modelValue","options","class"])]),l("div",x,[r(n,{type:a(p).NUMERIC,decimals:2,label:"Densitat",id:"density",modelValue:e.reference.density,"onUpdate:modelValue":o[5]||(o[5]=s=>e.reference.density=s)},null,8,["type","modelValue"])]),l("div",ee,[r(n,{type:a(p).CURRENCY,label:"Últim preu de compra",id:"lastPurchaseCost",modelValue:e.reference.lastPurchaseCost,"onUpdate:modelValue":o[6]||(o[6]=s=>e.reference.lastPurchaseCost=s)},null,8,["type","modelValue"])]),l("div",oe,[se,r(f,{modelValue:e.reference.taxId,"onUpdate:modelValue":o[7]||(o[7]=s=>e.reference.taxId=s),editable:"",options:a(U).taxes,optionValue:"id",optionLabel:"name",class:u(["w-full",{"p-invalid":t.value.errors.taxid}])},null,8,["modelValue","options","class"])])])):c("",!0),C.value?(i(),d("section",le,[l("div",re,[r(n,{type:a(p).CURRENCY,label:"Cost",id:"cost",modelValue:e.reference.cost,"onUpdate:modelValue":o[8]||(o[8]=s=>e.reference.cost=s)},null,8,["type","modelValue"])]),l("div",te,[r(n,{type:a(p).CURRENCY,label:"Preu",id:"price",modelValue:e.reference.price,"onUpdate:modelValue":o[9]||(o[9]=s=>e.reference.price=s)},null,8,["type","modelValue"])]),l("div",ae,[ne,r(f,{modelValue:e.reference.taxId,"onUpdate:modelValue":o[10]||(o[10]=s=>e.reference.taxId=s),editable:"",options:a(U).taxes,optionValue:"id",optionLabel:"name",class:u(["w-full",{"p-invalid":t.value.errors.taxid}])},null,8,["modelValue","options","class"])])])):c("",!0),l("section",null,[ie,e.reference?(i(),N($,{key:0,title:"Documentació",entity:"referenceMaps",id:e.reference.id},null,8,["id"])):c("",!0)])])):c("",!0)],64)}}});export{be as _};
