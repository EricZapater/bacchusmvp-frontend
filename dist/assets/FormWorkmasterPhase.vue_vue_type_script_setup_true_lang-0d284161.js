import{c as w,a as I,F as T}from"./form-validator-f8953ae6.js";import{d as C,j as B,H as W,r as _,h as i,c as F,e as s,i as l,y as u,k as m,n as c,l as D,a as U}from"./index-ca9243eb.js";import{u as g}from"./plantmodel-a683e399.js";const q={key:0},E=s("br",null,null,-1),L={class:"three-columns mb-2"},M={class:"three-columns mb-2"},N=s("label",{class:"block text-900 mb-2"},"Tipus de màquina",-1),$=s("label",{class:"block text-900 mb-2"},"Màquina preferida",-1),j=s("label",{class:"block text-900 mb-2"},"Tipus d'operari",-1),G=C({__name:"FormWorkmasterPhase",props:{workmaster:{},phase:{}},emits:["submit","cancel"],setup(b,{emit:h}){const r=b,f=B(),n=g(),V=W(()=>n.getWorkcentersByTypeId(r.phase.workcenterTypeId)),k=w().shape({phaseCode:I().required("El codi és obligatori")}),t=_({result:!1,errors:{}}),v=()=>{const e=new T(k);t.value=e.validate(r.phase)},y=async()=>{if(v(),t.value.result)r.phase.preferredWorkcenterId===""&&(r.phase.preferredWorkcenterId=null),h("submit",r.phase);else{let e="";Object.entries(t.value.errors).forEach(o=>{e+=`${o[1].map(d=>d)}.   `}),f.add({severity:"warn",summary:"Formulari inválid",detail:e,life:5e3})}};return(e,o)=>{const d=i("Button"),p=i("Dropdown");return e.phase?(U(),F("form",q,[s("div",null,[l(d,{label:"Guardar Fase",class:"grid_add_row_button",size:"small",onClick:y}),E]),s("section",L,[s("div",null,[l(u,{label:"Codi de la fase",modelValue:e.phase.phaseCode,"onUpdate:modelValue":o[0]||(o[0]=a=>e.phase.phaseCode=a)},null,8,["modelValue"])]),s("div",null,[l(u,{label:"Descripció",modelValue:e.phase.phaseDescription,"onUpdate:modelValue":o[1]||(o[1]=a=>e.phase.phaseDescription=a)},null,8,["modelValue"])])]),s("section",M,[s("div",null,[N,l(p,{modelValue:e.phase.workcenterTypeId,"onUpdate:modelValue":o[2]||(o[2]=a=>e.phase.workcenterTypeId=a),editable:"",options:m(n).workcenterTypes,optionValue:"id",optionLabel:"name",class:c(["w-full",{"p-invalid":t.value.errors.workcenterTypeId}])},null,8,["modelValue","options","class"])]),s("div",null,[$,l(p,{modelValue:e.phase.preferredWorkcenterId,"onUpdate:modelValue":o[3]||(o[3]=a=>e.phase.preferredWorkcenterId=a),editable:"",options:V.value,optionValue:"id",optionLabel:"description",class:"w-full"},null,8,["modelValue","options"])]),s("div",null,[j,l(p,{modelValue:e.phase.operatorTypeId,"onUpdate:modelValue":o[4]||(o[4]=a=>e.phase.operatorTypeId=a),editable:"",options:m(n).operatorTypes,optionValue:"id",optionLabel:"description",class:c(["w-full",{"p-invalid":t.value.errors.operatorTypeId}])},null,8,["modelValue","options","class"])])])])):D("",!0)}}});export{G as _};
