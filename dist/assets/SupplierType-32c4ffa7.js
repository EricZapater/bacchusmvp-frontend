import{u as F,b as I}from"./vue-router-ffe4063c.js";import{u as y}from"./suppliers-d19a56b4.js";import{j as V,ax as S,k as B,f as _,l as n,o as E,c as x,h as v,n as T,e as C,d as N,u as h,M,a as R,P as $}from"./index-a2430148.js";import{c as g,a as b,F as A}from"./form-validator-1a569dfe.js";import{u as k}from"./usetoast.esm-261cff49.js";import{F as u}from"./component-c8ee66ae.js";import"./suppliers.service-1deeab6b.js";import"./base.service-ac28cfab.js";const D={key:0},L={class:"mt-2"},U=V({__name:"FormSupplierType",emits:["submit"],setup(w,{emit:i}){const c=y(),{supplierType:a}=S(c),p=k(),o=g().shape({name:b().required("El nom és obligatori").max(250,"El nom comercial no pot superar els 250 carácters"),description:b().required("La descripció és obligatori").max(250,"La descripció no pot superar els 250 carácters")}),s=B({result:!1,errors:{}}),m=()=>{const r=new A(o);s.value=r.validate(a.value)},d=async()=>{if(m(),s.value.result)i("submit",a.value);else{let r="";Object.entries(s.value.errors).forEach(e=>{r+=`${e[1].map(t=>t)}.   `}),p.add({severity:"warn",summary:"Formulari inválid",detail:r,life:5e3})}};return(r,e)=>{const t=_("BaseInput"),l=_("Button");return n(a)?(E(),x("form",D,[v(t,{class:T(["mb-2",{"p-invalid":s.value.errors.name}]),label:"Nom",id:"name",modelValue:n(a).name,"onUpdate:modelValue":e[0]||(e[0]=f=>n(a).name=f)},null,8,["modelValue","class"]),v(t,{class:T(["mb-2",{"p-invalid":s.value.errors.description}]),label:"Descripció",id:"description",modelValue:n(a).description,"onUpdate:modelValue":e[1]||(e[1]=f=>n(a).description=f)},null,8,["modelValue","class"]),C("div",L,[v(l,{label:"Guardar",class:"mr-2",onClick:d})])])):N("",!0)}}}),K=V({__name:"SupplierType",setup(w){const i=B(u.EDIT),c=F(),a=I(),p=h(),o=y(),{supplierType:s}=S(o),m=async()=>{await o.fetchSupplierType(a.params.id);let e="";s.value?(i.value=u.EDIT,e=`Tipus de proveïdor ${s.value.name}`):(i.value=u.CREATE,o.setNewSupplierType(a.params.id),e="Alta de tipus de proveïdor"),p.setMenuItem({icon:$.BUILDING,backButtonVisible:!0,text:e})};M(async()=>{await m()});const d=k(),r=async()=>{const e=s.value;let t=!1,l="";i.value===u.CREATE?(t=await o.createSupplierType(e),l="Tipus de proveïdor creat correctament"):(t=await o.updateSupplierType(e.id,e),l="Tipus de proveïdor actualizat correctament"),t&&(d.add({severity:"success",summary:l,life:5e3}),c.back())};return(e,t)=>(E(),R(U,{onSubmit:r}))}});export{K as default};
