import{_ as M}from"./ExerciseDatePicker.vue_vue_type_script_setup_true_lang-1fec3c8b.js";import{K as D,d as P,j as C,x as T,g as B,u as I,r as R,o as E,P as m,h as u,c as F,i as t,w as f,k as c,a as A,e as l,C as L,D as N}from"./index-42358d85.js";import{S as x}from"./index-162c6393.js";import{u as G}from"./reference-71261d6f.js";import{u as V}from"./exercise-64670ae8.js";import{a as y}from"./functions-8d6e0d81.js";import"./base.service-ed93fa00.js";import"./reference.service-e0cdda03.js";import"./index-b0b545c9.js";import"./v4-a960c1f4.js";const j=D({id:"stockMovement",state:()=>({stockMovement:void 0,stockMovements:void 0}),getters:{},actions:{async Create(i){return x.StockMovementService.Create(i)},async GetBetweenDates(i,n){this.stockMovements=await x.StockMovementService.GetBetweenDates(i,n)}}}),z={class:"flex flex-wrap align-items-center justify-content-between gap-2"},H={class:"datatable-filter"},K={class:"filter-field"},Q={class:"datatable-buttons"},Y="temges.stockMovements.filter",se=P({__name:"StockMovements",setup(i){const n=C();T(),B();const s=I(),h=j(),v=G(),d=V(),_=R({exercise:void 0});E(async()=>{s.setMenuItem({icon:m.MAP,title:"Moviments de magatzem"}),await d.fetchAll(),await v.fetchReferences(),S()});const S=()=>{var a;const o=new Date().getFullYear().toString(),r=(a=d.exercises)==null?void 0:a.find(e=>e.name===o);r&&(s.exercisePicker.exercise=r,s.exercisePicker.dates=[new Date(s.exercisePicker.exercise.startDate),new Date(s.exercisePicker.exercise.endDate)])},k=()=>{s.cleanExercisePicker()},p=async()=>{if(s.exercisePicker.dates){const o=y(s.exercisePicker.dates[0]),r=y(s.exercisePicker.dates[1]);await h.GetBetweenDates(o,r),localStorage.setItem(Y,JSON.stringify(_.value))}else n.add({severity:"info",summary:"Filtre invàlid",detail:"Seleccioni un període",life:5e3})},w=o=>{var a;const r=(a=v.references)==null?void 0:a.find(e=>e.id===o);return r?r.description:""};return(o,r)=>{const a=u("Button"),e=u("Column"),b=u("DataTable");return A(),F("div",null,[t(b,{class:"small-datatable",tablStyle:"min-width:100%",scrollable:"",scrollHeight:"75vh",sortMode:"multiple",value:c(h).stockMovements},{header:f(()=>[l("div",z,[l("div",H,[l("div",K,[t(M,{exercises:c(d).exercises,onRangeSelected:p},null,8,["exercises"])])]),l("div",Q,[t(a,{class:"datatable-button mr-2",icon:c(m).FILTER,rounded:"",raised:"",onClick:p},null,8,["icon"]),t(a,{class:"datatable-button mr-2",icon:c(m).FILTER_SLASH,rounded:"",raised:"",onClick:k},null,8,["icon"])])])]),default:f(()=>[t(e,{field:"movementDate",header:"Data moviment",sortable:!0,style:{width:"10%"}}),t(e,{header:"Producte",sortable:!0,style:{width:"20%"}},{body:f(g=>[L(N(w(g.data.referenceId)),1)]),_:1}),t(e,{field:"width",header:"Ample (x) mm",style:{width:"5%"}}),t(e,{field:"length",header:"Llarg (y) mm",style:{width:"5%"}}),t(e,{field:"height",header:"Alt (z) mm",style:{width:"5%"}}),t(e,{field:"diameter",header:"Diámetre mm",style:{width:"5%"}}),t(e,{field:"thickness",header:"Gruix mm",style:{width:"5%"}}),t(e,{field:"description",header:"Descripció",sortable:!0,style:{width:"25%"}}),t(e,{field:"movementType",header:"Tipus de moviment",sortable:!0,style:{width:"10%"}}),t(e,{field:"quantity",header:"Quantitat",style:{width:"10%"}})]),_:1},8,["value"])])}}});export{se as default};
