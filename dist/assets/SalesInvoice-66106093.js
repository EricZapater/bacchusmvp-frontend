import{N as le,Q as ee,W as P,O as y,X as we,Y as Pe,h as D,Z as Se,a as h,c as k,G as M,R as xe,e as u,m as _,w as g,$ as ie,a0 as z,n as V,l as S,D as C,a1 as ue,a2 as X,a3 as Y,a4 as x,a5 as _e,a6 as Ce,a7 as Le,i as f,a8 as Ne,a9 as Ee,aa as Ke,K as R,ab as Te,d as H,j as de,r as B,k as w,x as Ve,H as ce,o as te,C as E,P as U,y as Z,s as J,p as Ae,b as Be,f as Oe,v as Fe,g as Me,u as ze,z as Re,E as ne}from"./index-357c9d4c.js";import{u as Ue}from"./invoice-23e52c39.js";import{u as Ge}from"./customers-fff5daf9.js";import{u as W}from"./masterData-e8e1356d.js";import{u as $}from"./lifecycle-1e4e7269.js";import{f as G,c as je}from"./functions-afe9fe15.js";import{c as me,a as se,d as ae,F as qe}from"./form-validator-9d0a56f8.js";import{l as He}from"./lodash-882653b6.js";import{u as Ze}from"./deliveryNote-b4efa973.js";import"./index-876c29fd.js";import"./base.service-d0780977.js";import"./index-44203410.js";import"./reference.service-387fdae1.js";import"./v4-a960c1f4.js";var We=`
@layer primevue {
    .p-tieredmenu ul {
        margin: 0;
        padding: 0;
        list-style: none;
    }

    .p-tieredmenu .p-submenu-list {
        position: absolute;
        min-width: 100%;
        z-index: 1;
        display: none;
    }

    .p-tieredmenu .p-menuitem-link {
        cursor: pointer;
        display: flex;
        align-items: center;
        text-decoration: none;
        overflow: hidden;
        position: relative;
    }

    .p-tieredmenu .p-menuitem-text {
        line-height: 1;
    }

    .p-tieredmenu .p-menuitem {
        position: relative;
    }

    .p-tieredmenu .p-menuitem-link .p-submenu-icon {
        margin-left: auto;
    }

    .p-tieredmenu .p-menuitem-active > .p-submenu-list {
        display: block;
        left: 100%;
        top: 0;
    }
}
`,$e={submenu:function(e){var i=e.instance,a=e.processedItem;return{display:i.isItemActive(a)?"block":"none"}}},Qe={root:function(e){var i=e.instance,a=e.props;return["p-tieredmenu p-component",{"p-tieredmenu-overlay":a.popup,"p-input-filled":i.$primevue.config.inputStyle==="filled","p-ripple-disabled":i.$primevue.config.ripple===!1}]},menu:"p-tieredmenu-root-list",menuitem:function(e){var i=e.instance,a=e.processedItem;return["p-menuitem",{"p-menuitem-active p-highlight":i.isItemActive(a),"p-focus":i.isItemFocused(a),"p-disabled":i.isItemDisabled(a)}]},content:"p-menuitem-content",action:function(e){var i=e.props,a=e.isActive,o=e.isExactActive;return["p-menuitem-link",{"router-link-active":a,"router-link-active-exact":i.exact&&o}]},icon:"p-menuitem-icon",text:"p-menuitem-text",submenuIcon:"p-submenu-icon",submenu:"p-submenu-list",separator:"p-menuitem-separator"},Ye=le.extend({name:"tieredmenu",css:We,classes:Qe,inlineStyles:$e}),Je={name:"BaseTieredMenu",extends:ee,props:{popup:{type:Boolean,default:!1},model:{type:Array,default:null},appendTo:{type:String,default:"body"},autoZIndex:{type:Boolean,default:!0},baseZIndex:{type:Number,default:0},exact:{type:Boolean,default:!0},disabled:{type:Boolean,default:!1},tabindex:{type:Number,default:0},"aria-labelledby":{type:String,default:null},"aria-label":{type:String,default:null}},style:Ye,provide:function(){return{$parentInstance:this}}},fe={name:"TieredMenuSub",hostName:"TieredMenu",extends:ee,emits:["item-click","item-mouseenter"],props:{menuId:{type:String,default:null},focusedItemId:{type:String,default:null},items:{type:Array,default:null},level:{type:Number,default:0},templates:{type:Object,default:null},activeItemPath:{type:Object,default:null},exact:{type:Boolean,default:!0},tabindex:{type:Number,default:0}},methods:{getItemId:function(e){return"".concat(this.menuId,"_").concat(e.key)},getItemKey:function(e){return this.getItemId(e)},getItemProp:function(e,i,a){return e&&e.item?P.getItemValue(e.item[i],a):void 0},getItemLabel:function(e){return this.getItemProp(e,"label")},getPTOptions:function(e,i,a){return this.ptm(a,{context:{item:e,index:i,active:this.isItemActive(e),focused:this.isItemFocused(e),disabled:this.isItemDisabled(e)}})},isItemActive:function(e){return this.activeItemPath.some(function(i){return i.key===e.key})},isItemVisible:function(e){return this.getItemProp(e,"visible")!==!1},isItemDisabled:function(e){return this.getItemProp(e,"disabled")},isItemFocused:function(e){return this.focusedItemId===this.getItemId(e)},isItemGroup:function(e){return P.isNotEmpty(e.items)},onItemClick:function(e,i){this.getItemProp(i,"command",{originalEvent:e,item:i.item}),this.$emit("item-click",{originalEvent:e,processedItem:i,isFocus:!0})},onItemMouseEnter:function(e,i){this.$emit("item-mouseenter",{originalEvent:e,processedItem:i})},onItemActionClick:function(e,i){i&&i(e)},getAriaSetSize:function(){var e=this;return this.items.filter(function(i){return e.isItemVisible(i)&&!e.getItemProp(i,"separator")}).length},getAriaPosInset:function(e){var i=this;return e-this.items.slice(0,e).filter(function(a){return i.isItemVisible(a)&&i.getItemProp(a,"separator")}).length+1},getMenuItemProps:function(e,i){return{action:y({class:this.cx("action"),tabindex:-1,"aria-hidden":!0},this.getPTOptions(e,i,"action")),icon:y({class:[this.cx("icon"),this.getItemProp(e,"icon")]},this.getPTOptions(e,i,"icon")),label:y({class:this.cx("label")},this.getPTOptions(e,i,"label")),submenuicon:y({class:this.cx("submenuIcon")},this.getPTOptions(e,i,"submenuIcon"))}}},components:{AngleRightIcon:we},directives:{ripple:Pe}},Xe=["tabindex"],et=["id","aria-label","aria-disabled","aria-expanded","aria-haspopup","aria-level","aria-setsize","aria-posinset","data-p-highlight","data-p-focused","data-p-disabled"],tt=["onClick","onMouseenter"],it=["href","onClick"],nt=["href","target"],st=["id"];function at(t,e,i,a,o,s){var p=D("router-link"),b=D("AngleRightIcon"),m=D("TieredMenuSub",!0),v=Se("ripple");return h(),k("ul",y({class:i.level===0?t.cx("menu"):t.cx("submenu"),tabindex:i.tabindex},i.level===0?t.ptm("menu"):t.ptm("submenu")),[(h(!0),k(M,null,xe(i.items,function(n,r){return h(),k(M,{key:s.getItemKey(n)},[s.isItemVisible(n)&&!s.getItemProp(n,"separator")?(h(),k("li",y({key:0,id:s.getItemId(n),style:s.getItemProp(n,"style"),class:[t.cx("menuitem",{processedItem:n}),s.getItemProp(n,"class")],role:"menuitem","aria-label":s.getItemLabel(n),"aria-disabled":s.isItemDisabled(n)||void 0,"aria-expanded":s.isItemGroup(n)?s.isItemActive(n):void 0,"aria-haspopup":s.isItemGroup(n)&&!s.getItemProp(n,"to")?"menu":void 0,"aria-level":i.level+1,"aria-setsize":s.getAriaSetSize(),"aria-posinset":s.getAriaPosInset(r)},s.getPTOptions(n,r,"menuitem"),{"data-p-highlight":s.isItemActive(n),"data-p-focused":s.isItemFocused(n),"data-p-disabled":s.isItemDisabled(n)}),[u("div",y({class:t.cx("content"),onClick:function(c){return s.onItemClick(c,n)},onMouseenter:function(c){return s.onItemMouseEnter(c,n)}},s.getPTOptions(n,r,"content")),[i.templates.item?(h(),_(z(i.templates.item),{key:1,item:n.item,hasSubmenu:s.getItemProp(n,"items"),label:s.getItemLabel(n),props:s.getMenuItemProps(n,r)},null,8,["item","hasSubmenu","label","props"])):(h(),k(M,{key:0},[s.getItemProp(n,"to")&&!s.isItemDisabled(n)?(h(),_(p,{key:0,to:s.getItemProp(n,"to"),custom:""},{default:g(function(l){var c=l.navigate,d=l.href,I=l.isActive,O=l.isExactActive;return[ie((h(),k("a",y({href:d,class:t.cx("action",{isActive:I,isExactActive:O}),tabindex:"-1","aria-hidden":"true",onClick:function(Q){return s.onItemActionClick(Q,c)}},s.getPTOptions(n,r,"action")),[i.templates.itemicon?(h(),_(z(i.templates.itemicon),{key:0,item:n.item,class:V([t.cx("icon"),s.getItemProp(n,"icon")])},null,8,["item","class"])):s.getItemProp(n,"icon")?(h(),k("span",y({key:1,class:[t.cx("icon"),s.getItemProp(n,"icon")]},s.getPTOptions(n,r,"icon")),null,16)):S("",!0),u("span",y({class:t.cx("label")},s.getPTOptions(n,r,"label")),C(s.getItemLabel(n)),17)],16,it)),[[v]])]}),_:2},1032,["to"])):ie((h(),k("a",y({key:1,href:s.getItemProp(n,"url"),class:t.cx("action"),target:s.getItemProp(n,"target"),tabindex:"-1","aria-hidden":"true"},s.getPTOptions(n,r,"action")),[i.templates.itemicon?(h(),_(z(i.templates.itemicon),{key:0,item:n.item,class:V([t.cx("icon"),s.getItemProp(n,"icon")])},null,8,["item","class"])):s.getItemProp(n,"icon")?(h(),k("span",y({key:1,class:[t.cx("icon"),s.getItemProp(n,"icon")]},s.getPTOptions(n,r,"icon")),null,16)):S("",!0),u("span",y({class:t.cx("label")},s.getPTOptions(n,r,"label")),C(s.getItemLabel(n)),17),s.getItemProp(n,"items")?(h(),k(M,{key:2},[i.templates.submenuicon?(h(),_(z(i.templates.submenuicon),y({key:0,class:t.cx("submenuIcon"),active:s.isItemActive(n)},s.getPTOptions(n,r,"submenuIcon")),null,16,["class","active"])):(h(),_(b,y({key:1,class:t.cx("submenuIcon")},s.getPTOptions(n,r,"submenuIcon")),null,16,["class"]))],64)):S("",!0)],16,nt)),[[v]])],64))],16,tt),s.isItemVisible(n)&&s.isItemGroup(n)?(h(),_(m,{key:0,id:s.getItemId(n)+"_list",style:ue(t.sx("submenu",!0,{processedItem:n})),role:"menu",menuId:i.menuId,focusedItemId:i.focusedItemId,items:n.items,templates:i.templates,activeItemPath:i.activeItemPath,exact:i.exact,level:i.level+1,pt:t.pt,unstyled:t.unstyled,onItemClick:e[0]||(e[0]=function(l){return t.$emit("item-click",l)}),onItemMouseenter:e[1]||(e[1]=function(l){return t.$emit("item-mouseenter",l)})},null,8,["id","style","menuId","focusedItemId","items","templates","activeItemPath","exact","level","pt","unstyled"])):S("",!0)],16,et)):S("",!0),s.isItemVisible(n)&&s.getItemProp(n,"separator")?(h(),k("li",y({key:1,id:s.getItemId(n),style:s.getItemProp(n,"style"),class:[t.cx("separator"),s.getItemProp(n,"class")],role:"separator"},t.ptm("separator")),null,16,st)):S("",!0)],64)}),128))],16,Xe)}fe.render=at;var pe={name:"TieredMenu",extends:Je,inheritAttrs:!1,emits:["focus","blur","before-show","before-hide","hide","show"],outsideClickListener:null,scrollHandler:null,resizeListener:null,target:null,container:null,menubar:null,searchTimeout:null,searchValue:null,data:function(){return{id:this.$attrs.id,focused:!1,focusedItemInfo:{index:-1,level:0,parentKey:""},activeItemPath:[],visible:!this.popup,dirty:!1}},watch:{"$attrs.id":function(e){this.id=e||X()},activeItemPath:function(e){this.popup||(P.isNotEmpty(e)?(this.bindOutsideClickListener(),this.bindResizeListener()):(this.unbindOutsideClickListener(),this.unbindResizeListener()))}},beforeMount:function(){this.$slots.item||console.warn("In future versions, vue-router support will be removed. Item templating should be used.")},mounted:function(){this.id=this.id||X()},beforeUnmount:function(){this.unbindOutsideClickListener(),this.unbindResizeListener(),this.scrollHandler&&(this.scrollHandler.destroy(),this.scrollHandler=null),this.container&&this.autoZIndex&&Y.clear(this.container),this.target=null,this.container=null},methods:{getItemProp:function(e,i){return e?P.getItemValue(e[i]):void 0},getItemLabel:function(e){return this.getItemProp(e,"label")},isItemDisabled:function(e){return this.getItemProp(e,"disabled")},isItemGroup:function(e){return P.isNotEmpty(this.getItemProp(e,"items"))},isItemSeparator:function(e){return this.getItemProp(e,"separator")},getProccessedItemLabel:function(e){return e?this.getItemLabel(e.item):void 0},isProccessedItemGroup:function(e){return e&&P.isNotEmpty(e.items)},toggle:function(e){this.visible?this.hide(e,!0):this.show(e)},show:function(e,i){this.popup&&(this.$emit("before-show"),this.visible=!0,this.target=this.target||e.currentTarget,this.relatedTarget=e.relatedTarget||null),this.focusedItemInfo={index:this.findFirstFocusedItemIndex(),level:0,parentKey:""},i&&x.focus(this.menubar)},hide:function(e,i){this.popup&&(this.$emit("before-hide"),this.visible=!1),this.activeItemPath=[],this.focusedItemInfo={index:-1,level:0,parentKey:""},i&&x.focus(this.relatedTarget||this.target||this.menubar),this.dirty=!1},onFocus:function(e){this.focused=!0,this.focusedItemInfo=this.focusedItemInfo.index!==-1?this.focusedItemInfo:{index:this.findFirstFocusedItemIndex(),level:0,parentKey:""},this.$emit("focus",e)},onBlur:function(e){this.focused=!1,this.focusedItemInfo={index:-1,level:0,parentKey:""},this.searchValue="",this.dirty=!1,this.$emit("blur",e)},onKeyDown:function(e){if(this.disabled){e.preventDefault();return}var i=e.metaKey||e.ctrlKey;switch(e.code){case"ArrowDown":this.onArrowDownKey(e);break;case"ArrowUp":this.onArrowUpKey(e);break;case"ArrowLeft":this.onArrowLeftKey(e);break;case"ArrowRight":this.onArrowRightKey(e);break;case"Home":this.onHomeKey(e);break;case"End":this.onEndKey(e);break;case"Space":this.onSpaceKey(e);break;case"Enter":this.onEnterKey(e);break;case"Escape":this.onEscapeKey(e);break;case"Tab":this.onTabKey(e);break;case"PageDown":case"PageUp":case"Backspace":case"ShiftLeft":case"ShiftRight":break;default:!i&&P.isPrintableCharacter(e.key)&&this.searchItems(e,e.key);break}},onItemChange:function(e){var i=e.processedItem,a=e.isFocus;if(!P.isEmpty(i)){var o=i.index,s=i.key,p=i.level,b=i.parentKey,m=i.items,v=P.isNotEmpty(m),n=this.activeItemPath.filter(function(r){return r.parentKey!==b&&r.parentKey!==s});v&&n.push(i),this.focusedItemInfo={index:o,level:p,parentKey:b},this.activeItemPath=n,v&&(this.dirty=!0),a&&x.focus(this.menubar)}},onOverlayClick:function(e){_e.emit("overlay-click",{originalEvent:e,target:this.target})},onItemClick:function(e){var i=e.originalEvent,a=e.processedItem,o=this.isProccessedItemGroup(a),s=P.isEmpty(a.parent),p=this.isSelected(a);if(p){var b=a.index,m=a.key,v=a.level,n=a.parentKey;this.activeItemPath=this.activeItemPath.filter(function(l){return m!==l.key&&m.startsWith(l.key)}),this.focusedItemInfo={index:b,level:v,parentKey:n},this.dirty=!s,x.focus(this.menubar)}else if(o)this.onItemChange(e);else{var r=s?a:this.activeItemPath.find(function(l){return l.parentKey===""});this.hide(i),this.changeFocusedItemIndex(i,r?r.index:-1),x.focus(this.menubar)}},onItemMouseEnter:function(e){this.dirty&&this.onItemChange(e)},onArrowDownKey:function(e){var i=this.focusedItemInfo.index!==-1?this.findNextItemIndex(this.focusedItemInfo.index):this.findFirstFocusedItemIndex();this.changeFocusedItemIndex(e,i),e.preventDefault()},onArrowUpKey:function(e){if(e.altKey){if(this.focusedItemInfo.index!==-1){var i=this.visibleItems[this.focusedItemInfo.index],a=this.isProccessedItemGroup(i);!a&&this.onItemChange({originalEvent:e,processedItem:i})}this.popup&&this.hide(e,!0),e.preventDefault()}else{var o=this.focusedItemInfo.index!==-1?this.findPrevItemIndex(this.focusedItemInfo.index):this.findLastFocusedItemIndex();this.changeFocusedItemIndex(e,o),e.preventDefault()}},onArrowLeftKey:function(e){var i=this,a=this.visibleItems[this.focusedItemInfo.index],o=this.activeItemPath.find(function(p){return p.key===a.parentKey}),s=P.isEmpty(a.parent);s||(this.focusedItemInfo={index:-1,parentKey:o?o.parentKey:""},this.searchValue="",this.onArrowDownKey(e)),this.activeItemPath=this.activeItemPath.filter(function(p){return p.parentKey!==i.focusedItemInfo.parentKey}),e.preventDefault()},onArrowRightKey:function(e){var i=this.visibleItems[this.focusedItemInfo.index],a=this.isProccessedItemGroup(i);a&&(this.onItemChange({originalEvent:e,processedItem:i}),this.focusedItemInfo={index:-1,parentKey:i.key},this.searchValue="",this.onArrowDownKey(e)),e.preventDefault()},onHomeKey:function(e){this.changeFocusedItemIndex(e,this.findFirstItemIndex()),e.preventDefault()},onEndKey:function(e){this.changeFocusedItemIndex(e,this.findLastItemIndex()),e.preventDefault()},onEnterKey:function(e){if(this.focusedItemInfo.index!==-1){var i=x.findSingle(this.menubar,'li[id="'.concat("".concat(this.focusedItemId),'"]')),a=i&&x.findSingle(i,'[data-pc-section="action"]');if(a?a.click():i&&i.click(),!this.popup){var o=this.visibleItems[this.focusedItemInfo.index],s=this.isProccessedItemGroup(o);!s&&(this.focusedItemInfo.index=this.findFirstFocusedItemIndex())}}e.preventDefault()},onSpaceKey:function(e){this.onEnterKey(e)},onEscapeKey:function(e){this.hide(e,!0),!this.popup&&(this.focusedItemInfo.index=this.findFirstFocusedItemIndex()),e.preventDefault()},onTabKey:function(e){if(this.focusedItemInfo.index!==-1){var i=this.visibleItems[this.focusedItemInfo.index],a=this.isProccessedItemGroup(i);!a&&this.onItemChange({originalEvent:e,processedItem:i})}this.hide()},onEnter:function(e){this.autoZIndex&&Y.set("menu",e,this.baseZIndex+this.$primevue.config.zIndex.menu),x.addStyles(e,{position:"absolute",top:"0",left:"0"}),this.alignOverlay(),x.focus(this.menubar),this.scrollInView()},onAfterEnter:function(){this.bindOutsideClickListener(),this.bindScrollListener(),this.bindResizeListener(),this.$emit("show")},onLeave:function(){this.unbindOutsideClickListener(),this.unbindScrollListener(),this.unbindResizeListener(),this.$emit("hide"),this.container=null,this.dirty=!1},onAfterLeave:function(e){this.autoZIndex&&Y.clear(e)},alignOverlay:function(){this.container.style.minWidth=x.getOuterWidth(this.target)+"px",x.absolutePosition(this.container,this.target)},bindOutsideClickListener:function(){var e=this;this.outsideClickListener||(this.outsideClickListener=function(i){var a=e.container&&!e.container.contains(i.target),o=e.popup?!(e.target&&(e.target===i.target||e.target.contains(i.target))):!0;a&&o&&e.hide()},document.addEventListener("click",this.outsideClickListener))},unbindOutsideClickListener:function(){this.outsideClickListener&&(document.removeEventListener("click",this.outsideClickListener),this.outsideClickListener=null)},bindScrollListener:function(){var e=this;this.scrollHandler||(this.scrollHandler=new Ce(this.target,function(i){e.hide(i,!0)})),this.scrollHandler.bindScrollListener()},unbindScrollListener:function(){this.scrollHandler&&this.scrollHandler.unbindScrollListener()},bindResizeListener:function(){var e=this;this.resizeListener||(this.resizeListener=function(i){x.isTouchDevice()||e.hide(i,!0)},window.addEventListener("resize",this.resizeListener))},unbindResizeListener:function(){this.resizeListener&&(window.removeEventListener("resize",this.resizeListener),this.resizeListener=null)},isItemMatched:function(e){return this.isValidItem(e)&&this.getProccessedItemLabel(e).toLocaleLowerCase().startsWith(this.searchValue.toLocaleLowerCase())},isValidItem:function(e){return!!e&&!this.isItemDisabled(e.item)&&!this.isItemSeparator(e.item)},isValidSelectedItem:function(e){return this.isValidItem(e)&&this.isSelected(e)},isSelected:function(e){return this.activeItemPath.some(function(i){return i.key===e.key})},findFirstItemIndex:function(){var e=this;return this.visibleItems.findIndex(function(i){return e.isValidItem(i)})},findLastItemIndex:function(){var e=this;return P.findLastIndex(this.visibleItems,function(i){return e.isValidItem(i)})},findNextItemIndex:function(e){var i=this,a=e<this.visibleItems.length-1?this.visibleItems.slice(e+1).findIndex(function(o){return i.isValidItem(o)}):-1;return a>-1?a+e+1:e},findPrevItemIndex:function(e){var i=this,a=e>0?P.findLastIndex(this.visibleItems.slice(0,e),function(o){return i.isValidItem(o)}):-1;return a>-1?a:e},findSelectedItemIndex:function(){var e=this;return this.visibleItems.findIndex(function(i){return e.isValidSelectedItem(i)})},findFirstFocusedItemIndex:function(){var e=this.findSelectedItemIndex();return e<0?this.findFirstItemIndex():e},findLastFocusedItemIndex:function(){var e=this.findSelectedItemIndex();return e<0?this.findLastItemIndex():e},searchItems:function(e,i){var a=this;this.searchValue=(this.searchValue||"")+i;var o=-1,s=!1;return this.focusedItemInfo.index!==-1?(o=this.visibleItems.slice(this.focusedItemInfo.index).findIndex(function(p){return a.isItemMatched(p)}),o=o===-1?this.visibleItems.slice(0,this.focusedItemInfo.index).findIndex(function(p){return a.isItemMatched(p)}):o+this.focusedItemInfo.index):o=this.visibleItems.findIndex(function(p){return a.isItemMatched(p)}),o!==-1&&(s=!0),o===-1&&this.focusedItemInfo.index===-1&&(o=this.findFirstFocusedItemIndex()),o!==-1&&this.changeFocusedItemIndex(e,o),this.searchTimeout&&clearTimeout(this.searchTimeout),this.searchTimeout=setTimeout(function(){a.searchValue="",a.searchTimeout=null},500),s},changeFocusedItemIndex:function(e,i){this.focusedItemInfo.index!==i&&(this.focusedItemInfo.index=i,this.scrollInView())},scrollInView:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:-1,i=e!==-1?"".concat(this.id,"_").concat(e):this.focusedItemId,a=x.findSingle(this.menubar,'li[id="'.concat(i,'"]'));a&&a.scrollIntoView&&a.scrollIntoView({block:"nearest",inline:"start"})},createProcessedItems:function(e){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"",p=[];return e&&e.forEach(function(b,m){var v=(s!==""?s+"_":"")+m,n={item:b,index:m,level:a,key:v,parent:o,parentKey:s};n.items=i.createProcessedItems(b.items,a+1,n,v),p.push(n)}),p},containerRef:function(e){this.container=e},menubarRef:function(e){this.menubar=e?e.$el:void 0}},computed:{processedItems:function(){return this.createProcessedItems(this.model||[])},visibleItems:function(){var e=this,i=this.activeItemPath.find(function(a){return a.key===e.focusedItemInfo.parentKey});return i?i.items:this.processedItems},focusedItemId:function(){return this.focusedItemInfo.index!==-1?"".concat(this.id).concat(P.isNotEmpty(this.focusedItemInfo.parentKey)?"_"+this.focusedItemInfo.parentKey:"","_").concat(this.focusedItemInfo.index):null}},components:{TieredMenuSub:fe,Portal:Le}};function j(t){"@babel/helpers - typeof";return j=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},j(t)}function oe(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),i.push.apply(i,a)}return i}function re(t){for(var e=1;e<arguments.length;e++){var i=arguments[e]!=null?arguments[e]:{};e%2?oe(Object(i),!0).forEach(function(a){ot(t,a,i[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):oe(Object(i)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(i,a))})}return t}function ot(t,e,i){return e=rt(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function rt(t){var e=lt(t,"string");return j(e)==="symbol"?e:String(e)}function lt(t,e){if(j(t)!=="object"||t===null)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var a=i.call(t,e||"default");if(j(a)!=="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var ut=["id"];function dt(t,e,i,a,o,s){var p=D("TieredMenuSub"),b=D("Portal");return h(),_(b,{appendTo:t.appendTo,disabled:!t.popup},{default:g(function(){return[f(Ne,y({name:"p-connected-overlay",onEnter:s.onEnter,onAfterEnter:s.onAfterEnter,onLeave:s.onLeave,onAfterLeave:s.onAfterLeave},t.ptm("transition")),{default:g(function(){return[o.visible?(h(),k("div",y({key:0,ref:s.containerRef,id:o.id,class:t.cx("root"),onClick:e[0]||(e[0]=function(){return s.onOverlayClick&&s.onOverlayClick.apply(s,arguments)})},re(re({},t.$attrs),t.ptm("root")),{"data-pc-name":"tieredmenu"}),[f(p,{ref:s.menubarRef,id:o.id+"_list",tabindex:t.disabled?-1:t.tabindex,role:"menubar","aria-label":t.ariaLabel,"aria-labelledby":t.ariaLabelledby,"aria-disabled":t.disabled||void 0,"aria-orientation":"vertical","aria-activedescendant":o.focused?s.focusedItemId:void 0,menuId:o.id,focusedItemId:o.focused?s.focusedItemId:void 0,items:s.processedItems,templates:t.$slots,activeItemPath:o.activeItemPath,exact:t.exact,level:0,pt:t.pt,unstyled:t.unstyled,onFocus:s.onFocus,onBlur:s.onBlur,onKeydown:s.onKeyDown,onItemClick:s.onItemClick,onItemMouseenter:s.onItemMouseEnter},null,8,["id","tabindex","aria-label","aria-labelledby","aria-disabled","aria-activedescendant","menuId","focusedItemId","items","templates","activeItemPath","exact","pt","unstyled","onFocus","onBlur","onKeydown","onItemClick","onItemMouseenter"])],16,ut)):S("",!0)]}),_:1},16,["onEnter","onAfterEnter","onLeave","onAfterLeave"])]}),_:1},8,["appendTo","disabled"])}pe.render=dt;function q(t){"@babel/helpers - typeof";return q=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},q(t)}function T(t,e,i){return e=ct(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function ct(t){var e=mt(t,"string");return q(e)==="symbol"?e:String(e)}function mt(t,e){if(q(t)!=="object"||t===null)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var a=i.call(t,e||"default");if(q(a)!=="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var ft=`
@layer primevue {
    .p-splitbutton {
        display: inline-flex;
        position: relative;
    }

    .p-splitbutton .p-splitbutton-defaultbutton,
    .p-splitbutton.p-button-rounded > .p-splitbutton-defaultbutton.p-button,
    .p-splitbutton.p-button-outlined > .p-splitbutton-defaultbutton.p-button {
        flex: 1 1 auto;
        border-top-right-radius: 0;
        border-bottom-right-radius: 0;
        border-right: 0 none;
    }

    .p-splitbutton-menubutton,
    .p-splitbutton.p-button-rounded > .p-splitbutton-menubutton.p-button,
    .p-splitbutton.p-button-outlined > .p-splitbutton-menubutton.p-button {
        display: flex;
        align-items: center;
        justify-content: center;
        border-top-left-radius: 0;
        border-bottom-left-radius: 0;
    }

    .p-splitbutton .p-menu {
        min-width: 100%;
    }

    .p-fluid .p-splitbutton {
        display: flex;
    }
}
`,pt={root:function(e){var i,a=e.props;return["p-splitbutton p-component",(i={},T(i,"p-button-".concat(a.severity),a.severity),T(i,"p-button-raised",a.raised),T(i,"p-button-rounded",a.rounded),T(i,"p-button-text",a.text),T(i,"p-button-outlined",a.outlined),T(i,"p-button-sm",a.size==="small"),T(i,"p-button-lg",a.size==="large"),i)]},button:"p-splitbutton-defaultbutton",menuButton:"p-splitbutton-menubutton"},ht=le.extend({name:"splitbutton",css:ft,classes:pt}),vt={name:"BaseSplitButton",extends:ee,props:{label:{type:String,default:null},icon:{type:String,default:null},model:{type:Array,default:null},autoZIndex:{type:Boolean,default:!0},baseZIndex:{type:Number,default:0},appendTo:{type:String,default:"body"},disabled:{type:Boolean,default:!1},class:{type:null,default:null},style:{type:null,default:null},buttonProps:{type:null,default:null},menuButtonProps:{type:null,default:null},menuButtonIcon:{type:String,default:void 0},severity:{type:String,default:null},raised:{type:Boolean,default:!1},rounded:{type:Boolean,default:!1},text:{type:Boolean,default:!1},outlined:{type:Boolean,default:!1},size:{type:String,default:null},plain:{type:Boolean,default:!1}},style:ht,provide:function(){return{$parentInstance:this}}},he={name:"SplitButton",extends:vt,emits:["click"],data:function(){return{isExpanded:!1}},mounted:function(){var e=this;this.$watch("$refs.menu.visible",function(i){e.isExpanded=i})},methods:{onDropdownButtonClick:function(e){e&&e.preventDefault(),this.$refs.menu.toggle({currentTarget:this.$el,relatedTarget:this.$refs.button.$el}),this.isExpanded=this.$refs.menu.visible},onDropdownKeydown:function(e){(e.code==="ArrowDown"||e.code==="ArrowUp")&&(this.onDropdownButtonClick(),e.preventDefault())},onDefaultButtonClick:function(e){this.isExpanded&&this.$refs.menu.hide(e),this.$emit("click",e)}},computed:{ariaId:function(){return X()},containerClass:function(){return[this.cx("root"),this.class]}},components:{PVSButton:Ee,PVSMenu:pe,ChevronDownIcon:Ke}},bt=["data-pc-severity"];function It(t,e,i,a,o,s){var p=D("PVSButton"),b=D("PVSMenu");return h(),k("div",y({class:s.containerClass,style:t.style},t.ptm("root"),{"data-pc-name":"splitbutton","data-pc-severity":t.severity}),[R(t.$slots,"default",{},function(){return[f(p,y({type:"button",class:t.cx("button"),label:t.label,disabled:t.disabled,severity:t.severity,text:t.text,outlined:t.outlined,size:t.size,"aria-label":t.label,onClick:s.onDefaultButtonClick,pt:t.ptm("button")},t.buttonProps,{unstyled:t.unstyled,"data-pc-section":"button"}),{icon:g(function(m){return[R(t.$slots,"icon",{class:V(m.class)},function(){return[u("span",y({class:[t.icon,m.class]},t.ptm("button").icon,{"data-pc-section":"buttonicon"}),null,16)]})]}),_:3},16,["class","label","disabled","severity","text","outlined","size","aria-label","onClick","pt","unstyled"])]}),f(p,y({ref:"button",type:"button",class:t.cx("menuButton"),disabled:t.disabled,"aria-haspopup":"true","aria-expanded":o.isExpanded,"aria-controls":s.ariaId+"_overlay",onClick:s.onDropdownButtonClick,onKeydown:s.onDropdownKeydown,pt:t.ptm("menuButton"),severity:t.severity,text:t.text,outlined:t.outlined,size:t.size},t.menuButtonProps,{unstyled:t.unstyled,"data-pc-section":"menubutton"}),{icon:g(function(m){return[R(t.$slots,"menubuttonicon",{class:V(m.class)},function(){return[(h(),_(z(t.menuButtonIcon?"span":"ChevronDownIcon"),y({class:[t.menuButtonIcon,m.class]},t.ptm("menuButton").icon,{"data-pc-section":"menubuttonicon"}),null,16,["class"]))]})]}),_:3},16,["class","disabled","aria-expanded","aria-controls","onClick","onKeydown","pt","severity","text","outlined","size","unstyled"]),f(b,{ref:"menu",id:s.ariaId+"_overlay",model:t.model,popup:!0,autoZIndex:t.autoZIndex,baseZIndex:t.baseZIndex,appendTo:t.appendTo,unstyled:t.unstyled,pt:t.ptm("menu")},Te({_:2},[t.$slots.menuitemicon?{name:"itemicon",fn:g(function(m){return[R(t.$slots,"menuitemicon",{item:m.item,class:V(m.class)})]}),key:"0"}:void 0]),1032,["id","model","autoZIndex","baseZIndex","appendTo","unstyled","pt"])],16,bt)}he.render=It;const yt={key:0},gt={class:"four-columns"},Dt={class:"mt-2"},kt={class:"mt-2"},wt=u("label",{class:"block text-900 mb-2"},"Data Factura",-1),Pt={class:"mt-2"},St=u("label",{class:"block text-900 mb-2"},"Estat",-1),xt={class:"mt-2"},_t=u("label",{class:"block text-900 mb-2"},"Métode Pagament",-1),Ct={class:"four-columns"},Lt={class:"mt-1"},Nt=u("label",{class:"block text-900 mb-2"},"Base",-1),Et={class:"summary-field"},Kt={class:"mt-1"},Tt=u("label",{class:"block text-900 mb-2"},"Impostos",-1),Vt={class:"summary-field"},At={class:"mt-1"},Bt=u("label",{class:"block text-900 mb-2"},"Total",-1),Ot={class:"summary-field"},Ft=H({__name:"FormSalesInvoice",props:{invoice:{}},emits:["submit","cancel"],setup(t,{emit:e}){de();const i=W(),a=$();return me().shape({invoiceDate:se().required("La data és obligatoria"),paymentMethodId:se().required("El métode de pagament és obligatori")}),B({result:!1,errors:{}}),(o,s)=>{var v;const p=D("BaseInput"),b=D("Calendar"),m=D("Dropdown");return o.invoice?(h(),k("form",yt,[u("section",gt,[u("div",Dt,[f(p,{modelValue:o.invoice.invoiceNumber,"onUpdate:modelValue":s[0]||(s[0]=n=>o.invoice.invoiceNumber=n),label:"Número",disabled:!0},null,8,["modelValue"])]),u("div",kt,[wt,f(b,{modelValue:o.invoice.invoiceDate,"onUpdate:modelValue":s[1]||(s[1]=n=>o.invoice.invoiceDate=n),dateFormat:"dd/mm/yy"},null,8,["modelValue"])]),u("div",Pt,[St,f(m,{modelValue:o.invoice.statusId,"onUpdate:modelValue":s[2]||(s[2]=n=>o.invoice.statusId=n),editable:"",options:(v=w(a).lifecycle)==null?void 0:v.statuses,optionValue:"id",optionLabel:"name",class:"w-full"},null,8,["modelValue","options"])]),u("div",xt,[_t,f(m,{modelValue:o.invoice.paymentMethodId,"onUpdate:modelValue":s[3]||(s[3]=n=>o.invoice.paymentMethodId=n),editable:"",options:w(i).paymentMethods,optionValue:"id",optionLabel:"name",class:"w-full"},null,8,["modelValue","options"])])]),u("section",Ct,[u("div",Lt,[Nt,u("span",Et,C(o.invoice.baseAmount)+" €",1)]),u("div",Kt,[Tt,u("span",Vt,C(o.invoice.taxAmount)+" €",1)]),u("div",At,[Bt,u("span",Ot,C(o.invoice.netAmount)+" €",1)])])])):S("",!0)}}}),Mt={class:"vertical-align-middle ml-2 font-bold line-height-3"},zt=["onClick"],Rt=["onClick"],Ut=H({__name:"TableInvoiceDetails",props:{details:{},deliveryNotes:{},canDelete:{type:Boolean}},emits:["delete","deleteDeliveryNote"],setup(t,{emit:e}){const i=t,a=Ve(),o=$(),s=W(),p=ce(()=>{let n=[];if(!i.details)return n;const r=i.details.filter(c=>!c.deliveryNoteDetailId).map(c=>({deliveryNoteId:"",deliveryNoteNumber:"Sense albarà",deliveryNoteDate:"",...c}));r.length>0&&n.push(...r);const l=i.details.filter(c=>c.deliveryNoteDetailId).map(c=>{var I;const d=(I=i.deliveryNotes)==null?void 0:I.find(O=>{var F;return O.id===((F=c.deliveryNoteDetail)==null?void 0:F.deliveryNoteId)});return{deliveryNoteId:d==null?void 0:d.id,deliveryNoteNumber:`Albarà ${d?d.number:"--"}`,deliveryNoteDate:d&&d.deliveryDate?` - ${G(d.deliveryDate)}`:"",...c}});return l.length>0&&n.push(...l),console.log(n),n});te(async()=>{await o.fetchOneByName("SalesInvoice")});const b=n=>{var l;const r=(l=s.taxes)==null?void 0:l.find(c=>c.id===n);if(r)return`${r.percentatge} %`},m=(n,r)=>{a.require({message:`Està segur que vol eliminar la línea ${r.description}?`,icon:"pi pi-question-circle",acceptIcon:"pi pi-check",rejectIcon:"pi pi-times",accept:async()=>{e("delete",r)}})},v=(n,r)=>{if(!i.deliveryNotes)return;const l=i.deliveryNotes.find(c=>c.id===r.deliveryNoteId);l&&a.require({message:`Està segur que vol treure l'${r.deliveryNoteNumber}?`,icon:"pi pi-question-circle",acceptIcon:"pi pi-check",rejectIcon:"pi pi-times",accept:async()=>{e("deleteDeliveryNote",l)}})};return(n,r)=>{const l=D("Column"),c=D("DataTable");return h(),_(c,{class:"p-datatable-sm",tableStyle:"min-width: 100%",scrollable:"",scrollHeight:"62vh",sortMode:"multiple",value:p.value,rowGroupMode:"subheader",groupRowsBy:"deliveryNoteNumber"},{header:g(()=>[R(n.$slots,"header")]),groupheader:g(d=>[u("span",Mt,C(d.data.deliveryNoteNumber),1),E("   "),n.canDelete&&d.data.deliveryNoteNumber!=="Sense albarà"?(h(),k("i",{key:0,class:V([w(U).TIMES,"grid_delete_column_button"]),onClick:I=>v(I,d.data)},null,10,zt)):S("",!0)]),default:g(()=>[f(l,{header:"Albarà",field:"deliveryNoteNumber",style:{width:"5%"}}),f(l,{header:"",field:"",style:{width:"5%"}}),f(l,{header:"Quantitat",field:"quantity",style:{width:"10%"}}),f(l,{header:"Descripció",field:"description",style:{width:"40%"}}),f(l,{header:"Preu unitat",field:"unitCost",style:{width:"10%"}},{body:g(d=>[E(C(d.data.unitCost)+" € ",1)]),_:1}),f(l,{header:"IVA",style:{width:"10%"}},{body:g(d=>[E(C(b(d.data.taxId)),1)]),_:1}),f(l,{header:"Total",field:"totalCost",style:{width:"10%"}},{body:g(d=>[E(C(d.data.amount)+" € ",1)]),_:1}),f(l,{style:{width:"10%"}},{body:g(d=>[d.data.deliveryNoteDetailId?S("",!0):(h(),k("i",{key:0,class:V([w(U).TIMES,"grid_delete_column_button"]),onClick:I=>m(I,d.data)},null,10,Rt))]),_:1})]),_:3},8,["value"])}}}),Gt={key:0},jt={class:"two-columns-7525"},qt={class:"mt-2"},Ht={class:"mt-2"},Zt=u("label",{class:"block text-900 mb-2"},"Impost",-1),Wt={class:"three-columns"},$t={class:"mt-2"},Qt={class:"mt-2"},Yt={class:"mt-2"},Jt=H({__name:"FormSalesInvoiceDetail",props:{invoiceDetail:{}},emits:["submit","cancel"],setup(t,{emit:e}){const i=t,a=de(),o=W(),s=()=>{const n=i.invoiceDetail;n.quantity&&n.quantity>0&&n.unitPrice&&n.unitPrice>0&&(i.invoiceDetail.unitCost=n.unitPrice,i.invoiceDetail.amount=He.round(n.quantity*n.unitPrice,2),i.invoiceDetail.totalCost=i.invoiceDetail.amount)},p=me().shape({quantity:ae().min(1).required("La quantitat ha de ser superior a 1"),unitPrice:ae().min(.01).required("El preu unitat és obligatori")}),b=B({result:!1,errors:{}}),m=()=>{const n=new qe(p);b.value=n.validate(i.invoiceDetail)},v=async()=>{if(m(),b.value.result)e("submit",i.invoiceDetail);else{let n="";Object.entries(b.value.errors).forEach(r=>{n+=`${r[1].map(l=>l)}.   `}),a.add({severity:"warn",summary:"Formulari inválid",detail:n,life:5e3})}};return(n,r)=>{const l=D("Dropdown"),c=D("Button");return n.invoiceDetail?(h(),k("form",Gt,[u("section",jt,[u("div",qt,[f(Z,{label:"Descripció",modelValue:n.invoiceDetail.description,"onUpdate:modelValue":r[0]||(r[0]=d=>n.invoiceDetail.description=d)},null,8,["modelValue"])]),u("div",Ht,[Zt,f(l,{modelValue:n.invoiceDetail.taxId,"onUpdate:modelValue":r[1]||(r[1]=d=>n.invoiceDetail.taxId=d),editable:"",options:w(o).taxes,optionValue:"id",optionLabel:"name",class:"w-full"},null,8,["modelValue","options"])])]),u("section",Wt,[u("div",$t,[f(Z,{type:w(J).NUMERIC,label:"Quantitat",modelValue:n.invoiceDetail.quantity,"onUpdate:modelValue":[r[2]||(r[2]=d=>n.invoiceDetail.quantity=d),s]},null,8,["type","modelValue"])]),u("div",Qt,[f(Z,{type:w(J).CURRENCY,label:"Preu Unitat","model-value":n.invoiceDetail.unitPrice,"onUpdate:modelValue":[r[3]||(r[3]=d=>n.invoiceDetail.unitPrice=d),s]},null,8,["type","model-value"])]),u("div",Yt,[f(Z,{type:w(J).CURRENCY,label:"Total","model-value":n.invoiceDetail.amount,"onUpdate:modelValue":r[4]||(r[4]=d=>n.invoiceDetail.amount=d),disabled:""},null,8,["type","model-value"])])]),f(c,{label:"Crear",onClick:v,style:{float:"right"},size:"small",class:"mt-2"})])):S("",!0)}}}),Xt=t=>(Ae("data-v-1516f95e"),t=t(),Be(),t),ei={class:"selector-filter"},ti={class:"selector-filter-field"},ii=Xt(()=>u("label",{for:""},"Buscar",-1)),ni={class:"selector-filter-button"},si={class:"flex align-items-center gap-2"},ai=H({__name:"SelectorDeliveryNotes",props:{deliveryNotes:{},headerVisible:{type:Boolean}},emits:["selected"],setup(t,{emit:e}){const i=t;te(()=>{a.fetchOneByName("DeliveryNote")});const a=$(),o=B([]),s=B(""),p=ce(()=>{var v=[];return i.deliveryNotes&&(v=i.deliveryNotes.filter(n=>n.number.toString().includes(s.value))),v}),b=v=>{var r;const n=(r=a.lifecycle)==null?void 0:r.statuses.find(l=>l.id===v);return n?n.name:""},m=()=>{o.value.length!==0&&e("selected",o.value)};return(v,n)=>{const r=D("InputText"),l=D("Button"),c=D("Column"),d=D("DataTable");return h(),_(d,{class:"small-datatable",tableStyle:"min-width: 100%",scrollable:"",scrollHeight:"75vh",metaKeySelection:!1,value:p.value,selectionMode:"multiple",selection:o.value,"onUpdate:selection":n[1]||(n[1]=I=>o.value=I)},{header:g(()=>[u("header",ei,[u("div",ti,[ii,E("   "),f(r,{style:{width:"150px",height:"35px"},modelValue:s.value,"onUpdate:modelValue":n[0]||(n[0]=I=>s.value=I),size:"small"},null,8,["modelValue"])]),u("div",ni,[f(l,{onClick:m,size:"small",icon:w(U).CHECK_SQUARE},null,8,["icon"])])])]),groupheader:g(I=>[u("div",si,[u("b",null,"Albarà d'entrega "+C(I.data.salesOrderNumber)+" - "+C(w(G)(I.data.salesOrderDate)),1)])]),default:g(()=>[f(c,{header:"Número",field:"number",style:{width:"10%"}}),f(c,{header:"Estat",field:"status",style:{width:"10%"}},{body:g(I=>[E(C(b(I.data.statusId)),1)]),_:1}),f(c,{header:"Data Entrega",field:"deliveryDate",style:{width:"10%"}},{body:g(I=>[E(C(I.data.deliveryDate?w(G)(I.data.deliveryDate):""),1)]),_:1})]),_:1},8,["value","selection"])}}});const oi=Oe(ai,[["__scopeId","data-v-1516f95e"]]),ri={key:0},li={class:"flex flex-wrap align-items-center justify-content-between gap-2"},ui=u("span",{class:"text-xl text-900 font-bold"},"Detall de la factura",-1),Pi=H({__name:"SalesInvoice",setup(t){const e=[{label:"Generar factura",icon:U.FILE_PDF,command:()=>F()}],i=Fe(),a=Me(),o=ze(),s=W(),p=Ge(),b=$(),m=Ue(),v=Ze(),{invoice:n}=Re(m),r={Free:0,FromDeliveryNote:1},l=B(0),c=ne({visible:!1,title:"",closable:!0,position:"center",modal:!0}),d=B("");te(async()=>{d.value=i.params.id,s.fetchMasterData(),p.fetchCustomers(),await I(),o.setMenuItem({icon:U.WALLET,title:`Factura de venta ${n.value.invoiceNumber} - ${n.value.customerComercialName}`,backButtonVisible:!0})});const I=async()=>{b.fetchOneByName("SalesInvoice"),await m.GetById(d.value),await v.GetByInvoiceId(d.value),n.value&&(n.value.invoiceDate=G(n.value.invoiceDate))},O=async()=>{n.value&&(n.value.invoiceDate=je(n.value.invoiceDate),await m.Update(n.value)&&a.back())},F=()=>{},Q=async()=>{n.value&&(await v.GetToInvoice(n.value.customerId),l.value=r.FromDeliveryNote,c.title="Selector d'albarans d'entrega",c.visible=!0)},ve=async L=>{for(let N=0;N<L.length;N++){const A=L[N];await m.AddDeliveryNote(n.value.id,A)}c.visible=!1,I()},be=async L=>{await m.RemoveDeliveryNote(n.value.id,L),I()},K=ne({}),Ie=()=>{var L;if(l.value=r.Free,n.value){K.salesInvoiceId=n.value.id,K.quantity=1,K.description="",K.totalCost=0;const N=(L=s.taxes)==null?void 0:L.find(A=>A.percentatge===21);N&&(K.taxId=N.id),c.title="Introducció de línea lliure",c.visible=!0}},ye=async()=>{await m.CreateInvoiceDetail(K),c.visible=!1},ge=async L=>{await m.DeleteInvoiceDetail(L),m.invoice.invoiceDate=G(m.invoice.invoiceDate)};return(L,N)=>{const A=D("Button"),De=D("Dialog");return h(),k(M,null,[f(w(he),{label:"Guardar",onClick:O,model:e,size:"small",class:"grid_add_row_button"}),w(n)?(h(),k("main",ri,[f(Ft,{class:"mt-3 mr-3",invoice:w(n)},null,8,["invoice"]),f(Ut,{class:"mt-3",canDelete:!0,details:w(n).salesInvoiceDetails,deliveryNotes:w(v).deliveryNotes,onDeleteDeliveryNote:be,onDelete:ge},{header:g(()=>[u("div",li,[ui,u("div",null,[f(A,{size:"small",label:"Afegir albarà",onClick:Q}),E("    "),f(A,{size:"small",label:"Afegir linia lliure",onClick:Ie})])])]),_:1},8,["details","deliveryNotes"])])):S("",!0),f(De,{visible:c.visible,"onUpdate:visible":N[0]||(N[0]=ke=>c.visible=ke),header:c.title,closable:c.closable,modal:c.modal,style:ue({width:l.value===r.Free?"50vw":"60vw"}),maximizable:l.value===r.FromDeliveryNote},{default:g(()=>[l.value===r.Free?(h(),_(Jt,{key:0,invoiceDetail:K,onSubmit:ye},null,8,["invoiceDetail"])):S("",!0),l.value===r.FromDeliveryNote?(h(),_(oi,{key:1,headerVisible:!0,deliveryNotes:w(v).invoiceableDeliveryNotes,onSelected:ve},{header:g(()=>[]),_:1},8,["deliveryNotes"])):S("",!0)]),_:1},8,["visible","header","closable","modal","style","maximizable"])],64)}}});export{Pi as default};
