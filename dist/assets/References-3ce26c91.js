import{d as B,r as x,H as C,h as R,m as a,w as h,a as c,e as v,i,y as N,k as g,P as S,l as u,D,n as q,p as j,b as H,f as V,g as U,v as z,u as A,x as K,j as L,o as G}from"./index-7f1f4f85.js";import{u as E}from"./reference-b32fa3fb.js";import{u as J}from"./referenceType-c8aa8706.js";import{v as O}from"./v4-a960c1f4.js";import"./reference.service-5b190a19.js";import"./base.service-f5b02259.js";import"./index-df30801e.js";const Q=f=>(j("data-v-104b4df1"),f=f(),H(),f),W={class:"references-header"},X={class:"references-filter"},Y=Q(()=>v("label",null,"Codi",-1)),Z=["onClick"],ee=B({__name:"TableReferences",props:{module:{},references:{}},emits:["add","edit","delete"],setup(f,{emit:p}){const l=f,b=J(),m=E(),_=x({code:""}),y=C(()=>l.module==="sales"),t=C(()=>l.module==="purchase");C(()=>l.module==="production");const w=C(()=>l.references?_.value.code.length>0?l.references.filter(o=>o.code.includes(_.value.code)):m.references:[]),k=()=>{p("add")},I=o=>{o.originalEvent.target.className.includes("grid_delete_column_button")||p("edit",o.data)},s=(o,r)=>{p("delete",r)},T=o=>{var d;const r=(d=m.referenceFormats)==null?void 0:d.find(e=>e.id===o);return r?r.description:""},P=o=>{var d;const r=(d=b.referenceTypes)==null?void 0:d.find(e=>e.id===o);return r?r.name:""};return(o,r)=>{const d=R("Button"),e=R("Column"),$=R("BooleanColumn"),F=R("DataTable");return c(),a(F,{value:w.value,tableStyle:"min-width: 100%",scrollable:"",scrollHeight:"80vh",onRowClick:I},{header:h(()=>[v("div",W,[v("div",X,[Y,i(N,{modelValue:_.value.code,"onUpdate:modelValue":r[0]||(r[0]=n=>_.value.code=n)},null,8,["modelValue"])]),i(d,{style:{float:"right"},icon:g(S).PLUS,rounded:"",raised:"",onClick:k},null,8,["icon"])])]),default:h(()=>[i(e,{field:"code",header:"Codi",style:{width:"15%"}}),i(e,{field:"description",header:"Descripció",style:{width:"35%"}}),y.value?(c(),a(e,{key:0,field:"version",header:"Versió",style:{width:"15%"}})):u("",!0),y.value?(c(),a(e,{key:1,field:"cost",header:"Cost",style:{width:"20%"}})):u("",!0),y.value?(c(),a(e,{key:2,field:"price",header:"Preu",style:{width:"20%"}})):u("",!0),t.value?(c(),a(e,{key:3,field:"referenceTypeId",header:"Tipus",style:{width:"10%"}},{body:h(n=>[v("span",null,D(P(n.data.referenceTypeId)),1)]),_:1})):u("",!0),t.value?(c(),a(e,{key:4,field:"referenceFormatId",header:"Format",style:{width:"10%"}},{body:h(n=>[v("span",null,D(T(n.data.referenceFormatId)),1)]),_:1})):u("",!0),t.value?(c(),a(e,{key:5,field:"density",header:"Densitat",style:{width:"10%"}})):u("",!0),t.value?(c(),a(e,{key:6,field:"lastPurchaseCost",header:"Última Compra",style:{width:"15%"}})):u("",!0),i(e,{header:"Desc.",style:{width:"10%"}},{body:h(n=>[i($,{value:n.data.disabled},null,8,["value"])]),_:1}),i(e,{style:{width:"10%"}},{body:h(n=>[v("i",{class:q([g(S).TIMES,"grid_delete_column_button"]),onClick:M=>s(M,n.data)},null,10,Z)]),_:1})]),_:1},8,["value"])}}});const te=V(ee,[["__scopeId","data-v-104b4df1"]]),se=B({__name:"References",setup(f){const p=U(),l=z(),b=A(),m=E(),_=K(),y=L(),t=x("");G(async()=>{t.value=l.params.module,await m.fetchReferencesByModule(t.value);let s="";t.value==="sales"?s="Referencies de venta":t.value==="purchase"?s="Materies primeres":t.value==="production"&&(s="Referencies de producció"),b.setMenuItem({icon:S.TICKET,title:s})});const w=()=>{p.push({path:`/reference/${t.value}/${O()}`})},k=s=>{p.push({path:`/reference/${t.value}/${s.id}`})},I=s=>{_.require({message:`Está segur que vol eliminar el material ${s.description}?`,icon:"pi pi-question-circle",acceptIcon:"pi pi-check",rejectIcon:"pi pi-times",accept:async()=>{await m.deleteReference(s.id)&&y.add({severity:"success",summary:"Eliminat",life:3e3})}})};return(s,T)=>(c(),a(te,{module:t.value,references:g(m).references,onAdd:w,onEdit:k,onDelete:I},null,8,["module","references"]))}});const ie=V(se,[["__scopeId","data-v-c1014dda"]]);export{ie as default};
