import{b as k}from"./vue-router-c71b0622.js";import{u as b}from"./suppliers-3ee00375.js";import{j as y,aw as V,k as S,f as F,l as n,o as B,c as C,h as f,n as v,e as I,d as x,u as N,M as h,a as M,P as $}from"./index-0e14a554.js";import{B as T}from"./BaseInput-9aa79c5a.js";import{c as g,a as _,F as A}from"./form-validator-88e54800.js";import{u as E}from"./usetoast.esm-2dfabc60.js";import{F as c}from"./component-45e7825d.js";import{r as D}from"./router-b83aeac2.js";import"./base.service-431caa23.js";import"./_plugin-vue_export-helper-c27b6911.js";const R={key:0},L={class:"mt-2"},U=y({__name:"FormSupplierType",emits:["submit"],setup(w,{emit:i}){const p=b(),{supplierType:s}=V(p),o=E(),l=g().shape({name:_().required("El nom és obligatori").max(250,"El nom comercial no pot superar els 250 carácters"),description:_().required("La descripció és obligatori").max(250,"La descripció no pot superar els 250 carácters")}),r=S({result:!1,errors:{}}),u=()=>{const e=new A(l);r.value=e.validate(s.value)},m=async()=>{if(u(),r.value.result)i("submit",s.value);else{let e="";Object.entries(r.value.errors).forEach(a=>{e+=`${a[1].map(t=>t)}.   `}),o.add({severity:"warn",summary:"Formulari inválid",detail:e,life:5e3})}};return(e,a)=>{const t=F("Button");return n(s)?(B(),C("form",R,[f(T,{class:v(["mb-2",{"p-invalid":r.value.errors.name}]),label:"Nom",id:"name",modelValue:n(s).name,"onUpdate:modelValue":a[0]||(a[0]=d=>n(s).name=d)},null,8,["modelValue","class"]),f(T,{class:v(["mb-2",{"p-invalid":r.value.errors.description}]),label:"Descripció",id:"description",modelValue:n(s).description,"onUpdate:modelValue":a[1]||(a[1]=d=>n(s).description=d)},null,8,["modelValue","class"]),I("div",L,[f(t,{label:"Guardar",class:"mr-2",onClick:m})])])):x("",!0)}}}),W=y({__name:"SupplierType",setup(w){const i=S(c.EDIT),p=k(),s=N(),o=b(),{supplierType:l}=V(o),r=async()=>{await o.fetchSupplierType(p.params.id);let e="";l.value?(i.value=c.EDIT,e=`Tipus de proveïdor ${l.value.name}`):(i.value=c.CREATE,o.setNewSupplierType(p.params.id),e="Alta de tipus de proveïdor"),s.setMenuItem({icon:$.BUILDING,backButtonVisible:!0,text:e})};h(async()=>{await r()});const u=E(),m=async()=>{const e=l.value;let a=!1,t="";i.value===c.CREATE?(a=await o.createSupplierType(e),t="Tipus de proveïdor creat correctament"):(a=await o.updateSupplierType(e.id,e),t="Tipus de proveïdor actualizat correctament"),a&&(u.add({severity:"success",summary:t,life:5e3}),D.back())};return(e,a)=>(B(),M(U,{onSubmit:m}))}});export{W as default};
