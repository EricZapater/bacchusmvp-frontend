import{d as y,E as b,g as V,r as S,j as w,l as n,a as E,c as x,k as v,n as f,G as T,e as C,v as F,H as u,A as I,u as N,o as g,x as A,P as $,J as h}from"./index-7ccc629f.js";import{u as B}from"./suppliers-01a7d4f4.js";import{c as D,a as _,F as M}from"./form-validator-58b9052d.js";const R={key:0},G={class:"mt-2"},L=y({__name:"FormSupplierType",emits:["submit"],setup(k,{emit:l}){const c=B(),{supplierType:s}=b(c),t=V(),i=D().shape({name:_().required("El nom és obligatori").max(250,"El nom comercial no pot superar els 250 carácters"),description:_().required("La descripció és obligatori").max(250,"La descripció no pot superar els 250 carácters")}),o=S({result:!1,errors:{}}),p=()=>{const e=new M(i);o.value=e.validate(s.value)},m=async()=>{if(p(),o.value.result)l("submit",s.value);else{let e="";Object.entries(o.value.errors).forEach(a=>{e+=`${a[1].map(r=>r)}.   `}),t.add({severity:"warn",summary:"Formulari inválid",detail:e,life:5e3})}};return(e,a)=>{const r=w("Button");return n(s)?(E(),x("form",R,[v(T,{class:f(["mb-2",{"p-invalid":o.value.errors.name}]),label:"Nom",id:"name",modelValue:n(s).name,"onUpdate:modelValue":a[0]||(a[0]=d=>n(s).name=d)},null,8,["modelValue","class"]),v(T,{class:f(["mb-2",{"p-invalid":o.value.errors.description}]),label:"Descripció",id:"description",modelValue:n(s).description,"onUpdate:modelValue":a[1]||(a[1]=d=>n(s).description=d)},null,8,["modelValue","class"]),C("div",G,[v(r,{label:"Guardar",class:"mr-2",onClick:m})])])):F("",!0)}}}),z=y({__name:"SupplierType",setup(k){const l=S(u.EDIT),c=I(),s=N(),t=B(),{supplierType:i}=b(t),o=async()=>{await t.fetchSupplierType(c.params.id);let e="";i.value?(l.value=u.EDIT,e=`Tipus de proveïdor ${i.value.name}`):(l.value=u.CREATE,t.setNewSupplierType(c.params.id),e="Alta de tipus de proveïdor"),s.setMenuItem({icon:$.BUILDING,backButtonVisible:!0,text:e})};g(async()=>{await o()});const p=V(),m=async()=>{const e=i.value;let a=!1,r="";l.value===u.CREATE?(a=await t.createSupplierType(e),r="Tipus de proveïdor creat correctament"):(a=await t.updateSupplierType(e.id,e),r="Tipus de proveïdor actualizat correctament"),a&&(p.add({severity:"success",summary:r,life:5e3}),h.back())};return(e,a)=>(E(),A(L,{onSubmit:m}))}});export{z as default};
