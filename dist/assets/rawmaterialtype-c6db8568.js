import{d as _,j as h,z as k,o as T,r as E,h as b,c as I,e as u,i as m,n as f,y as v,l as B,a as C,F as c,v as N,u as P,k as V,m as g,P as D,K as S}from"./index-f48f9a35.js";import{u as F}from"./warehouse-08766b0f.js";import{c as $,a as M,F as z}from"./form-validator-7737fda2.js";import"./base.service-b546ad79.js";const A={key:0},U={class:"three-columns"},L=u("label",{class:"block text-900 mb-2"},"Desactivat",-1),j={class:"mt-2"},q=_({__name:"FormRawMaterialType",props:{rawmaterialtype:{}},emits:["submit","cancel"],setup(w,{emit:l}){const i=w,d=h(),t=F();k(t),T(async()=>{});const s=$().shape({name:M().required("El nom és obligatori").max(250,"El nom no pot superar els 250 carácters"),description:M().required("La descripció és obligatori").max(250,"La descripció pot superar els 250 carácters")}),r=E({result:!1,errors:{}}),p=()=>{const e=new z(s);r.value=e.validate(i.rawmaterialtype)},y=async()=>{if(p(),r.value.result)l("submit",i.rawmaterialtype);else{let e="";Object.entries(r.value.errors).forEach(a=>{e+=`${a[1].map(o=>o)}.   `}),d.add({severity:"warn",summary:"Formulari inválid",detail:e,life:5e3})}};return(e,a)=>{const o=b("Checkbox"),R=b("Button");return e.rawmaterialtype?(C(),I("form",A,[u("section",U,[m(v,{class:f(["mb-2",{"p-invalid":r.value.errors.name}]),label:"Nom",id:"name",modelValue:e.rawmaterialtype.name,"onUpdate:modelValue":a[0]||(a[0]=n=>e.rawmaterialtype.name=n)},null,8,["modelValue","class"]),m(v,{class:f(["mb-2",{"p-invalid":r.value.errors.description}]),label:"Descripció",id:"description",modelValue:e.rawmaterialtype.description,"onUpdate:modelValue":a[1]||(a[1]=n=>e.rawmaterialtype.description=n)},null,8,["modelValue","class"]),u("div",null,[L,m(o,{modelValue:e.rawmaterialtype.disabled,"onUpdate:modelValue":a[2]||(a[2]=n=>e.rawmaterialtype.disabled=n),class:"w-full",binary:!0},null,8,["modelValue"])])]),u("div",j,[m(R,{label:"Guardar",class:"mr-2",onClick:y})])])):B("",!0)}}}),O=_({__name:"rawmaterialtype",setup(w){const l=E(c.EDIT),i=N(),d=P(),t=F(),{rawmaterialType:s}=k(t),r=async()=>{await t.fetchWarehouse(i.params.id);let e="";s.value?(l.value=c.EDIT,e=`Magatzem ${s.value.name}`):(l.value=c.CREATE,t.setNewRawMaterialType(i.params.id),e="Alta de tipus de matèria prima"),d.setMenuItem({icon:D.BUILDING,backButtonVisible:!0,title:e})};T(async()=>{await r()});const p=h(),y=async()=>{const e=s.value;let a=!1,o="";l.value===c.CREATE?(a=await t.createRawMaterialType(e),o="MMPP creada correctament"):(a=await t.updateRawMaterialType(e.id,e),o="MMPP actualizada correctament"),a&&(p.add({severity:"success",summary:o,life:5e3}),S.back())};return(e,a)=>V(s)?(C(),g(q,{key:0,rawmaterialtype:V(s),onSubmit:y},null,8,["rawmaterialtype"])):B("",!0)}});export{O as default};
