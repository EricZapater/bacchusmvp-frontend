import{d as B,g as S,u as V,r as L,o as M,P as u,j as N,x as R,h as m,m as j,w as o,k as l,a as q,e as d,i as t,C as _,D as f,n as F}from"./index-75cc375f.js";import{u as P}from"./expense-df2be276.js";import{f as U}from"./functions-224f323d.js";import{v as $}from"./v4-a960c1f4.js";import"./index-c88663a4.js";import"./base.service-c816a16d.js";import"./suppliers.service-1600800e.js";const z={class:"flex flex-wrap align-items-center justify-content-between gap-2"},A={class:"datatable-filter"},G={class:"filter-field"},H=d("label",{class:"block text-900 mb-2"},"Tipus de despesa",-1),W={class:"datatable-buttons"},J=["onClick"],se=B({__name:"Expenses",setup(K){const y=S(),x=V(),s=P(),c=L({dates:void 0,expenseTypeId:void 0});M(async()=>{await s.fetchExpenseTypes(),await s.fetchExpenses(),x.setMenuItem({icon:u.WALLET,title:"Gestió de despeses"})});const h=async()=>{c.value.expenseTypeId&&await s.getFiltered(c.value.expenseTypeId)},b=async()=>{c.value.expenseTypeId="",await s.fetchExpenses()},v=()=>{y.push({path:`/expense/${$()}`})},T=a=>{a.originalEvent.target.className.includes("grid_delete_column_button")||y.push({path:`/expense/${a.data.id}`})},w=N(),C=R(),E=(a,n)=>{C.require({target:a.currentTarget,message:"Està segur que vol eliminar la despesa?",icon:"pi pi-question-circle",acceptIcon:"pi pi-check",rejectIcon:"pi pi-times",accept:async()=>{await s.deleteExpense(n.id)&&(w.add({severity:"success",summary:"Eliminat",life:3e3}),await s.fetchExpenses())}})},g=a=>{var r;const n=(r=s.expenseTypes)==null?void 0:r.find(p=>p.id===a);return n?n.name:""};return(a,n)=>{const r=m("Dropdown"),p=m("Button"),i=m("Column"),I=m("BooleanColumn"),k=m("DataTable");return q(),j(k,{value:l(s).expenses,class:"small-datatable",tableStyle:"min-width: 100%",scrollable:"",scrollHeight:"75vh",sortMode:"multiple",onRowClick:T},{header:o(()=>[d("div",z,[d("div",A,[d("div",G,[H,t(r,{modelValue:c.value.expenseTypeId,"onUpdate:modelValue":n[0]||(n[0]=e=>c.value.expenseTypeId=e),editable:"",options:l(s).expenseTypes,optionValue:"id",optionLabel:"name",class:"w-full"},null,8,["modelValue","options"])])]),d("div",W,[t(p,{class:"datatable-button mr-2",icon:l(u).FILTER,rounded:"",raised:"",onClick:h},null,8,["icon"]),t(p,{class:"datatable-button mr-2",icon:l(u).TIMES,rounded:"",raised:"",onClick:b},null,8,["icon"]),t(p,{icon:l(u).PLUS,rounded:"",raised:"",onClick:v},null,8,["icon"])])])]),default:o(()=>[t(i,{field:"description",header:"Descripció",style:{width:"40%"}}),t(i,{field:"amount",header:"Import",style:{width:"15%"}},{body:o(e=>[_(f(e.data.amount)+" € ",1)]),_:1}),t(i,{field:"paymentDate",header:"Data pagament",style:{width:"20%"}},{body:o(e=>[_(f(l(U)(e.data.paymentDate)),1)]),_:1}),t(i,{header:"Tipus",style:{width:"15%"}},{body:o(e=>[_(f(g(e.data.expenseTypeId)),1)]),_:1}),t(i,{header:"Recurrent",style:{width:"10%"}},{body:o(e=>[t(I,{value:e.data.recurring,showColor:!1},null,8,["value"])]),_:1}),t(i,null,{body:o(e=>[d("i",{class:F([l(u).TIMES,"grid_delete_column_button"]),onClick:D=>E(D,e.data)},null,10,J)]),_:1})]),_:1},8,["value"])}}});export{se as default};
