import{d as S,r as B,H as C,h as R,m as d,w as p,a as i,e as h,i as r,y as F,k,P as g,l as m,D as $,n as E,p as N,b as H,f as D,g as U,v as z,u as A,o as K}from"./index-42358d85.js";import{u as T}from"./reference-71261d6f.js";import{v as L}from"./v4-a960c1f4.js";import"./reference.service-e0cdda03.js";import"./base.service-ed93fa00.js";const j=u=>(N("data-v-7df58b2e"),u=u(),H(),u),q={class:"references-header"},G={class:"references-filter"},J=j(()=>h("label",null,"Codi",-1)),O=["onClick"],Q=S({__name:"TableReferences",props:{module:{},references:{}},emits:["add","edit","delete"],setup(u,{emit:f}){const a=u,v=T(),s=B({code:""}),e=C(()=>a.module==="sales"),_=C(()=>a.module==="purchase");C(()=>a.module==="production");const w=C(()=>a.references?s.value.code.length>0?a.references.filter(n=>n.code.includes(s.value.code)):v.references:[]),b=()=>{f("add")},o=n=>{n.originalEvent.target.className.includes("grid_delete_column_button")||f("edit",n.data)},I=(n,l)=>{f("delete",l)},x=n=>{var y;const l=(y=v.referenceFormats)==null?void 0:y.find(t=>t.id===n);return l?l.description:""};return(n,l)=>{const y=R("Button"),t=R("Column"),V=R("BooleanColumn"),M=R("DataTable");return i(),d(M,{value:w.value,tableStyle:"min-width: 100%",scrollable:"",scrollHeight:"75vh",onRowClick:o},{header:p(()=>[h("div",q,[h("div",G,[J,r(F,{modelValue:s.value.code,"onUpdate:modelValue":l[0]||(l[0]=c=>s.value.code=c)},null,8,["modelValue"])]),r(y,{style:{float:"right"},icon:k(g).PLUS,rounded:"",raised:"",onClick:b},null,8,["icon"])])]),default:p(()=>[r(t,{field:"code",header:"Codi",style:{width:"15%"}}),r(t,{field:"description",header:"Descripció",style:{width:"35%"}}),r(t,{field:"version",header:"Versió",style:{width:"15%"}}),e.value?(i(),d(t,{key:0,field:"cost",header:"Cost",style:{width:"20%"}})):m("",!0),e.value?(i(),d(t,{key:1,field:"price",header:"Preu",style:{width:"20%"}})):m("",!0),_.value?(i(),d(t,{key:2,field:"referenceFormatId",header:"Format",style:{width:"10%"}},{body:p(c=>[h("span",null,$(x(c.data.referenceFormatId)),1)]),_:1})):m("",!0),_.value?(i(),d(t,{key:3,field:"density",header:"Densitat",style:{width:"10%"}})):m("",!0),_.value?(i(),d(t,{key:4,field:"lastPurchaseCost",header:"Última Compra",style:{width:"15%"}})):m("",!0),r(t,{header:"Desc.",style:{width:"10%"}},{body:p(c=>[r(V,{value:c.data.disabled},null,8,["value"])]),_:1}),r(t,{style:{width:"10%"}},{body:p(c=>[h("i",{class:E([k(g).TIMES,"grid_delete_column_button"]),onClick:P=>I(P,c.data)},null,10,O)]),_:1})]),_:1},8,["value"])}}});const W=D(Q,[["__scopeId","data-v-7df58b2e"]]),X=S({__name:"References",setup(u){const f=U(),a=z(),v=A(),s=T(),e=B("");K(async()=>{e.value=a.params.module,await s.fetchReferencesByModule(e.value);let o="";e.value==="sales"?o="Referencies de venta":e.value==="purchase"?o="Materies primes":e.value==="production"&&(o="Referencies de producció"),v.setMenuItem({icon:g.TICKET,title:o})});const _=()=>{f.push({path:`/reference/${e.value}/${L()}`})},w=o=>{f.push({path:`/reference/${e.value}/${o.id}`})},b=async o=>{await s.deleteReference(o.id),await s.fetchReferencesByModule(e.value)};return(o,I)=>(i(),d(W,{module:e.value,references:k(s).references,onAdd:_,onEdit:w,onDelete:b},null,8,["module","references"]))}});const se=D(X,[["__scopeId","data-v-7ee85d82"]]);export{se as default};
