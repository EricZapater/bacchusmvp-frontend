import{d as b,y as V,g as S,q as B,r as _,k as n,a as E,c as I,j as f,s as y,e as x,t as C,v as c,i as F,x as N,u as g,o as R,z as $,P as h}from"./index-b9d41b02.js";import{u as k}from"./suppliers-61752823.js";import{c as A,a as T,F as D}from"./form-validator-88e54800.js";import"./base.service-7dbc85ae.js";const M={key:0},q={class:"mt-2"},z=b({__name:"FormSupplierType",emits:["submit"],setup(w,{emit:i}){const u=k(),{supplierType:s}=V(u),p=S(),o=A().shape({name:T().required("El nom és obligatori").max(250,"El nom comercial no pot superar els 250 carácters"),description:T().required("La descripció és obligatori").max(250,"La descripció no pot superar els 250 carácters")}),a=B({result:!1,errors:{}}),m=()=>{const r=new D(o);a.value=r.validate(s.value)},d=async()=>{if(m(),a.value.result)i("submit",s.value);else{let r="";Object.entries(a.value.errors).forEach(e=>{r+=`${e[1].map(t=>t)}.   `}),p.add({severity:"warn",summary:"Formulari inválid",detail:r,life:5e3})}};return(r,e)=>{const t=_("BaseInput"),l=_("Button");return n(s)?(E(),I("form",M,[f(t,{class:y(["mb-2",{"p-invalid":a.value.errors.name}]),label:"Nom",id:"name",modelValue:n(s).name,"onUpdate:modelValue":e[0]||(e[0]=v=>n(s).name=v)},null,8,["modelValue","class"]),f(t,{class:y(["mb-2",{"p-invalid":a.value.errors.description}]),label:"Descripció",id:"description",modelValue:n(s).description,"onUpdate:modelValue":e[1]||(e[1]=v=>n(s).description=v)},null,8,["modelValue","class"]),x("div",q,[f(l,{label:"Guardar",class:"mr-2",onClick:d})])])):C("",!0)}}}),P=b({__name:"SupplierType",setup(w){const i=B(c.EDIT),u=F(),s=N(),p=g(),o=k(),{supplierType:a}=V(o),m=async()=>{await o.fetchSupplierType(s.params.id);let e="";a.value?(i.value=c.EDIT,e=`Tipus de proveïdor ${a.value.name}`):(i.value=c.CREATE,o.setNewSupplierType(s.params.id),e="Alta de tipus de proveïdor"),p.setMenuItem({icon:h.BUILDING,backButtonVisible:!0,text:e})};R(async()=>{await m()});const d=S(),r=async()=>{const e=a.value;let t=!1,l="";i.value===c.CREATE?(t=await o.createSupplierType(e),l="Tipus de proveïdor creat correctament"):(t=await o.updateSupplierType(e.id,e),l="Tipus de proveïdor actualizat correctament"),t&&(d.add({severity:"success",summary:l,life:5e3}),u.back())};return(e,t)=>(E(),$(z,{onSubmit:r}))}});export{P as default};
