import{d as B,v as L,H as C,j as N,o as q,r as M,h as y,c as d,e as l,i as r,n as c,y as u,k as n,l as m,m as $,G as D,a as i,s as p}from"./index-24f08e74.js";import{c as Y,a as b,d as U,F as P}from"./form-validator-f8953ae6.js";import{_ as j}from"./DropdownCustomers.vue_vue_type_script_setup_true_lang-db0c8e1a.js";import{F as z}from"./FileEntityPicker-c66c55fc.js";import{u as G}from"./tax-1562c01a.js";import{u as H}from"./reference-225d9492.js";import{u as O}from"./referenceType-e73d2cba.js";const X=l("br",null,null,-1),A={key:0},J={class:"four-columns"},K={class:"mt-1"},Q={class:"mt-1"},W={key:0,class:"mt-1"},Z={key:1,class:"mt-1"},x={key:2,class:"mt-1"},ee=l("label",{class:"block text-900 mb-2"},"Tipus de material",-1),oe={key:0,class:"three-columns"},se={class:"mt-1"},le=l("label",{class:"block text-900 mb-2"},"Format",-1),re={class:"mt-1"},te={class:"mt-1"},ae=l("label",{class:"block text-900 mb-2"},"Impost",-1),ne={key:1,class:"five-columns"},ie={class:"mt-1"},de={class:"mt-1"},ue={class:"mt-1"},me={class:"mt-1"},ce=l("label",{class:"block text-900 mb-2"},"Impost",-1),pe={class:"mt-1"},fe=l("label",{class:"block text-900 mb-2"},"Servei",-1),be=l("br",null,null,-1),Fe=B({__name:"FormReference",props:{module:{},reference:{},defaultCustomerId:{}},emits:["submit","cancel"],setup(F,{emit:w}){const t=F;L();const v=C(()=>t.module==="sales"),k=C(()=>t.module==="purchase");C(()=>t.module==="production");const E=N(),I=G(),R=H(),T=O();q(()=>{t.defaultCustomerId&&t.reference&&(t.reference.customerId=t.defaultCustomerId)});const _=Y().shape({code:b().required("El codi és obligatori").max(50,"El codi no pot superar els 50 carácters"),description:b().required("La descripció és obligatori").max(250,"La descripció pot superar els 250 carácters"),version:b().required("La versió és obligatoria").max(20,"La versió pot superar els 20 carácters"),cost:U().required("El cost es obligatori"),price:U().required("El preu es obligatori"),taxId:b().required("El tipus d'iva es obligatori")}),a=M({result:!1,errors:{}}),S=()=>{const e=new P(_);a.value=e.validate(t.reference)},g=async()=>{if(S(),a.value.result)w("submit",t.reference);else{let e="";Object.entries(a.value.errors).forEach(o=>{e+=`${o[1].map(V=>V)}.   `}),E.add({severity:"warn",summary:"Formulari inválid",detail:e,life:5e3})}};return(e,o)=>{const V=y("Button"),f=y("Dropdown"),h=y("Checkbox");return i(),d(D,null,[l("div",null,[r(V,{label:"Guardar",class:"grid_add_row_button",size:"small",onClick:g}),X]),e.reference?(i(),d("form",A,[l("section",J,[l("div",K,[r(u,{class:c(["mb-2",{"p-invalid":a.value.errors.code}]),label:"Codi",id:"code",modelValue:e.reference.code,"onUpdate:modelValue":o[0]||(o[0]=s=>e.reference.code=s)},null,8,["modelValue","class"])]),l("div",Q,[r(u,{class:c(["mb-2",{"p-invalid":a.value.errors.description}]),label:"Descripció",id:"description",modelValue:e.reference.description,"onUpdate:modelValue":o[1]||(o[1]=s=>e.reference.description=s)},null,8,["modelValue","class"])]),v.value?(i(),d("div",W,[r(u,{type:n(p).TEXT,label:"Versió",id:"version",modelValue:e.reference.version,"onUpdate:modelValue":o[2]||(o[2]=s=>e.reference.version=s)},null,8,["type","modelValue"])])):m("",!0),v.value?(i(),d("div",Z,[r(j,{label:"Client",modelValue:e.reference.customerId,"onUpdate:modelValue":o[3]||(o[3]=s=>e.reference.customerId=s)},null,8,["modelValue"])])):m("",!0),k.value?(i(),d("div",x,[ee,r(f,{modelValue:e.reference.referenceTypeId,"onUpdate:modelValue":o[4]||(o[4]=s=>e.reference.referenceTypeId=s),editable:"",options:n(T).referenceTypes,optionValue:"id",optionLabel:"name",class:c(["w-full",{"p-invalid":a.value.errors.taxid}])},null,8,["modelValue","options","class"])])):m("",!0)]),k.value?(i(),d("section",oe,[l("div",se,[le,r(f,{modelValue:e.reference.referenceFormatId,"onUpdate:modelValue":o[5]||(o[5]=s=>e.reference.referenceFormatId=s),editable:"",options:n(R).referenceFormats,optionValue:"id",optionLabel:"description",class:c(["w-full",{"p-invalid":a.value.errors.taxid}])},null,8,["modelValue","options","class"])]),l("div",re,[r(u,{type:n(p).CURRENCY,label:"Últim cost de compra",id:"lastCost",modelValue:e.reference.lastCost,"onUpdate:modelValue":o[6]||(o[6]=s=>e.reference.lastCost=s),disabled:""},null,8,["type","modelValue"])]),l("div",te,[ae,r(f,{modelValue:e.reference.taxId,"onUpdate:modelValue":o[7]||(o[7]=s=>e.reference.taxId=s),editable:"",options:n(I).taxes,optionValue:"id",optionLabel:"name",class:c(["w-full",{"p-invalid":a.value.errors.taxid}])},null,8,["modelValue","options","class"])])])):m("",!0),v.value?(i(),d("section",ne,[l("div",ie,[r(u,{type:n(p).CURRENCY,label:"Cost Teóric Fabricació",id:"workMasterCost",modelValue:e.reference.workMasterCost,"onUpdate:modelValue":o[8]||(o[8]=s=>e.reference.workMasterCost=s),disabled:""},null,8,["type","modelValue"])]),l("div",de,[r(u,{type:n(p).CURRENCY,label:"Cost Última Fabricació",id:"lastCost",modelValue:e.reference.lastCost,"onUpdate:modelValue":o[9]||(o[9]=s=>e.reference.lastCost=s),disabled:""},null,8,["type","modelValue"])]),l("div",ue,[r(u,{type:n(p).CURRENCY,label:"Preu",id:"price",modelValue:e.reference.price,"onUpdate:modelValue":o[10]||(o[10]=s=>e.reference.price=s)},null,8,["type","modelValue"])]),l("div",me,[ce,r(f,{modelValue:e.reference.taxId,"onUpdate:modelValue":o[11]||(o[11]=s=>e.reference.taxId=s),editable:"",options:n(I).taxes,optionValue:"id",optionLabel:"name",class:c(["w-full",{"p-invalid":a.value.errors.taxid}])},null,8,["modelValue","options","class"])]),l("div",pe,[fe,r(h,{modelValue:e.reference.isService,"onUpdate:modelValue":o[12]||(o[12]=s=>e.reference.isService=s),class:"w-full",binary:!0},null,8,["modelValue"])])])):m("",!0),l("section",null,[be,e.reference?(i(),$(z,{key:0,title:"Documentació",entity:"referenceMaps",id:e.reference.id},null,8,["id"])):m("",!0)])])):m("",!0)],64)}}});export{Fe as _};
