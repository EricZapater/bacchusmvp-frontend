import{d as _,j as R,r as E,h as T,c as h,e as l,i as c,n as p,y as V,l as w,a as B,F as f,g as F,v as I,u as N,z as U,o as g,k as C,m as D,P}from"./index-7f1f4f85.js";import{c as S,a as k,F as $}from"./form-validator-f2c8ea4b.js";import{u as A}from"./referenceType-c8aa8706.js";import"./index-df30801e.js";import"./base.service-f5b02259.js";import"./reference.service-5b190a19.js";const M={key:0},z={class:"three-columns"},L=l("label",{class:"block text-900 mb-2"},"Desactivat",-1),j={class:"three-columns"},q=l("label",{class:"block text-900 mb-2"},"Color Primari",-1),G=l("label",{class:"block text-900 mb-2"},"Color Secundari",-1),O={class:"mt-2"},H=_({__name:"FormReferenceType",props:{referenceType:{}},emits:["submit","cancel"],setup(v,{emit:i}){const u=v,d=R(),y=S().shape({name:k().required("El nom és obligatori").max(250,"El nom no pot superar els 250 carácters"),description:k().required("La descripció és obligatori").max(250,"La descripció pot superar els 250 carácters")}),a=E({result:!1,errors:{}}),t=()=>{const e=new $(y);a.value=e.validate(u.referenceType)},b=async()=>{if(t(),a.value.result)i("submit",u.referenceType);else{let e="";Object.entries(a.value.errors).forEach(r=>{e+=`${r[1].map(o=>o)}.   `}),d.add({severity:"warn",summary:"Formulari inválid",detail:e,life:5e3})}};return(e,r)=>{const o=T("Checkbox"),n=T("ColorPicker"),m=T("Button");return e.referenceType?(B(),h("form",M,[l("section",z,[c(V,{class:p(["mb-2",{"p-invalid":a.value.errors.name}]),label:"Nom",id:"name",modelValue:e.referenceType.name,"onUpdate:modelValue":r[0]||(r[0]=s=>e.referenceType.name=s)},null,8,["modelValue","class"]),c(V,{class:p(["mb-2",{"p-invalid":a.value.errors.description}]),label:"Descripció",id:"description",modelValue:e.referenceType.description,"onUpdate:modelValue":r[1]||(r[1]=s=>e.referenceType.description=s)},null,8,["modelValue","class"]),l("div",null,[L,c(o,{modelValue:e.referenceType.disabled,"onUpdate:modelValue":r[2]||(r[2]=s=>e.referenceType.disabled=s),class:"w-full",binary:!0},null,8,["modelValue"])])]),l("section",j,[l("div",null,[q,c(n,{modelValue:e.referenceType.primaryColor,"onUpdate:modelValue":r[3]||(r[3]=s=>e.referenceType.primaryColor=s),class:p(["mb-2",{"p-invalid":a.value.errors.color}]),label:"Color",id:"color"},null,8,["modelValue","class"])]),l("div",null,[G,c(n,{modelValue:e.referenceType.secondaryColor,"onUpdate:modelValue":r[4]||(r[4]=s=>e.referenceType.secondaryColor=s),class:p(["mb-2",{"p-invalid":a.value.errors.color}]),label:"Color",id:"color"},null,8,["modelValue","class"])])]),l("div",O,[c(m,{label:"Guardar",class:"mr-2",onClick:b})])])):w("",!0)}}}),Z=_({__name:"ReferenceType",setup(v){const i=E(f.EDIT),u=F(),d=I(),y=N(),a=A(),{referenceType:t}=U(a),b=async()=>{await a.fetchReferenceType(d.params.id);let o="";t.value?(i.value=f.EDIT,o=`Tipus de material ${t.value.name}`):(i.value=f.CREATE,a.setNewReferenceType(d.params.id),o="Alta de tipus de materials"),y.setMenuItem({icon:P.BUILDING,backButtonVisible:!0,title:o})};g(async()=>{await b()});const e=R(),r=async()=>{const o=t.value;let n=!1,m="";i.value===f.CREATE?(n=await a.createReferenceType(o),m="Tipus de material creat correctament"):(n=await a.updateReferenceType(o.id,o),m="Tipus de material actualizat correctament"),n&&(e.add({severity:"success",summary:m,life:5e3}),u.back())};return(o,n)=>C(t)?(B(),D(H,{key:0,"reference-type":C(t),onSubmit:r},null,8,["reference-type"])):w("",!0)}});export{Z as default};
