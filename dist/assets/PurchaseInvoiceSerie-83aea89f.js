import{d as _,g as k,q as y,r as h,c as w,e as d,j as l,s as S,B as I,t as E,a as P,v as u,x as B,u as C,y as F,o as T,k as b,z as N,P as g,A}from"./index-b9d41b02.js";import{u as D}from"./invoices-0331c851.js";import{c as $,a as V,F as M}from"./form-validator-88e54800.js";import"./base.service-7dbc85ae.js";const R={key:0},U={class:"three-columns"},q=d("label",{class:"block text-900 mb-2"},"Desactivada",-1),x={class:"mt-2"},z=_({__name:"FormPurchaseInvoiceSerie",props:{purchaseInvoiceSerie:{}},emits:["submit","cancel"],setup(f,{emit:i}){const t=f,m=k(),o=$().shape({name:V().required("El nom de la sèrie és obligatori").max(50,"El nom de la sèrie no pot superar els 50 caràcters"),description:V().required("La descripció de la sèrie és obligatòria").max(250,"La descripció de la sèrie no pot superar els 50 caràcters")}),s=y({result:!1,errors:{}}),p=()=>{const a=new M(o);s.value=a.validate(t.purchaseInvoiceSerie)},v=async()=>{if(p(),s.value.result)i("submit",t.purchaseInvoiceSerie);else{let a="";Object.entries(s.value.errors).forEach(e=>{a+=`${e[1].map(r=>r)}.   `}),m.add({severity:"warn",summary:"Formulari inválid",detail:a,life:5e3})}};return(a,e)=>{const r=h("Checkbox"),c=h("Button");return a.purchaseInvoiceSerie?(P(),w("form",R,[d("div",U,[l(I,{name:"name",class:S(["mb-2",{"p-invalid":s.value.errors.name}]),label:"Nom de la sèrie",id:"name",modelValue:a.purchaseInvoiceSerie.name,"onUpdate:modelValue":e[0]||(e[0]=n=>a.purchaseInvoiceSerie.name=n)},null,8,["modelValue","class"]),l(I,{name:"description",class:S(["mb-2",{"p-invalid":s.value.errors.description}]),label:"Descripció",id:"description",modelValue:a.purchaseInvoiceSerie.description,"onUpdate:modelValue":e[1]||(e[1]=n=>a.purchaseInvoiceSerie.description=n)},null,8,["modelValue","class"]),d("div",null,[q,l(r,{modelValue:a.purchaseInvoiceSerie.disabled,"onUpdate:modelValue":e[2]||(e[2]=n=>a.purchaseInvoiceSerie.disabled=n),class:"w-full",binary:!0},null,8,["modelValue"])])]),d("div",x,[l(c,{label:"Guardar",class:"mr-2",onClick:v})])])):E("",!0)}}}),H=_({__name:"PurchaseInvoiceSerie",setup(f){const i=y(u.EDIT),t=B(),m=C(),o=D(),{purchaseInvoiceSerie:s}=F(o),p=async()=>{await o.fetchPurchaseInvoiceSerie(t.params.id);let e="";s.value?(i.value=u.EDIT,e=`Sèrie de facturació: ${s.value.name}`):(i.value=u.CREATE,o.setNewPurchaseInvoiceSerie(t.params.id),e="Alta de sèrie de facturació"),m.setMenuItem({icon:g.POUND,backButtonVisible:!0,text:e})};T(async()=>{await p()});const v=k(),a=async()=>{const e=s.value;let r=!1,c="";i.value===u.CREATE?(r=await o.createPurchaseInvoiceSerie(e),c="Sèrie de facturació creada correctament"):(r=await o.updatePurchaseInvoiceSerie(e.id,e),c="Sèrie de facturació actualizada correctament"),r&&(v.add({severity:"success",summary:c,life:5e3}),A.back())};return(e,r)=>b(s)?(P(),N(z,{key:0,purchaseInvoiceSerie:b(s),onSubmit:a},null,8,["purchaseInvoiceSerie"])):E("",!0)}});export{H as default};
