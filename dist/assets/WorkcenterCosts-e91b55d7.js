import{d as M,g as q,u as E,j as T,x as W,o as z,P as m,H as k,r as L,h as c,m as R,w as u,a as P,e as l,i as a,k as p,C as j,D as A,n as H}from"./index-3b8fad0b.js";import{u as U}from"./plantmodel-4f98e0d8.js";import{v as $}from"./v4-a960c1f4.js";import"./index-60183c2e.js";import"./base.service-95f208f7.js";const F={class:"flex flex-wrap align-items-center justify-content-between gap-2"},G={class:"datatable-filter"},J={class:"filter-field"},K=l("label",{class:"block text-900 mb-2"},"Màquina",-1),O={class:"filter-field"},Q=l("label",{class:"block text-900 mb-2"},"Cost 0",-1),X={class:"datatable-buttons"},Y=["onClick"],ne=M({__name:"WorkcenterCosts",setup(Z){const f=q(),h=E(),o=U(),w=T(),b=W();z(async()=>{await o.fetchWorkcenterCosts(),await o.fetchWorkcenters(),await o.fetchMachineStatuses(),h.setMenuItem({icon:m.CALENDAR,title:"Costs per màquina"})});const v=k(()=>o.workcentercosts?o.workcentercosts.map(e=>({workcenterName:I(e.workcenterId),machineStatusName:g(e.machineStatusId),...e})):[]),s=L({workcenterId:void 0,zerocost:!1}),C=k(()=>{let e=v.value;return s.value.workcenterId&&(e=e.filter(t=>t.workcenterId===s.value.workcenterId)),s.value.zerocost&&(e=e.filter(t=>t.cost===0)),e}),y=()=>{s.value.workcenterId=void 0,s.value.zerocost=!1},I=e=>{var r;const t=(r=o.workcenters)==null?void 0:r.find(i=>i.id===e);if(t)return t.name},g=e=>{var r;const t=(r=o.machineStatuses)==null?void 0:r.find(i=>i.id===e);if(t)return t.name},S=()=>{f.push({path:`/workcentercost/${$()}`})},x=e=>{e.originalEvent.target.className.includes("grid_delete_column_button")||f.push({path:`/workcentercost/${e.data.id}`})},B=(e,t)=>{b.require({target:e.currentTarget,message:`Está segur que vol eliminar el cost  ${t.id}?`,icon:"pi pi-question-circle",acceptIcon:"pi pi-check",rejectIcon:"pi pi-times",accept:async()=>{await o.deleteWorkcenterCost(t.id)&&(w.add({severity:"success",summary:"Eliminat",life:3e3}),await o.fetchWorkcenterCosts())}})};return(e,t)=>{const r=c("Dropdown"),i=c("Checkbox"),_=c("Button"),d=c("Column"),N=c("BooleanColumn"),V=c("DataTable");return P(),R(V,{value:C.value,tableStyle:"min-width: 100%",scrollable:"",scrollHeight:"80vh","sort-field":"workcenterName","sort-order":1,onRowClick:x,paginator:"",rows:12},{header:u(()=>[l("div",F,[l("div",G,[l("div",J,[K,a(r,{modelValue:s.value.workcenterId,"onUpdate:modelValue":t[0]||(t[0]=n=>s.value.workcenterId=n),editable:"",options:p(o).workcenters,optionValue:"id",optionLabel:"name",class:"w-full"},null,8,["modelValue","options"])]),l("div",O,[Q,a(i,{binary:!0,modelValue:s.value.zerocost,"onUpdate:modelValue":t[1]||(t[1]=n=>s.value.zerocost=n)},null,8,["modelValue"])])]),l("div",X,[a(_,{class:"datatable-button mr-2",icon:p(m).PLUS,rounded:"",raised:"",onClick:S},null,8,["icon"]),a(_,{class:"datatable-button mr-2",icon:p(m).FILTER_SLASH,rounded:"",raised:"",onClick:y},null,8,["icon"])])])]),default:u(()=>[a(d,{field:"workcenterName",header:"Màquina",style:{width:"30%"},sortable:""}),a(d,{field:"machineStatusName",header:"Estat de màquina",style:{width:"30%"}}),a(d,{field:"cost",header:"Cost",style:{width:"30%"}},{body:u(n=>[j(A(n.data.cost)+" € ",1)]),_:1}),a(d,{header:"Desactivada",style:{width:"10%"}},{body:u(n=>[a(N,{value:n.data.disabled},null,8,["value"])]),_:1}),a(d,null,{body:u(n=>[l("i",{class:H([p(m).TIMES,"grid_delete_column_button"]),onClick:D=>B(D,n.data)},null,10,Y)]),_:1})]),_:1},8,["value"])}}});export{ne as default};
