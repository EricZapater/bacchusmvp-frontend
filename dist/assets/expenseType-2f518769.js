import{b as C}from"./vue-router-ffe4063c.js";import{j as V,k as _,f as T,c as F,e as c,h as p,n as b,d as k,o as w,u as h,ax as A,M as I,l as v,a as M,P as N}from"./index-a2430148.js";import{u as B}from"./usetoast.esm-261cff49.js";import{F as m}from"./component-c8ee66ae.js";import{r as $}from"./router-1341e2bf.js";import{u as g}from"./expense-0a1d09e8.js";import{B as x}from"./BaseInput-59304a19.js";import{c as D,a as E,F as R}from"./form-validator-1a569dfe.js";import"./base.service-ac28cfab.js";import"./runtime-dom.esm-bundler-ee5f76e0.js";import"./_plugin-vue_export-helper-c27b6911.js";const S={key:0},L={class:"three-columns"},U=c("label",{class:"block text-900 mb-2"},"Desactivat",-1),j={class:"mt-2"},q=V({__name:"FormExpenseType",props:{expenseType:{}},emits:["submit","cancel"],setup(y,{emit:r}){const n=y,u=B(),o=D().shape({name:E().required("El nom és obligatori").max(250,"El nom no pot superar els 250 carácters"),description:E().required("La descripció és obligatori").max(250,"La descripció pot superar els 250 carácters")}),a=_({result:!1,errors:{}}),d=()=>{const s=new R(o);a.value=s.validate(n.expenseType)},f=async()=>{if(d(),a.value.result)r("submit",n.expenseType);else{let s="";Object.entries(a.value.errors).forEach(e=>{s+=`${e[1].map(t=>t)}.   `}),u.add({severity:"warn",summary:"Formulari inválid",detail:s,life:5e3})}};return(s,e)=>{const t=T("Checkbox"),l=T("Button");return s.expenseType?(w(),F("form",S,[c("div",L,[p(x,{class:b(["mb-2",{"p-invalid":a.value.errors.name}]),label:"Nom",id:"name",modelValue:s.expenseType.name,"onUpdate:modelValue":e[0]||(e[0]=i=>s.expenseType.name=i)},null,8,["modelValue","class"]),p(x,{class:b(["mb-2",{"p-invalid":a.value.errors.description}]),label:"Descripció",id:"description",modelValue:s.expenseType.description,"onUpdate:modelValue":e[1]||(e[1]=i=>s.expenseType.description=i)},null,8,["modelValue","class"]),c("div",null,[U,p(t,{modelValue:s.expenseType.disabled,"onUpdate:modelValue":e[2]||(e[2]=i=>s.expenseType.disabled=i),class:"w-full",binary:!0},null,8,["modelValue"])])]),c("div",j,[p(l,{label:"Guardar",class:"mr-2",onClick:f})])])):k("",!0)}}}),Z=V({__name:"expenseType",setup(y){const r=_(m.EDIT),n=C(),u=h(),o=g(),{expenseType:a}=A(o),d=async()=>{await o.fetchExpenseType(n.params.id);let e="";a.value?(r.value=m.EDIT,e=`Tipus de despesa ${a.value.name}`):(r.value=m.CREATE,o.setNewExpenseType(n.params.id),e="Alta de tipus de despesa"),u.setMenuItem({icon:N.FLAG,backButtonVisible:!0,text:e})};I(async()=>{await d()});const f=B(),s=async()=>{const e=a.value;let t=!1,l="";r.value===m.CREATE?(t=await o.createExpenseType(e),l="Tipus de despesa creat correctament"):(t=await o.updateExpenseType(e.id,e),l="Tipus de despesa actualitzat correctament"),t&&(f.add({severity:"success",summary:l,life:5e3}),$.back())};return(e,t)=>v(a)?(w(),M(q,{key:0,expenseType:v(a),onSubmit:s},null,8,["expenseType"])):k("",!0)}});export{Z as default};
