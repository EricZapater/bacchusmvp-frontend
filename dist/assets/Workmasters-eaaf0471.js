import{_ as x}from"./DropdownReference.vue_vue_type_script_setup_true_lang-b48b93b0.js";import{d as E,g as N,u as T,j as A,x as L,r as M,H as U,E as F,o as $,P as m,h as i,c as j,i as t,w as c,G as q,a as P,e as l,k as n,C as G,D as H,n as Q}from"./index-357c9d4c.js";import{u as W}from"./workmaster-137f1d0f.js";import{u as z}from"./reference-35a8c4f2.js";import{g as O}from"./functions-afe9fe15.js";import"./index-6fe49fa3.js";import"./base.service-d0780977.js";import"./reference.service-387fdae1.js";import"./v4-a960c1f4.js";const J={class:"flex flex-wrap align-items-center justify-content-between gap-2"},K={class:"datatable-filter"},X={class:"filter-field"},Y=l("label",{class:"block text-900 mb-2"},"Referència",-1),Z={class:"datatable-buttons"},ee=["onClick"],te=l("br",null,null,-1),me=E({__name:"Workmasters",setup(ae){const _=N(),v=T(),w=A(),h=L(),e=W(),f=z(),d=M({referenceId:void 0}),k=()=>{d.value.referenceId=void 0},C=U(()=>e.workmasters?d.value.referenceId?e.workmasters.filter(o=>o.id===d.value.referenceId):e.workmasters:[]),r=F({visible:!1,title:"Crear ruta",closable:!0,position:"center",modal:!0});$(async()=>{await e.fetchAll(),await f.fetchReferencesByModule("sales"),v.setMenuItem({icon:m.CALENDAR,title:"Gestió de rutes de fabricació"})});const g=()=>{const o=O();e.setNew(o),r.visible=!0},y=o=>{o.originalEvent.target.className.includes("grid_delete_column_button")||_.push({path:`/workmaster/${o.data.id}`})},I=async()=>{if(!e.workmaster)return;await e.create(e.workmaster)&&_.push({path:`/workmaster/${e.workmaster.id}`})},S=(o,s)=>{h.require({target:o.currentTarget,message:`Está segur que vol eliminar la ruta ${s.reference.description}?`,icon:"pi pi-question-circle",acceptIcon:"pi pi-check",rejectIcon:"pi pi-times",accept:async()=>{await e.delete(s.id)&&(w.add({severity:"success",summary:"Eliminada",life:3e3}),await e.fetchAll())}})};return(o,s)=>{const b=i("Dropdown"),p=i("Button"),u=i("Column"),B=i("BooleanColumn"),D=i("DataTable"),R=i("Dialog");return P(),j(q,null,[t(D,{value:C.value,tableStyle:"min-width: 100%",onRowClick:y},{header:c(()=>[l("div",J,[l("div",K,[l("div",X,[Y,t(b,{modelValue:d.value.referenceId,"onUpdate:modelValue":s[0]||(s[0]=a=>d.value.referenceId=a),showClear:"",editable:"",options:n(f).references,optionValue:"id",optionLabel:"description",class:"w-full"},null,8,["modelValue","options"])])]),l("div",Z,[t(p,{class:"datatable-button mr-2",icon:n(m).FILTER_SLASH,rounded:"",raised:"",onClick:k},null,8,["icon"]),t(p,{icon:n(m).PLUS,rounded:"",raised:"",onClick:g},null,8,["icon"])])])]),default:c(()=>[t(u,{header:"Referencia",style:{width:"50%"}},{body:c(a=>[G(H(n(f).getFullName(a.data.reference)),1)]),_:1}),t(u,{field:"baseQuantity",header:"Quantitat Base",style:{width:"25%"}}),t(u,{header:"Desactivada",style:{width:"25%"}},{body:c(a=>[t(B,{value:a.data.disabled},null,8,["value"])]),_:1}),t(u,null,{body:c(a=>[l("i",{class:Q([n(m).TIMES,"grid_delete_column_button"]),onClick:V=>S(V,a.data)},null,10,ee)]),_:1})]),_:1},8,["value"]),t(R,{visible:r.visible,"onUpdate:visible":s[2]||(s[2]=a=>r.visible=a),header:r.title,closable:r.closable,modal:r.modal},{default:c(()=>[l("div",null,[t(x,{label:"Referència",modelValue:n(e).workmaster.referenceId,"onUpdate:modelValue":s[1]||(s[1]=a=>n(e).workmaster.referenceId=a)},null,8,["modelValue"])]),te,l("div",null,[t(p,{label:"Crear",style:{float:"right"},onClick:I})])]),_:1},8,["visible","header","closable","modal"])],64)}}});export{me as default};
