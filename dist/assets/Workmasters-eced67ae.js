import{_ as b}from"./DropdownReference.vue_vue_type_script_setup_true_lang-dea8ff6c.js";import{d as V,g as x,u as E,j as T,x as A,r as M,H as U,E as F,o as L,P as f,h as d,c as $,i as t,w as n,G as j,a as q,e as s,k as i,C as H,D as P,n as G}from"./index-c707b5be.js";import{u as Q}from"./workmaster-403e1323.js";import{u as W}from"./reference-ef5b5fae.js";import{g as z}from"./functions-25e1930c.js";import"./index-ecb6ca74.js";import"./base.service-557ead35.js";import"./reference.service-6f48d6ad.js";import"./_commonjsHelpers-725317a4.js";import"./v4-a960c1f4.js";const O={class:"flex flex-wrap align-items-center justify-content-between gap-2"},J={class:"datatable-filter"},K={class:"filter-field"},X=s("label",{class:"block text-900 mb-2"},"Referència",-1),Y={class:"datatable-buttons"},Z=["onClick"],ee=s("br",null,null,-1),me=V({__name:"Workmasters",setup(te){const p=x(),v=E(),w=T(),h=A(),e=Q(),_=W(),c=M({referenceId:void 0}),k=()=>{c.value.referenceId=void 0},g=U(()=>e.workmasters?c.value.referenceId?e.workmasters.filter(o=>o.id===c.value.referenceId):e.workmasters:[]),r=F({visible:!1,title:"Crear ruta",closable:!0,position:"center",modal:!0});L(async()=>{await e.fetchAll(),await _.fetchReferencesByModule("sales"),v.setMenuItem({icon:f.CALENDAR,title:"Gestió de rutes de fabricació"})});const C=()=>{const o=z();e.setNew(o),r.visible=!0},y=o=>{o.originalEvent.target.className.includes("grid_delete_column_button")||p.push({path:`/workmaster/${o.data.id}`})},I=async()=>{if(!e.workmaster)return;await e.create(e.workmaster)&&p.push({path:`/workmaster/${e.workmaster.id}`})},S=(o,l)=>{h.require({target:o.currentTarget,message:`Está segur que vol eliminar la ruta ${l.reference.description}?`,icon:"pi pi-question-circle",acceptIcon:"pi pi-check",rejectIcon:"pi pi-times",accept:async()=>{await e.delete(l.id)&&(w.add({severity:"success",summary:"Eliminada",life:3e3}),await e.fetchAll())}})};return(o,l)=>{const u=d("Button"),m=d("Column"),B=d("BooleanColumn"),N=d("DataTable"),R=d("Dialog");return q(),$(j,null,[t(N,{value:g.value,tableStyle:"min-width: 100%",scrollable:"",scrollHeight:"80vh",onRowClick:y},{header:n(()=>[s("div",O,[s("div",J,[s("div",K,[X,t(b,{label:"",modelValue:c.value.referenceId,"onUpdate:modelValue":l[0]||(l[0]=a=>c.value.referenceId=a),fullName:!0},null,8,["modelValue"])])]),s("div",Y,[t(u,{class:"datatable-button mr-2",icon:i(f).FILTER_SLASH,rounded:"",raised:"",onClick:k},null,8,["icon"]),t(u,{icon:i(f).PLUS,rounded:"",raised:"",onClick:C},null,8,["icon"])])])]),default:n(()=>[t(m,{header:"Referencia",style:{width:"50%"}},{body:n(a=>[H(P(i(_).getFullName(a.data.reference)),1)]),_:1}),t(m,{field:"baseQuantity",header:"Quantitat Base",style:{width:"25%"}}),t(m,{header:"Desactivada",style:{width:"25%"}},{body:n(a=>[t(B,{value:a.data.disabled},null,8,["value"])]),_:1}),t(m,null,{body:n(a=>[s("i",{class:G([i(f).TIMES,"grid_delete_column_button"]),onClick:D=>S(D,a.data)},null,10,Z)]),_:1})]),_:1},8,["value"]),t(R,{visible:r.visible,"onUpdate:visible":l[2]||(l[2]=a=>r.visible=a),header:r.title,closable:r.closable,modal:r.modal},{default:n(()=>[s("div",null,[t(b,{label:"Referència",modelValue:i(e).workmaster.referenceId,"onUpdate:modelValue":l[1]||(l[1]=a=>i(e).workmaster.referenceId=a),fullName:!0},null,8,["modelValue"])]),ee,s("div",null,[t(u,{label:"Crear",style:{float:"right"},onClick:I})])]),_:1},8,["visible","header","closable","modal"])],64)}}});export{me as default};
